# HG changeset patch
# Parent 6ddcc5266799d444b64ff1256bc2209bb7f389f1
# User Brian Grinstead <bgrinstead@mozilla.com>
Bug 1093875 - Allow XBL anonymous content inspection inside of an HTML document;r=pbrosset


diff --git a/toolkit/devtools/server/actors/inspector.js b/toolkit/devtools/server/actors/inspector.js
--- a/toolkit/devtools/server/actors/inspector.js
+++ b/toolkit/devtools/server/actors/inspector.js
@@ -3219,20 +3219,19 @@ DocumentWalker.prototype = {
     let node = this.walker.nextSibling();
     while (node && this.filter(node) === Ci.nsIDOMNodeFilter.FILTER_SKIP) {
       node = this.walker.nextSibling();
     }
     return node;
   }
 };
 
-function isXULDocument(doc) {
-  return doc &&
-         doc.documentElement &&
-         doc.documentElement.namespaceURI === XUL_NS;
+function isXULElement(el) {
+  return el &&
+         el.namespaceURI === XUL_NS;
 }
 
 /**
  * A tree walker filter for avoiding empty whitespace text nodes.
  */
 function nodeFilter(aNode) {
   // Ignore empty whitespace text nodes.
   if (aNode.nodeType == Ci.nsIDOMNode.TEXT_NODE &&
@@ -3242,17 +3241,17 @@ function nodeFilter(aNode) {
 
   // Ignore all native anonymous content (like internals for form
   // controls).  Except for:
   //   1) Anonymous content in a XUL document. This is needed for all
   //      elements within the Browser Toolbox to properly show up.
   //   2) ::before/::after - we do want this to show in the walker so
   //      they can be inspected.
   if (LayoutHelpers.isNativeAnonymous(aNode) &&
-      !isXULDocument(aNode.ownerDocument) &&
+      !isXULElement(aNode) &&
       (
         aNode.nodeName !== "_moz_generated_content_before" &&
         aNode.nodeName !== "_moz_generated_content_after")
       ) {
     return Ci.nsIDOMNodeFilter.FILTER_SKIP;
   }
 
   return Ci.nsIDOMNodeFilter.FILTER_ACCEPT;
