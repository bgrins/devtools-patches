# HG changeset patch
# Parent 7d4fe2f6fa0518a0d9d40d04e2dce01390fe47ba
# User Brian Grinstead <bgrinstead@mozilla.com>
Bug 1060086 - Get rid of error message 'TypeError: command.state.offChange is not a function' in mochitest-dt;r=jwalker


diff --git a/browser/devtools/shared/DeveloperToolbar.jsm b/browser/devtools/shared/DeveloperToolbar.jsm
--- a/browser/devtools/shared/DeveloperToolbar.jsm
+++ b/browser/devtools/shared/DeveloperToolbar.jsm
@@ -161,17 +161,19 @@ let CommandUtils = {
                 updateChecked(reply);
               }
             }
           };
 
           command.state.onChange(target, onChange);
           onChange("", { target: target });
           document.defaultView.addEventListener("unload", () => {
-            command.state.offChange(target, onChange);
+            if (command.state.offChange) {
+              command.state.offChange(target, onChange);
+            }
           }, false);
         }
 
         requisition.clear();
 
         return button;
       });
     });
