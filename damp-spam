# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  e311030ff4913385b662c13101eaa676fd0dd7b2
Bug 1157946 - Early return if aResponse.sources is undefined;r=fitzgen

This happens quite often during the damp devtools talos test, when
the toolbox is closed immediately after a page is reloaded

diff --git a/browser/devtools/debugger/debugger-controller.js b/browser/devtools/debugger/debugger-controller.js
--- a/browser/devtools/debugger/debugger-controller.js
+++ b/browser/devtools/debugger/debugger-controller.js
@@ -1217,17 +1217,17 @@ SourceScripts.prototype = {
     // Signal that a new source has been added.
     window.emit(EVENTS.NEW_SOURCE);
   },
 
   /**
    * Callback for the debugger's active thread getSources() method.
    */
   _onSourcesAdded: function(aResponse) {
-    if (aResponse.error) {
+    if (aResponse.error || !aResponse.sources) {
       let msg = "Error getting sources: " + aResponse.message;
       Cu.reportError(msg);
       dumpn(msg);
       return;
     }
 
     if (aResponse.sources.length === 0) {
       DebuggerView.Sources.emptyText = L10N.getStr("noSourcesText");
