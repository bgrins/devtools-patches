# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  9c7bb8874337c2d40aef3d9945b10490a5115188
Bug 1471734 - Move OSX dock menu markup to hiddenWindow.xul;r=Gijs

It's currently in macWindow.inc.xul which means it gets created for
all non-browser windows, but it's only ever set up for the hidden window.

diff --git a/browser/base/content/hiddenWindow.xul b/browser/base/content/hiddenWindow.xul
--- a/browser/base/content/hiddenWindow.xul
+++ b/browser/base/content/hiddenWindow.xul
@@ -13,11 +13,23 @@
 ]>
 
 <window id="main-window"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
 
 #include macWindow.inc.xul
 
+<!-- Dock menu -->
+<popupset>
+  <menupopup id="menu_mac_dockmenu">
+    <!-- The command cannot be cmd_newNavigator because we need to activate
+         the application. -->
+    <menuitem label="&newNavigatorCmd.label;" oncommand="OpenBrowserWindowFromDockMenu();"
+              id="macDockMenuNewWindow" />
+    <menuitem label="&newPrivateWindow.label;" oncommand="OpenBrowserWindowFromDockMenu({private: true});"
+              id="macDockMenuNewPrivateWindow" />
+  </menupopup>
+</popupset>
+
 </window>
 
 #endif
diff --git a/browser/base/content/macWindow.inc.xul b/browser/base/content/macWindow.inc.xul
--- a/browser/base/content/macWindow.inc.xul
+++ b/browser/base/content/macWindow.inc.xul
@@ -51,20 +51,8 @@
 # All sets except for popupsets (commands, keys, stringbundles and broadcasters)
 # *must* go into the browser-sets.inc file so that they can be shared with
 # browser.xul
 #include browser-sets.inc
 
 # The entire main menubar is placed into browser-menubar.inc, so that it can be
 # shared with browser.xul.
 #include browser-menubar.inc
-
-<!-- Dock menu -->
-<popupset>
-  <menupopup id="menu_mac_dockmenu">
-    <!-- The command cannot be cmd_newNavigator because we need to activate
-         the application. -->
-    <menuitem label="&newNavigatorCmd.label;" oncommand="OpenBrowserWindowFromDockMenu();"
-              id="macDockMenuNewWindow" />
-    <menuitem label="&newPrivateWindow.label;" oncommand="OpenBrowserWindowFromDockMenu({private: true});"
-              id="macDockMenuNewPrivateWindow" />
-  </menupopup>
-</popupset>
