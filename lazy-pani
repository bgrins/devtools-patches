# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  54d68aecf7f99b00b3b5289d91af6f7deaceb13f

diff --git a/browser/components/customizableui/CustomizableWidgets.jsm b/browser/components/customizableui/CustomizableWidgets.jsm
--- a/browser/components/customizableui/CustomizableWidgets.jsm
+++ b/browser/components/customizableui/CustomizableWidgets.jsm
@@ -788,18 +788,51 @@ if (Services.prefs.getBoolPref("privacy.
     handleEvent(aEvent) {
       switch (aEvent.type) {
         case "command":
           this.forgetButtonCalled(aEvent);
           break;
       }
     },
     onViewShowing(aEvent) {
+      let doc = aEvent.target.ownerDocument;
+      if (!doc.querySelector("#PanelUI-panic-timeframe")) {
+        aEvent.target.appendChild(aEvent.target.ownerGlobal.MozXULElement.parseXULToFragment(`
+        <vbox class="panel-subview-body">
+          <hbox id="PanelUI-panic-timeframe">
+            <image id="PanelUI-panic-timeframe-icon" alt=""/>
+            <vbox flex="1">
+              <description id="PanelUI-panic-mainDesc">&panicButton.view.mainTimeframeDesc;</description>
+              <radiogroup id="PanelUI-panic-timeSpan" aria-labelledby="PanelUI-panic-mainDesc" closemenu="none">
+                <radio id="PanelUI-panic-5min" label="&panicButton.view.5min;" selected="true"
+                      value="5" class="subviewradio"/>
+                <radio id="PanelUI-panic-2hr" label="&panicButton.view.2hr;"
+                      value="2" class="subviewradio"/>
+                <radio id="PanelUI-panic-day" label="&panicButton.view.day;"
+                      value="6" class="subviewradio"/>
+              </radiogroup>
+            </vbox>
+          </hbox>
+          <vbox id="PanelUI-panic-explanations">
+            <label id="PanelUI-panic-actionlist-main-label">&panicButton.view.mainActionDesc;</label>
+
+            <label id="PanelUI-panic-actionlist-windows" class="PanelUI-panic-actionlist">&panicButton.view.deleteTabsAndWindows;</label>
+            <label id="PanelUI-panic-actionlist-cookies" class="PanelUI-panic-actionlist">&panicButton.view.deleteCookies;</label>
+            <label id="PanelUI-panic-actionlist-history" class="PanelUI-panic-actionlist">&panicButton.view.deleteHistory;</label>
+            <label id="PanelUI-panic-actionlist-newwindow" class="PanelUI-panic-actionlist">&panicButton.view.openNewWindow;</label>
+
+            <label id="PanelUI-panic-warning">&panicButton.view.undoWarning;</label>
+          </vbox>
+          <button id="PanelUI-panic-view-button"
+                  label="&panicButton.view.forgetButton;"/>
+        </vbox>
+          `, ["chrome://browser/locale/browser.dtd"]));
+      }
+
       let forgetButton = aEvent.target.querySelector("#PanelUI-panic-view-button");
-      let doc = aEvent.target.ownerDocument;
       let group = doc.getElementById("PanelUI-panic-timeSpan");
       group.selectedItem = doc.getElementById("PanelUI-panic-5min");
       forgetButton.addEventListener("command", this);
     },
     onViewHiding(aEvent) {
       let forgetButton = aEvent.target.querySelector("#PanelUI-panic-view-button");
       forgetButton.removeEventListener("command", this);
     },
diff --git a/browser/components/customizableui/content/panelUI.inc.xul b/browser/components/customizableui/content/panelUI.inc.xul
--- a/browser/components/customizableui/content/panelUI.inc.xul
+++ b/browser/components/customizableui/content/panelUI.inc.xul
@@ -628,44 +628,16 @@
           <vbox id="PanelUI-characterEncodingView-autodetect"
                 class="PanelUI-characterEncodingView-list"/>
         </vbox>
       </vbox>
     </panelview>
 
     <panelview id="PanelUI-panicView" flex="1"
                descriptionheightworkaround="true">
-      <vbox class="panel-subview-body">
-        <hbox id="PanelUI-panic-timeframe">
-          <image id="PanelUI-panic-timeframe-icon" alt=""/>
-          <vbox flex="1">
-            <description id="PanelUI-panic-mainDesc">&panicButton.view.mainTimeframeDesc;</description>
-            <radiogroup id="PanelUI-panic-timeSpan" aria-labelledby="PanelUI-panic-mainDesc" closemenu="none">
-              <radio id="PanelUI-panic-5min" label="&panicButton.view.5min;" selected="true"
-                     value="5" class="subviewradio"/>
-              <radio id="PanelUI-panic-2hr" label="&panicButton.view.2hr;"
-                     value="2" class="subviewradio"/>
-              <radio id="PanelUI-panic-day" label="&panicButton.view.day;"
-                     value="6" class="subviewradio"/>
-            </radiogroup>
-          </vbox>
-        </hbox>
-        <vbox id="PanelUI-panic-explanations">
-          <label id="PanelUI-panic-actionlist-main-label">&panicButton.view.mainActionDesc;</label>
-
-          <label id="PanelUI-panic-actionlist-windows" class="PanelUI-panic-actionlist">&panicButton.view.deleteTabsAndWindows;</label>
-          <label id="PanelUI-panic-actionlist-cookies" class="PanelUI-panic-actionlist">&panicButton.view.deleteCookies;</label>
-          <label id="PanelUI-panic-actionlist-history" class="PanelUI-panic-actionlist">&panicButton.view.deleteHistory;</label>
-          <label id="PanelUI-panic-actionlist-newwindow" class="PanelUI-panic-actionlist">&panicButton.view.openNewWindow;</label>
-
-          <label id="PanelUI-panic-warning">&panicButton.view.undoWarning;</label>
-        </vbox>
-        <button id="PanelUI-panic-view-button"
-                label="&panicButton.view.forgetButton;"/>
-      </vbox>
     </panelview>
 
     <panelview id="appMenu-moreView" title="&moreMenu.label;" class="PanelUI-subView">
       <vbox class="panel-subview-body">
         <toolbarbutton id="appMenu-taskmanager-button"
                        class="subviewbutton subviewbutton-iconic"
                        label="&taskManagerCmd.label;"
                        oncommand="switchToTabHavingURI('about:performance', true)"/>
