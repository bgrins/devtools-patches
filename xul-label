# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  3cc04ee79005058d817daf66da7963dfac3f0a3a

diff --git a/dom/base/Element.cpp b/dom/base/Element.cpp
--- a/dom/base/Element.cpp
+++ b/dom/base/Element.cpp
@@ -589,16 +589,22 @@ Element::WrapObject(JSContext *aCx, JS::
 
   nsIDocument* doc = GetComposedDoc();
   if (!doc) {
     // There's no baseclass that cares about this call so we just
     // return here.
     return obj;
   }
 
+  if (!XRE_IsParentProcess()) {
+    // Disable in-content XBL wrapping
+    printf("Returning\n");
+    return obj;
+  }
+
   // We must ensure that the XBL Binding is installed before we hand
   // back this object.
 
   if (HasFlag(NODE_MAY_BE_IN_BINDING_MNGR) && GetXBLBinding()) {
     // There's already a binding for this element so nothing left to
     // be done here.
 
     // In theory we could call ExecuteAttachedHandler here when it's safe to
diff --git a/toolkit/content/customElements.js b/toolkit/content/customElements.js
--- a/toolkit/content/customElements.js
+++ b/toolkit/content/customElements.js
@@ -236,16 +236,29 @@ class MozBaseControl extends MozXULEleme
 
 MozXULElement.implementCustomInterface(MozBaseControl, [Ci.nsIDOMXULControlElement]);
 
 // Attach the base class to the window so other scripts can use it:
 window.MozElementMixin = MozElementMixin;
 window.MozXULElement = MozXULElement;
 window.MozBaseControl = MozBaseControl;
 
+
+customElements.define("label", class Label extends MozElementMixin(XULTextElement) {
+  constructor() {
+    super();
+  }
+  connectedCallback() {
+    if (this.delayConnectedCallback()) {
+      return;
+    }
+    // console.log("HI");
+  }
+});
+
 // For now, don't load any elements in the extension dummy document.
 // We will want to load <browser> when that's migrated (bug 1441935).
 const isDummyDocument = document.documentURI == "chrome://extensions/content/dummy.xul";
 if (!isDummyDocument) {
   for (let script of [
     "chrome://global/content/elements/general.js",
     "chrome://global/content/elements/progressmeter.js",
     "chrome://global/content/elements/radio.js",
diff --git a/toolkit/content/xul.css b/toolkit/content/xul.css
--- a/toolkit/content/xul.css
+++ b/toolkit/content/xul.css
@@ -95,22 +95,22 @@ page {
 
 vbox {
   -moz-box-orient: vertical;
 }
 
 /********** label **********/
 
 label.text-link, label[onclick] {
-  -moz-binding: url("chrome://global/content/bindings/text.xml#text-link");
+  /* -moz-binding: url("chrome://global/content/bindings/text.xml#text-link"); */
   -moz-user-focus: normal;
 }
 
 label[control], label.radio-label, label.checkbox-label, label.toolbarbutton-multiline-text {
-  -moz-binding: url("chrome://global/content/bindings/text.xml#label-control");
+  /* -moz-binding: url("chrome://global/content/bindings/text.xml#label-control"); */
 }
 
 label html|span.accesskey {
   text-decoration: underline;
 }
 
 /********** button **********/
 
