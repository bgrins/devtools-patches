# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Date 1538684183 25200
#      Thu Oct 04 13:16:23 2018 -0700
# Node ID 494a9e809bcb68a0d9342bec83ac3d85292bba51
# Parent  f87eeba88f1cf3f4d41095f7a58cb518a59f844c
Bug 1496478 - Only change the search engine when scrolling on searchbox if accel key is pressed;r=adw

The Custom Element migration missed the [modifiers=accel] in XBL on the DOMMouseScroll handler.

Differential Revision: https://phabricator.services.mozilla.com/D7780

diff --git a/browser/components/search/content/searchbar.js b/browser/components/search/content/searchbar.js
--- a/browser/components/search/content/searchbar.js
+++ b/browser/components/search/content/searchbar.js
@@ -399,17 +399,21 @@ class MozSearchbar extends MozXULElement
           installCallback);
       } else
         return;
 
       this.focus();
       this.select();
     });
 
-    this.addEventListener("DOMMouseScroll", (event) => { this.selectEngine(event, (event.detail > 0)); }, true);
+    this.addEventListener("DOMMouseScroll", (event) => {
+      if (event.getModifierState("Accel")) {
+        this.selectEngine(event, event.detail > 0);
+      }
+    }, true);
 
     this.addEventListener("input", (event) => { this.updateGoButtonVisibility(); });
 
     this.addEventListener("drop", (event) => { this.updateGoButtonVisibility(); });
 
     this.addEventListener("blur", (event) => {
       // If the input field is still focused then a different window has
       // received focus, ignore the next focus event.
