# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  8dac48a684eebfad868cd6df3ef4a852e7f48471
Bug 1016024

diff --git a/devtools/client/webconsole/test/browser_webconsole_bug_1006027_message_timestamps_incorrect.js b/devtools/client/webconsole/test/browser_webconsole_bug_1006027_message_timestamps_incorrect.js
--- a/devtools/client/webconsole/test/browser_webconsole_bug_1006027_message_timestamps_incorrect.js
+++ b/devtools/client/webconsole/test/browser_webconsole_bug_1006027_message_timestamps_incorrect.js
@@ -9,16 +9,18 @@ function test() {
   Task.spawn(runner).then(finishTest);
 
   function* runner() {
     const {tab} = yield loadTab("data:text/html;charset=utf8,<title>Test for " +
                                 "Bug 1006027");
 
     const hud = yield openConsole(tab);
 
+    let startTime = (new Date()).getTime();
+
     hud.jsterm.execute("console.log('bug1006027')");
 
     yield waitForMessages({
       webconsole: hud,
       messages: [{
         name: "console.log",
         text: "bug1006027",
         category: CATEGORY_WEBDEV,
@@ -34,12 +36,16 @@ function test() {
         // the epoch.
         // This is not the correct value of the timestamp, but good enough for
         // comparison.
         return Date.parse("T" + String.trim(value.textContent));
       });
 
     let minTimestamp = Math.min.apply(null, aTimestampMilliseconds);
     let maxTimestamp = Math.max.apply(null, aTimestampMilliseconds);
-    ok(Math.abs(maxTimestamp - minTimestamp) < 2000,
-       "console.log message timestamp spread < 2000ms confirmed");
+    let timeDifference = Math.abs(maxTimestamp - minTimestamp);
+    let totalTime = (new Date()).getTime() - startTime;
+
+    info("Total time for script " + totalTime + "ms.  Should be less than " + timeDifference + "ms");
+    ok(timeDifference < totalTime,
+       "console.log message timestamp spread less than time it took to run the script");
   }
 }
