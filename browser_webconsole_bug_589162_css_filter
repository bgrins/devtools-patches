# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  a97eec37ec2d4ded719ad996d75c431b7043fa5a
Bug 1256833 -  Fix eslint issues in devtools/client/webconsole/test/browser_webconsole_bug_589162_css_filter.js;r=pbro

MozReview-Commit-ID: LRbG1muyjqr

diff --git a/devtools/client/webconsole/test/browser_webconsole_bug_589162_css_filter.js b/devtools/client/webconsole/test/browser_webconsole_bug_589162_css_filter.js
--- a/devtools/client/webconsole/test/browser_webconsole_bug_589162_css_filter.js
+++ b/devtools/client/webconsole/test/browser_webconsole_bug_589162_css_filter.js
@@ -7,37 +7,33 @@
 
 const TEST_URI = "data:text/html;charset=utf-8,<div style='font-size:3em;" +
                  "foobarCssParser:baz'>test CSS parser filter</div>";
 
 /**
  * Unit test for bug 589162:
  * CSS filtering on the console does not work
  */
-function test() {
-  Task.spawn(runner).then(finishTest);
+add_task(function* () {
+  let {tab} = yield loadTab(TEST_URI);
+  let hud = yield openConsole(tab);
 
-  function* runner() {
-    let {tab} = yield loadTab(TEST_URI);
-    let hud = yield openConsole(tab);
+  // CSS warnings are disabled by default.
+  hud.setFilterState("cssparser", true);
+  hud.jsterm.clearOutput();
 
-    // CSS warnings are disabled by default.
-    hud.setFilterState("cssparser", true);
-    hud.jsterm.clearOutput();
+  BrowserReload();
 
-    content.location.reload();
+  yield waitForMessages({
+    webconsole: hud,
+    messages: [{
+      text: "foobarCssParser",
+      category: CATEGORY_CSS,
+      severity: SEVERITY_WARNING,
+    }],
+  });
 
-    yield waitForMessages({
-      webconsole: hud,
-      messages: [{
-        text: "foobarCssParser",
-        category: CATEGORY_CSS,
-        severity: SEVERITY_WARNING,
-      }],
-    });
+  hud.setFilterState("cssparser", false);
 
-    hud.setFilterState("cssparser", false);
-
-    let msg = "the unknown CSS property warning is not displayed, " +
-              "after filtering";
-    testLogEntry(hud.outputNode, "foobarCssParser", msg, true, true);
-  }
-}
+  let msg = "the unknown CSS property warning is not displayed, " +
+            "after filtering";
+  testLogEntry(hud.outputNode, "foobarCssParser", msg, true, true);
+});
