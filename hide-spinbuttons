# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  77bbeb3cc54ee2e57f85725a60b6a1129e3748f7
Bug 1417708 - Remove hidespinbuttons attribute and only consumer (print preview)

This will make it possible to switch to input[type=number] which doesn't provide
the option to hide the buttons

diff --git a/editor/reftests/xul/number-2.xul b/editor/reftests/xul/number-2.xul
--- a/editor/reftests/xul/number-2.xul
+++ b/editor/reftests/xul/number-2.xul
@@ -2,11 +2,11 @@
 <?xml-stylesheet href="chrome://global/skin" type="text/css"?>
 
 <window xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
         xmlns:html="http://www.w3.org/1999/xhtml"
         title="Textbox tests">
 
   <script type="text/javascript" src="platform.js"/>
 
-  <textbox type="number" hidespinbuttons="false"/>
+  <textbox type="number"/>
       
 </window>
diff --git a/editor/reftests/xul/number-3.xul b/editor/reftests/xul/number-3.xul
--- a/editor/reftests/xul/number-3.xul
+++ b/editor/reftests/xul/number-3.xul
@@ -2,11 +2,11 @@
 <?xml-stylesheet href="chrome://global/skin" type="text/css"?>
 
 <window xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
         xmlns:html="http://www.w3.org/1999/xhtml"
         title="Textbox tests">
 
   <script type="text/javascript" src="platform.js"/>
 
-  <textbox type="number" hidespinbuttons="true"/>
+  <textbox type="number"/>
       
 </window>
diff --git a/editor/reftests/xul/number-4.xul b/editor/reftests/xul/number-4.xul
--- a/editor/reftests/xul/number-4.xul
+++ b/editor/reftests/xul/number-4.xul
@@ -2,11 +2,11 @@
 <?xml-stylesheet href="chrome://global/skin" type="text/css"?>
 
 <window xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
         xmlns:html="http://www.w3.org/1999/xhtml"
         title="Textbox tests">
 
   <script type="text/javascript" src="platform.js"/>
 
-  <textbox type="number" value="1" hidespinbuttons="true"/>
+  <textbox type="number" value="1"/>
       
 </window>
diff --git a/editor/reftests/xul/number-5.xul b/editor/reftests/xul/number-5.xul
--- a/editor/reftests/xul/number-5.xul
+++ b/editor/reftests/xul/number-5.xul
@@ -2,11 +2,11 @@
 <?xml-stylesheet href="chrome://global/skin" type="text/css"?>
 
 <window xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
         xmlns:html="http://www.w3.org/1999/xhtml"
         title="Textbox tests">
 
   <script type="text/javascript" src="platform.js"/>
 
-  <textbox type="number" value="test" hidespinbuttons="true"/>
+  <textbox type="number" value="test"/>
       
 </window>
diff --git a/editor/reftests/xul/number-ref.xul b/editor/reftests/xul/number-ref.xul
--- a/editor/reftests/xul/number-ref.xul
+++ b/editor/reftests/xul/number-ref.xul
@@ -3,11 +3,11 @@
 <?xml-stylesheet href="chrome://reftest/content/input.css" type="text/css"?>
 
 <window xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
         xmlns:html="http://www.w3.org/1999/xhtml"
         title="Textbox tests">
 
   <script type="text/javascript" src="platform.js"/>
 
-  <html:input value="0" class="num"/>
+  <html:input type="number" value="0" class="num"/>
       
 </window>
diff --git a/editor/reftests/xul/numberwithvalue-1.xul b/editor/reftests/xul/numberwithvalue-1.xul
--- a/editor/reftests/xul/numberwithvalue-1.xul
+++ b/editor/reftests/xul/numberwithvalue-1.xul
@@ -2,11 +2,11 @@
 <?xml-stylesheet href="chrome://global/skin" type="text/css"?>
 
 <window xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
         xmlns:html="http://www.w3.org/1999/xhtml"
         title="Textbox tests">
 
   <script type="text/javascript" src="platform.js"/>
 
-  <textbox type="number" value="123" hidespinbuttons="true"/>
+  <textbox type="number" value="123"/>
       
 </window>
diff --git a/editor/reftests/xul/numberwithvalue-ref.xul b/editor/reftests/xul/numberwithvalue-ref.xul
--- a/editor/reftests/xul/numberwithvalue-ref.xul
+++ b/editor/reftests/xul/numberwithvalue-ref.xul
@@ -3,11 +3,11 @@
 <?xml-stylesheet href="chrome://reftest/content/input.css" type="text/css"?>
 
 <window xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
         xmlns:html="http://www.w3.org/1999/xhtml"
         title="Textbox tests">
 
   <script type="text/javascript" src="platform.js"/>
 
-  <html:input value="123" class="num"/>
+  <html:input type="number" value="123" class="num"/>
       
 </window>
diff --git a/toolkit/components/printing/content/printPreviewBindings.xml b/toolkit/components/printing/content/printPreviewBindings.xml
--- a/toolkit/components/printing/content/printPreviewBindings.xml
+++ b/toolkit/components/printing/content/printPreviewBindings.xml
@@ -32,17 +32,17 @@
         <xul:label value="&page.label;" accesskey="&page.accesskey;" control="pageNumber"/>
       </xul:vbox>
       <xul:toolbarbutton anonid="navigateHome" class="navigate-button tabbable"
         oncommand="parentNode.navigate(0, 0, 'home');" tooltiptext="&homearrow.tooltip;"/>
       <xul:toolbarbutton anonid="navigatePrevious" class="navigate-button tabbable"
         oncommand="parentNode.navigate(-1, 0, 0);" tooltiptext="&previousarrow.tooltip;"/>
       <xul:hbox align="center" pack="center">
         <xul:textbox id="pageNumber" size="3" value="1" min="1" type="number"
-          hidespinbuttons="true" onchange="navigate(0, this.valueNumber, 0);"/>
+          onchange="navigate(0, this.valueNumber, 0);"/>
         <xul:label value="&of.label;"/>
         <xul:label value="1"/>
       </xul:hbox>
       <xul:toolbarbutton anonid="navigateNext" class="navigate-button tabbable"
         oncommand="parentNode.navigate(1, 0, 0);" tooltiptext="&nextarrow.tooltip;"/>
       <xul:toolbarbutton anonid="navigateEnd" class="navigate-button tabbable"
         oncommand="parentNode.navigate(0, 0, 'end');" tooltiptext="&endarrow.tooltip;"/>
 
diff --git a/toolkit/content/tests/chrome/test_textbox_number.xul b/toolkit/content/tests/chrome/test_textbox_number.xul
--- a/toolkit/content/tests/chrome/test_textbox_number.xul
+++ b/toolkit/content/tests/chrome/test_textbox_number.xul
@@ -20,17 +20,17 @@
   <textbox id="n4" type="number" size="4" value="-2" min="-8" max="18"/>
   <textbox id="n5" type="number" value="-17" min="-10" max="-3"/>
 </hbox>
 <hbox>
   <textbox id="n6" type="number" size="4" value="9" min="12" max="8"/>
 </hbox>
 <hbox>
   <textbox id="n7" type="number" size="4" value="4.678" min="2" max="10.5" decimalplaces="2"/>
-  <textbox id="n8" type="number" hidespinbuttons="true"/>
+  <textbox id="n8" type="number"/>
 </hbox>
 <hbox>
   <textbox id="n9" type="number" size="4" oninput="updateInputEventCount();"/>
 </hbox>
 
   <!-- test results are displayed in the html:body -->
   <body xmlns="http://www.w3.org/1999/xhtml" style="height: 300px; overflow: auto;"/>
 
@@ -210,20 +210,16 @@ function doTests() {
 
   n1.readOnly = false;
   n1.disabled = true;
   synthesizeMouseExpectEvent(sb, 2, 2, { }, n1, "!change", "mouse up disabled");
   is(n1.value, "12", "mouse up disabled value");
   synthesizeMouseExpectEvent(sb, 2, sbbottom, { }, n1, "!change", "mouse down disabled");
   is(n1.value, "12", "mouse down disabled value");
 
-  var nsbrect = $("n8").spinButtons.getBoundingClientRect();
-  ok(nsbrect.left == 0 && nsbrect.top == 0 && nsbrect.right == 0, nsbrect.bottom == 0,
-     "hidespinbuttons");
-
   var n9 = $("n9");
   is(n9.value, "0", "initial value");
   n9.select();
   synthesizeKey("4", {});
   is(inputEventCount, 1, "input event count");
   is(inputEventValue, "4", "input value");
   is(n9.value, "4", "updated value");
   synthesizeKey("2", {});
diff --git a/toolkit/content/widgets/numberbox.xml b/toolkit/content/widgets/numberbox.xml
--- a/toolkit/content/widgets/numberbox.xml
+++ b/toolkit/content/widgets/numberbox.xml
@@ -17,17 +17,17 @@
       <stylesheet src="chrome://global/skin/numberbox.css"/>
     </resources>
 
     <content>
       <xul:hbox class="textbox-input-box numberbox-input-box" flex="1" xbl:inherits="context,disabled,focused">
         <html:input class="numberbox-input textbox-input" anonid="input"
                     xbl:inherits="value,maxlength,disabled,size,readonly,placeholder,tabindex,accesskey"/>
       </xul:hbox>
-      <xul:spinbuttons anonid="buttons" xbl:inherits="disabled,hidden=hidespinbuttons"/>
+      <xul:spinbuttons anonid="buttons" xbl:inherits="disabled"/>
     </content>
 
     <implementation>
       <field name="_valueEntered">false</field>
       <field name="_spinButtons">null</field>
       <field name="_value">0</field>
       <field name="decimalSymbol">"."</field>
 
diff --git a/toolkit/themes/linux/global/numberbox.css b/toolkit/themes/linux/global/numberbox.css
--- a/toolkit/themes/linux/global/numberbox.css
+++ b/toolkit/themes/linux/global/numberbox.css
@@ -22,12 +22,8 @@ html|*.numberbox-input {
 }
 
 .numberbox-input-box {
   -moz-box-align: center;
   -moz-appearance: spinner-textfield;
   margin-right: -1px;
   padding: 3px;
 }
-
-textbox[hidespinbuttons="true"] > .numberbox-input-box {
-  -moz-appearance: textfield;
-}
