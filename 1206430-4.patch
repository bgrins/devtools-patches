# vim: se ft=diff :
# HG changeset patch
# User Gabriel Luong <gabriel.luong@gmail.com>
# Date 2016-02-14 16:39
Bug 1206430 - Part 4: Add annotateScrollbar and clearScrollbarAnnotations methods to editor r=bgrins

diff --git a/devtools/client/sourceeditor/editor.js b/devtools/client/sourceeditor/editor.js
--- a/devtools/client/sourceeditor/editor.js
+++ b/devtools/client/sourceeditor/editor.js
@@ -1194,17 +1194,47 @@ Editor.prototype = {
       if (foldGutterIndex !== -1) {
         let gutters = this.config.gutters.slice();
         gutters.splice(foldGutterIndex, 1);
         this.setOption("gutters", gutters);
       }

       this.setOption("foldGutter", false);
     }
-  }
+  },
+
+  /**
+   * Creates a new scrollbar annotation in the editor with the given set of
+   * annotations ranges.
+   *
+   * @param  {String} className
+   *         The class name for the set of annotations to be created.
+   * @param  {Array} annotations
+   *         An array of {from: CodeMirror.Pos, to: CodeMirror.Pos} objects
+   *         marking the ranges to be highlighted in the scrollbar.
+   * @return a CodeMirror.Annotation object that has a clear method for
+   *         clearing the annotations.
+   */
+  annotateScrollbar: function(className, annotations) {
+    let cm = editors.get(this);
+    let annotation = cm.annotateScrollbar({className});
+    // Highlight the given annotation ranges
+    annotation.update(annotations);
+    return annotation;
+  },
+
+  /**
+   * Clear the scrollbar annotations.
+   */
+  clearScrollbarAnnotations: function() {
+    let cm = editors.get(this);
+    let el = cm.getWrapperElement();
+    let annotations = el.querySelector(".CodeMirror-scrollbar-annotations");
+    annotations.innerHTML = "";
+  },
 };

 // Since Editor is a thin layer over CodeMirror some methods
 // are mapped directlyâ€”without any changes.

 CM_MAPPING.forEach(name => {
   Editor.prototype[name] = function(...args) {
     let cm = editors.get(this);
