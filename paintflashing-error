# HG changeset patch
# Parent 4d3de8a8f07da33aa06dcc25259f28423d3d296f
# User Brian Grinstead <bgrinstead@mozilla.com>
Bug 1058033 - Fix `window is null` error on toolbox open in paintflashing.js;r=harth

diff --git a/toolkit/devtools/gcli/commands/paintflashing.js b/toolkit/devtools/gcli/commands/paintflashing.js
--- a/toolkit/devtools/gcli/commands/paintflashing.js
+++ b/toolkit/devtools/gcli/commands/paintflashing.js
@@ -97,20 +97,24 @@ exports.items = [
   {
     name: "paintflashing toggle",
     hidden: true,
     buttonId: "command-button-paintflashing",
     buttonClass: "command-button command-button-invertable",
     state: {
       isChecked: function(aTarget) {
         if (aTarget.isLocalTab) {
+          let isChecked = false;
           let window = aTarget.tab.linkedBrowser.contentWindow;
-          let wUtils = window.QueryInterface(Ci.nsIInterfaceRequestor).
-                              getInterface(Ci.nsIDOMWindowUtils);
-          return wUtils.paintFlashing;
+          if (window) {
+            let wUtils = window.QueryInterface(Ci.nsIInterfaceRequestor).
+                                getInterface(Ci.nsIDOMWindowUtils);
+            isChecked = wUtils.paintFlashing;
+          }
+          return isChecked;
         } else {
           throw new Error("Unsupported target");
         }
       },
       onChange: function(aTarget, aChangeHandler) {
         eventEmitter.on("changed", aChangeHandler);
       },
       offChange: function(aTarget, aChangeHandler) {
