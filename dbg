# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  f1cc73e2653ee1c122c5f6a2943c912a5f2324ff

diff --git a/browser/components/search/content/searchbar.js b/browser/components/search/content/searchbar.js
--- a/browser/components/search/content/searchbar.js
+++ b/browser/components/search/content/searchbar.js
@@ -436,31 +436,31 @@ class MozSearchbar extends MozXULElement
       // textbox, that will be taken care of in the click handler.
       if (Services.focus.getLastFocusMethod(window) & Services.focus.FLAG_BYMOUSE)
         return;
 
       this.openSuggestionsPanel();
     }, true);
 
     this.addEventListener("mousedown", (event) => {
-      if (event.originalTarget.classList.contains(".searchbar-search-button")) {
+      if (event.originalTarget.closest(".searchbar-search-button")) {
         this._clickClosedPopup = this._textbox.popup._isHiding;
       }
     }, true);
 
     this.addEventListener("mousedown", (event) => {
       // Ignore clicks on the search go button.
       if (event.originalTarget.classList.contains("search-go-button")) {
         return;
       }
 
-      let isIconClick = event.originalTarget.classList.contains("searchbar-search-button");
+      let isIconClick = event.originalTarget.closest(".searchbar-search-button");
 
       // Ignore clicks on the icon if they were made to close the popup
-      if (isIconClick && this._clickClosedPopup) {
+      if (isIconClick && (this._clickClosedPopup || this._textbox.popup._isHiding)) {
         return;
       }
 
       // Open the suggestions whenever clicking on the search icon or if there
       // is text in the textbox.
       if (isIconClick || this._textbox.value) {
         this.openSuggestionsPanel(true);
       }
