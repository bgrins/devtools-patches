# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  49ca988571f264c8e7e8c0bdaab13bc216a40c61
Turn xul prefs files into xhtml

diff --git a/browser/components/about/AboutRedirector.cpp b/browser/components/about/AboutRedirector.cpp
--- a/browser/components/about/AboutRedirector.cpp
+++ b/browser/components/about/AboutRedirector.cpp
@@ -86,17 +86,17 @@ static const RedirEntry kRedirMap[] = {
     nsIAboutModule::URI_SAFE_FOR_UNTRUSTED_CONTENT |
     nsIAboutModule::URI_MUST_LOAD_IN_CHILD |
     nsIAboutModule::ALLOW_SCRIPT |
     nsIAboutModule::MAKE_LINKABLE |
     nsIAboutModule::ENABLE_INDEXED_DB },
   // the newtab's actual URL will be determined when the channel is created
   { "newtab", "about:blank",
     nsIAboutModule::ALLOW_SCRIPT },
-  { "preferences", "chrome://browser/content/preferences/in-content/preferences.xul",
+  { "preferences", "chrome://browser/content/preferences/in-content/preferences.xhtml",
     nsIAboutModule::ALLOW_SCRIPT },
   { "downloads", "chrome://browser/content/downloads/contentAreaDownloadsView.xul",
     nsIAboutModule::ALLOW_SCRIPT },
 #ifdef MOZ_SERVICES_HEALTHREPORT
   { "healthreport", "chrome://browser/content/abouthealthreport/abouthealth.xhtml",
     nsIAboutModule::ALLOW_SCRIPT },
 #endif
   { "accounts", "chrome://browser/content/aboutaccounts/aboutaccounts.xhtml",
@@ -156,17 +156,17 @@ AboutRedirector::NewChannel(nsIURI* aURI
       if (path.EqualsLiteral("newtab")) {
         // let the aboutNewTabService decide where to redirect
         nsCOMPtr<nsIAboutNewTabService> aboutNewTabService =
           do_GetService("@mozilla.org/browser/aboutnewtab-service;1", &rv);
         NS_ENSURE_SUCCESS(rv, rv);
         rv = aboutNewTabService->GetDefaultURL(url);
         NS_ENSURE_SUCCESS(rv, rv);
       } else if (path.EqualsLiteral("preferences") && !sUseOldPreferences) {
-        url.AssignASCII("chrome://browser/content/preferences/in-content-new/preferences.xul");
+        url.AssignASCII("chrome://browser/content/preferences/in-content-new/preferences.xhtml");
       }
       // fall back to the specified url in the map
       if (url.IsEmpty()) {
         url.AssignASCII(redir.url);
       }
 
       nsCOMPtr<nsIChannel> tempChannel;
       nsCOMPtr<nsIURI> tempURI;
diff --git a/browser/components/nsBrowserContentHandler.js b/browser/components/nsBrowserContentHandler.js
--- a/browser/components/nsBrowserContentHandler.js
+++ b/browser/components/nsBrowserContentHandler.js
@@ -350,17 +350,17 @@ nsBrowserContentHandler.prototype = {
       Components.utils.reportError(e);
     }
 
     var chromeParam = cmdLine.handleFlagWithParam("chrome", false);
     if (chromeParam) {
 
       // Handle old preference dialog URLs.
       if (chromeParam == "chrome://browser/content/pref/pref.xul" ||
-          chromeParam == "chrome://browser/content/preferences/preferences.xul") {
+          chromeParam == "chrome://browser/content/preferences/preferences.xhtml") {
         openPreferences({origin: "commandLineLegacy"});
         cmdLine.preventDefault = true;
       } else try {
         let resolvedURI = resolveURIInternal(cmdLine, chromeParam);
         let isLocal = uri => {
           let localSchemes = new Set(["chrome", "file", "resource"]);
           if (uri instanceof Components.interfaces.nsINestedURI) {
             uri = uri.QueryInterface(Components.interfaces.nsINestedURI).innerMostURI;
diff --git a/browser/components/preferences/in-content-new/advanced.xul b/browser/components/preferences/in-content-new/advanced.xhtml
rename from browser/components/preferences/in-content-new/advanced.xul
rename to browser/components/preferences/in-content-new/advanced.xhtml
diff --git a/browser/components/preferences/in-content-new/applications.xul b/browser/components/preferences/in-content-new/applications.xhtml
rename from browser/components/preferences/in-content-new/applications.xul
rename to browser/components/preferences/in-content-new/applications.xhtml
diff --git a/browser/components/preferences/in-content-new/containers.xul b/browser/components/preferences/in-content-new/containers.xhtml
rename from browser/components/preferences/in-content-new/containers.xul
rename to browser/components/preferences/in-content-new/containers.xhtml
diff --git a/browser/components/preferences/in-content-new/jar.mn b/browser/components/preferences/in-content-new/jar.mn
--- a/browser/components/preferences/in-content-new/jar.mn
+++ b/browser/components/preferences/in-content-new/jar.mn
@@ -1,15 +1,15 @@
 # This Source Code Form is subject to the terms of the Mozilla Public
 # License, v. 2.0. If a copy of the MPL was not distributed with this
 # file, You can obtain one at http://mozilla.org/MPL/2.0/.
 
 browser.jar:
    content/browser/preferences/in-content-new/preferences.js
-*  content/browser/preferences/in-content-new/preferences.xul
+*  content/browser/preferences/in-content-new/preferences.xhtml
    content/browser/preferences/in-content-new/subdialogs.js
 
    content/browser/preferences/in-content-new/main.js
    content/browser/preferences/in-content-new/privacy.js
    content/browser/preferences/in-content-new/containers.js
    content/browser/preferences/in-content-new/advanced.js
    content/browser/preferences/in-content-new/applications.js
    content/browser/preferences/in-content-new/sync.js
diff --git a/browser/components/preferences/in-content-new/main.xul b/browser/components/preferences/in-content-new/main.xhtml
rename from browser/components/preferences/in-content-new/main.xul
rename to browser/components/preferences/in-content-new/main.xhtml
diff --git a/browser/components/preferences/in-content-new/preferences.xul b/browser/components/preferences/in-content-new/preferences.xhtml
rename from browser/components/preferences/in-content-new/preferences.xul
rename to browser/components/preferences/in-content-new/preferences.xhtml
diff --git a/browser/components/preferences/in-content-new/privacy.xul b/browser/components/preferences/in-content-new/privacy.xhtml
rename from browser/components/preferences/in-content-new/privacy.xul
rename to browser/components/preferences/in-content-new/privacy.xhtml
diff --git a/browser/components/preferences/in-content-new/searchResults.xul b/browser/components/preferences/in-content-new/searchResults.xhtml
rename from browser/components/preferences/in-content-new/searchResults.xul
rename to browser/components/preferences/in-content-new/searchResults.xhtml
diff --git a/browser/components/preferences/in-content-new/sync.xul b/browser/components/preferences/in-content-new/sync.xhtml
rename from browser/components/preferences/in-content-new/sync.xul
rename to browser/components/preferences/in-content-new/sync.xhtml
