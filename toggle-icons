# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  48314f305f726c8e6253442167ca44f09a4c667d
Bug 1234699 - Add way to switch on emoji theme;r=helenvholmes,r=gl

MozReview-Commit-ID: F1WhlrUufBd

diff --git a/devtools/client/shared/theme-switching.js b/devtools/client/shared/theme-switching.js
--- a/devtools/client/shared/theme-switching.js
+++ b/devtools/client/shared/theme-switching.js
@@ -136,16 +136,20 @@
         }
       }
 
       // Load all stylesheets and classes from the new theme.
       for (let name of newThemeDef.classList) {
         documentElement.classList.add(name);
       }
 
+      if (enableEmojies) {
+        documentElement.classList.add("theme-emoji");
+      }
+
       if (newThemeDef.onApply) {
         newThemeDef.onApply(window, oldTheme);
       }
 
       // Final notification for further theme-switching related logic.
       gDevTools.emit("theme-switched", window, newTheme, oldTheme);
       notifyWindow();
     }, console.error.bind(console));
@@ -159,16 +163,21 @@
 
   const { classes: Cc, interfaces: Ci, utils: Cu } = Components;
   const { require } = Cu.import("resource://devtools/shared/Loader.jsm", {});
   const Services = require("Services");
   const { gDevTools } = require("devtools/client/framework/devtools");
   const StylesheetUtils = require("sdk/stylesheet/utils");
   const { watchCSS } = require("devtools/client/shared/css-reload");
 
+  let enableEmojies = false;
+  try {
+    enableEmojies = Services.prefs.getBoolPref("devtools.theme-emojies");
+  } catch(e) { }
+
   if (documentElement.hasAttribute("force-theme")) {
     switchTheme(documentElement.getAttribute("force-theme"));
   } else {
     switchTheme(Services.prefs.getCharPref("devtools.theme"));
 
     gDevTools.on("pref-changed", handlePrefChange);
     window.addEventListener("unload", function() {
       gDevTools.off("pref-changed", handlePrefChange);
diff --git a/devtools/client/themes/toolbars.css b/devtools/client/themes/toolbars.css
--- a/devtools/client/themes/toolbars.css
+++ b/devtools/client/themes/toolbars.css
@@ -743,16 +743,21 @@
 #command-button-scratchpad > image {
   background-image: url("chrome://devtools/skin/images/command-scratchpad.png");
 }
 
 #command-button-pick > image {
   background-image: url("chrome://devtools/skin/images/command-pick.png");
 }
 
+:root.theme-emoji #command-button-pick > image {
+  background-image: url("chrome://devtools/skin/images/emojis/emoji-command-pick.svg");
+  filter: none;
+}
+
 #command-button-frames > image {
   background-image: url("chrome://devtools/skin/images/command-frames.png");
 }
 
 #command-button-splitconsole > image {
   background-image: url("chrome://devtools/skin/images/command-console.png");
 }
 
@@ -907,16 +912,81 @@
   opacity: 0.8;
 }
 
 .devtools-tab:active > image,
 .devtools-tab[selected] > image {
   opacity: 1;
 }
 
+/* In emoji theme, swap the normal images with custom background images  */
+:root.theme-emoji #toolbox-tab-inspector > image,
+:root.theme-emoji #toolbox-tab-webconsole > image,
+:root.theme-emoji #toolbox-tab-jsdebugger > image,
+:root.theme-emoji #toolbox-tab-styleeditor > image,
+:root.theme-emoji #toolbox-tab-shadereditor > image,
+:root.theme-emoji #toolbox-tab-canvasdebugger > image,
+:root.theme-emoji #toolbox-tab-performance > image,
+:root.theme-emoji #toolbox-tab-memory > image,
+:root.theme-emoji #toolbox-tab-netmonitor > image,
+:root.theme-emoji #toolbox-tab-storage > image,
+:root.theme-emoji #toolbox-tab-webaudioeditor > image {
+  border: solid;
+  border-width: 0 16px 16px 0;
+  border-color: transparent;
+  width: 0;
+  filter: none !important;
+  opacity: 1;
+}
+
+/* In emoji theme, set the emojis as background-images */
+:root.theme-emoji #toolbox-tab-inspector > image {
+  background-image: url("chrome://devtools/skin/images/emojis/emoji-tool-inspector.svg");
+}
+
+:root.theme-emoji #toolbox-tab-webconsole > image {
+  background-image: url("chrome://devtools/skin/images/emojis/emoji-tool-webconsole.svg");
+}
+
+:root.theme-emoji #toolbox-tab-jsdebugger > image {
+  background-image: url("chrome://devtools/skin/images/emojis/emoji-tool-debugger.svg");
+}
+
+:root.theme-emoji #toolbox-tab-styleeditor > image {
+  background-image: url("chrome://devtools/skin/images/emojis/emoji-tool-styleeditor.svg");
+}
+
+:root.theme-emoji #toolbox-tab-shadereditor > image {
+  background-image: url("chrome://devtools/skin/images/emojis/emoji-tool-shadereditor.svg");
+}
+
+:root.theme-emoji #toolbox-tab-canvasdebugger > image {
+  background-image: url("chrome://devtools/skin/images/emojis/emoji-tool-canvas.svg");
+}
+
+:root.theme-emoji #toolbox-tab-performance > image {
+  background-image: url("chrome://devtools/skin/images/emojis/emoji-tool-profiler.svg");
+}
+
+:root.theme-emoji #toolbox-tab-memory > image {
+  background-image: url("chrome://devtools/skin/images/emojis/emoji-tool-memory.svg");
+}
+
+:root.theme-emoji #toolbox-tab-netmonitor > image {
+  background-image: url("chrome://devtools/skin/images/emojis/emoji-tool-network.svg");
+}
+
+:root.theme-emoji #toolbox-tab-storage > image {
+  background-image: url("chrome://devtools/skin/images/emojis/emoji-tool-storage.svg");
+}
+
+:root.theme-emoji #toolbox-tab-webaudioeditor > image {
+  background-image: url("chrome://devtools/skin/images/emojis/emoji-tool-webaudio.svg");
+}
+
 .devtools-tabbar .devtools-tab[selected],
 .devtools-tabbar .devtools-tab[selected]:hover:active {
   color: var(--theme-selection-color);
   background-color: var(--theme-selection-background);
 }
 
 .theme-dark .devtools-tabbar .devtools-tab[selected] {
   box-shadow: 0 2px 0 #d7f1ff inset,
