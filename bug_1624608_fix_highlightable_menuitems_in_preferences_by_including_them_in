# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Date 1585327233 25200
#      Fri Mar 27 09:40:33 2020 -0700
# Node ID d164fb0f450ae688a8d4f31a5ed47e163e746209
# Parent  4c982daa151954c59f20a9b9ac805c1768a350c2
Bug 1624608 - Fix highlightable menuitems in preferences by including them in searchWithinNode

The XBL implementation used to be included because `nodeObject.childElementCount == 0`, but
there are children with the Custom Element. So include menuitems in the whitelist.

Differential Revision: https://phabricator.services.mozilla.com/D68592

diff --git a/browser/components/preferences/in-content/findInPage.js b/browser/components/preferences/in-content/findInPage.js
--- a/browser/components/preferences/in-content/findInPage.js
+++ b/browser/components/preferences/in-content/findInPage.js
@@ -370,17 +370,18 @@ var gSearchResultsPane = {
    */
   async searchWithinNode(nodeObject, searchPhrase) {
     let matchesFound = false;
     if (
       nodeObject.childElementCount == 0 ||
       nodeObject.tagName == "button" ||
       nodeObject.tagName == "label" ||
       nodeObject.tagName == "description" ||
-      nodeObject.tagName == "menulist"
+      nodeObject.tagName == "menulist" ||
+      nodeObject.tagName == "menuitem"
     ) {
       let simpleTextNodes = this.textNodeDescendants(nodeObject);
       for (let node of simpleTextNodes) {
         let result = this.highlightMatches(
           [node],
           [node.length],
           node.textContent.toLowerCase(),
           searchPhrase
