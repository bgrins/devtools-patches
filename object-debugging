# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  b51c51f535cec861cfeec7980eb5c661a3f7f233
Bug 1382833 - Temp workaround for Browser Console and unsafe cpows

diff --git a/devtools/server/actors/object.js b/devtools/server/actors/object.js
--- a/devtools/server/actors/object.js
+++ b/devtools/server/actors/object.js
@@ -87,19 +87,25 @@ ObjectActor.prototype = {
     // If it's a proxy, lie and tell that it belongs to an invented
     // "Proxy" class, and avoid calling the [[IsExtensible]] trap
     if (this.obj.isProxy) {
       g.class = "Proxy";
       g.proxyTarget = this.hooks.createValueGrip(this.obj.proxyTarget);
       g.proxyHandler = this.hooks.createValueGrip(this.obj.proxyHandler);
     } else {
       g.class = this.obj.class;
-      g.extensible = this.obj.isExtensible();
-      g.frozen = this.obj.isFrozen();
-      g.sealed = this.obj.isSealed();
+      try {
+        g.extensible = this.obj.isExtensible();
+        g.frozen = this.obj.isFrozen();
+        g.sealed = this.obj.isSealed();
+      } catch(e) {
+        // XXX: Find a better way to detect unsafe CPOW
+        this.hooks.decrementGripDepth();
+        return g;
+      }
     }
 
     if (g.class != "DeadObject") {
       if (g.class == "Promise") {
         g.promiseState = this._createPromiseState();
       }
 
       // FF40+: Allow to know how many properties an object has
