
# HG changeset patch
# User Jan Odvarko <odvarko@gmail.com>
# Date 1500291464 -7200
# Node ID e50079ee8f5dc466b6520a7c6b17ac0cfe137373
# Parent  67cd1ee26f2661fa5efe3d952485ab3c89af4271
Bug 1375778 - Convert old console filter preferences to new ones; r=bgrins

MozReview-Commit-ID: 39wIi93JrOM

diff --git a/browser/components/nsBrowserGlue.js b/browser/components/nsBrowserGlue.js
--- a/browser/components/nsBrowserGlue.js
+++ b/browser/components/nsBrowserGlue.js
@@ -1706,17 +1706,17 @@
         return;
       this._openPreferences("sync", { origin: "doorhanger" });
     }
     this.AlertsService.showAlertNotification(null, title, body, true, null, clickCallback);
   },
 
   // eslint-disable-next-line complexity
   _migrateUI: function BG__migrateUI() {
-    const UI_VERSION = 49;
+    const UI_VERSION = 50;
     const BROWSER_DOCURL = "chrome://browser/content/browser.xul";
 
     let currentUIVersion;
     if (Services.prefs.prefHasUserValue("browser.migration.version")) {
       currentUIVersion = Services.prefs.getIntPref("browser.migration.version");
     } else {
       // This is a new profile, nothing to migrate.
       Services.prefs.setIntPref("browser.migration.version", UI_VERSION);
@@ -2049,16 +2049,26 @@
       xulStore.removeValue(BROWSER_DOCURL, "sidebar-box", "checked");
     }
 
     if (currentUIVersion < 49) {
       // Annotate that a user haven't seen any onboarding tour
       Services.prefs.setIntPref("browser.onboarding.seen-tourset-version", 0);
     }
 
+    if (currentUIVersion < 50) {
+      // Transform prefs related to old DevTools Console.
+      if (Services.prefs.getBoolPref("devtools.webconsole.filter.networkinfo")) {
+        Services.prefs.setBoolPref("devtools.webconsole.filter.net", true);
+      }
+      if (Services.prefs.getBoolPref("devtools.webconsole.filter.cssparser")) {
+        Services.prefs.setBoolPref("devtools.webconsole.filter.css", true);
+      }
+    }
+
     // Update the migration version.
     Services.prefs.setIntPref("browser.migration.version", UI_VERSION);
   },
 
   // ------------------------------
   // public nsIBrowserGlue members
   // ------------------------------
 

