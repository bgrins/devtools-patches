# HG changeset patch
# Parent 630693ac92239e8011ac68c94b58779c58aef072
# User Brian Grinstead <bgrinstead@mozilla.com>
Bug 1053434 - Part 2 - Shared theme changes for devedition.css

diff --git a/browser/base/content/browser-devedition.js b/browser/base/content/browser-devedition.js
--- a/browser/base/content/browser-devedition.js
+++ b/browser/base/content/browser-devedition.js
@@ -37,16 +37,19 @@ let DevEdition = {
     }
   },
 
   _updateDevtoolsThemeAttribute: function() {
     // Set an attribute on root element to make it possible
     // to change colors based on the selected devtools theme.
     document.documentElement.setAttribute("devtoolstheme",
       Services.prefs.getCharPref(this._devtoolsThemePrefName));
+    if (this.styleSheet) {
+      ToolbarIconColor.inferFromText();
+    }
   },
 
   _updateStyleSheet: function() {
     // Only try to apply the dev edition theme if it is preffered
     // on and there are no other themes applied.
     let lightweightThemeSelected = false;
     try {
       lightweightThemeSelected = Services.prefs.getBoolPref(this._lwThemePrefName);
diff --git a/browser/components/preferences/in-content/main.xul b/browser/components/preferences/in-content/main.xul
--- a/browser/components/preferences/in-content/main.xul
+++ b/browser/components/preferences/in-content/main.xul
@@ -13,16 +13,20 @@
     <preference id="browser.tabs.remote.autostart"
                 name="browser.tabs.remote.autostart"
                 type="bool"/>
     <preference id="e10sTempPref"
                 name="browser.tabs.remote.autostart.1"
                 type="bool"/>
 #endif
 
+    <preference id="browser.devedition.theme.enabled"
+                name="browser.devedition.theme.enabled"
+                type="bool"/>
+
     <!-- Startup -->
     <preference id="browser.startup.page"
                 name="browser.startup.page"
                 type="int"/>
     <preference id="browser.startup.homepage"
                 name="browser.startup.homepage"
                 type="wstring"/>
 
@@ -117,16 +121,20 @@
           hidden="true">
   <caption><label>&startup.label;</label></caption>
 
 #ifdef E10S_TESTING_ONLY
   <checkbox id="e10sAutoStart"
             label="Enable E10S (multi-process)"/>
 #endif
 
+  <checkbox id="deveditionTheme"
+            label="&disableDeveditionTheme.label;"
+            preference="browser.devedition.theme.enabled"/>
+
 #ifdef HAVE_SHELL_SERVICE
   <vbox id="defaultBrowserBox">
     <hbox align="center">
       <checkbox id="alwaysCheckDefault" preference="browser.shell.checkDefaultBrowser"
                 label="&alwaysCheckDefault.label;" accesskey="&alwaysCheckDefault2.accesskey;"/>
     </hbox>
     <deck id="setDefaultPane">
       <hbox align="center" class="indent">
diff --git a/browser/components/preferences/main.xul b/browser/components/preferences/main.xul
--- a/browser/components/preferences/main.xul
+++ b/browser/components/preferences/main.xul
@@ -22,16 +22,20 @@
             helpTopic="prefs-main">
 
     <script type="application/javascript" src="chrome://browser/content/preferences/main.js"/>
 
     <preferences id="mainPreferences">
       <!-- XXX Button preferences -->
 
       <!-- Startup -->
+      <preference id="browser.devedition.theme.enabled"
+                  name="browser.devedition.theme.enabled"
+                  type="bool"/>
+
       <preference id="browser.startup.page"
                   name="browser.startup.page"
                   type="int"/>
       <preference id="browser.startup.homepage"
                   name="browser.startup.homepage"
                   type="wstring"/>
 
 #ifdef HAVE_SHELL_SERVICE
@@ -72,16 +76,22 @@
     </preferences>
     
     <stringbundle id="bundlePreferences" src="chrome://browser/locale/preferences/preferences.properties"/>
 
     <!-- Startup -->
     <groupbox id="startupGroup">
       <caption label="&startup.label;"/>
 
+      <hbox align="center">
+        <checkbox id="deveditionTheme"
+                  label="&disableDeveditionTheme.label;"
+                  preference="browser.devedition.theme.enabled"/>
+      </hbox>
+
 #ifdef HAVE_SHELL_SERVICE
       <vbox id="defaultBrowserBox">
         <hbox align="center">
           <checkbox id="alwaysCheckDefault" preference="browser.shell.checkDefaultBrowser"
                     label="&alwaysCheckDefault.label;" accesskey="&alwaysCheckDefault2.accesskey;"/>
         </hbox>
         <deck id="setDefaultPane">
           <hbox align="center" class="indent">
diff --git a/browser/themes/linux/jar.mn b/browser/themes/linux/jar.mn
--- a/browser/themes/linux/jar.mn
+++ b/browser/themes/linux/jar.mn
@@ -191,16 +191,20 @@ browser.jar:
   skin/classic/browser/tabview/search.png             (tabview/search.png)
   skin/classic/browser/tabview/stack-expander.png     (tabview/stack-expander.png)
   skin/classic/browser/tabview/tabview.png            (tabview/tabview.png)
   skin/classic/browser/tabview/tabview.css            (tabview/tabview.css)
   skin/classic/browser/translating-16.png             (../shared/translation/translating-16.png)
   skin/classic/browser/translating-16@2x.png          (../shared/translation/translating-16@2x.png)
   skin/classic/browser/translation-16.png             (../shared/translation/translation-16.png)
   skin/classic/browser/translation-16@2x.png          (../shared/translation/translation-16@2x.png)
+  skin/classic/browser/devedition/Search.svg          (../shared/devedition/Search.svg)
+  skin/classic/browser/devedition/arrow-horizontal-devedition-dark.svg  (../shared/devedition/arrow-horizontal-dark-devedition.svg)
+  skin/classic/browser/devedition/arrow-vertical-devedition-dark.svg    (../shared/devedition/arrow-vertical-dark-devedition.svg)
+  skin/classic/browser/devedition/url-history-dropmarker.svg            (../shared/devedition/url-history-dropmarker.svg)
 * skin/classic/browser/devtools/common.css            (../shared/devtools/common.css)
 * skin/classic/browser/devtools/dark-theme.css        (../shared/devtools/dark-theme.css)
 * skin/classic/browser/devtools/light-theme.css       (../shared/devtools/light-theme.css)
   skin/classic/browser/devtools/filters.svg           (../shared/devtools/filters.svg)
   skin/classic/browser/devtools/controls.png          (../shared/devtools/images/controls.png)
   skin/classic/browser/devtools/controls@2x.png       (../shared/devtools/images/controls@2x.png)
   skin/classic/browser/devtools/newtab.png             (../shared/devtools/images/newtab.png)
   skin/classic/browser/devtools/newtab@2x.png          (../shared/devtools/images/newtab@2x.png)
diff --git a/browser/themes/osx/jar.mn b/browser/themes/osx/jar.mn
--- a/browser/themes/osx/jar.mn
+++ b/browser/themes/osx/jar.mn
@@ -320,16 +320,20 @@ browser.jar:
   skin/classic/browser/tabview/search.png                   (tabview/search.png)
   skin/classic/browser/tabview/stack-expander.png           (tabview/stack-expander.png)
   skin/classic/browser/tabview/tabview.png                  (tabview/tabview.png)
   skin/classic/browser/tabview/tabview.css                  (tabview/tabview.css)
   skin/classic/browser/translating-16.png                   (../shared/translation/translating-16.png)
   skin/classic/browser/translating-16@2x.png                (../shared/translation/translating-16@2x.png)
   skin/classic/browser/translation-16.png                   (../shared/translation/translation-16.png)
   skin/classic/browser/translation-16@2x.png                (../shared/translation/translation-16@2x.png)
+  skin/classic/browser/devedition/Search.svg                (../shared/devedition/Search.svg)
+  skin/classic/browser/devedition/arrow-horizontal-devedition-dark.svg  (../shared/devedition/arrow-horizontal-dark-devedition.svg)
+  skin/classic/browser/devedition/arrow-vertical-devedition-dark.svg    (../shared/devedition/arrow-vertical-dark-devedition.svg)
+  skin/classic/browser/devedition/url-history-dropmarker.svg            (../shared/devedition/url-history-dropmarker.svg)
 * skin/classic/browser/devtools/common.css                  (../shared/devtools/common.css)
 * skin/classic/browser/devtools/dark-theme.css              (../shared/devtools/dark-theme.css)
 * skin/classic/browser/devtools/light-theme.css             (../shared/devtools/light-theme.css)
   skin/classic/browser/devtools/filters.svg                 (../shared/devtools/filters.svg)
   skin/classic/browser/devtools/controls.png                (../shared/devtools/images/controls.png)
   skin/classic/browser/devtools/controls@2x.png             (../shared/devtools/images/controls@2x.png)
   skin/classic/browser/devtools/newtab.png                  (../shared/devtools/images/newtab.png)
   skin/classic/browser/devtools/newtab@2x.png               (../shared/devtools/images/newtab@2x.png)
@@ -537,16 +541,17 @@ browser.jar:
   skin/classic/browser/yosemite/sync-horizontalbar@2x.png   (sync-horizontalbar-yosemite@2x.png)
   skin/classic/browser/notification-pluginNormal.png  (../shared/plugins/notification-pluginNormal.png)
   skin/classic/browser/notification-pluginAlert.png   (../shared/plugins/notification-pluginAlert.png)
   skin/classic/browser/notification-pluginBlocked.png (../shared/plugins/notification-pluginBlocked.png)
   skin/classic/browser/notification-pluginNormal@2x.png  (../shared/plugins/notification-pluginNormal@2x.png)
   skin/classic/browser/notification-pluginAlert@2x.png   (../shared/plugins/notification-pluginAlert@2x.png)
   skin/classic/browser/notification-pluginBlocked@2x.png (../shared/plugins/notification-pluginBlocked@2x.png)
   skin/classic/browser/devtools/tooltip/arrow-horizontal-dark.png   (../shared/devtools/tooltip/arrow-horizontal-dark.png)
+  skin/classic/browser/devtools/tooltip/arrow-horizontal-dark.png   (../shared/devtools/tooltip/arrow-horizontal-dark.png)
   skin/classic/browser/devtools/tooltip/arrow-horizontal-dark@2x.png   (../shared/devtools/tooltip/arrow-horizontal-dark@2x.png)
   skin/classic/browser/devtools/tooltip/arrow-vertical-dark.png   (../shared/devtools/tooltip/arrow-vertical-dark.png)
   skin/classic/browser/devtools/tooltip/arrow-vertical-dark@2x.png   (../shared/devtools/tooltip/arrow-vertical-dark@2x.png)
   skin/classic/browser/devtools/tooltip/arrow-horizontal-light.png   (../shared/devtools/tooltip/arrow-horizontal-light.png)
   skin/classic/browser/devtools/tooltip/arrow-horizontal-light@2x.png   (../shared/devtools/tooltip/arrow-horizontal-light@2x.png)
   skin/classic/browser/devtools/tooltip/arrow-vertical-light.png   (../shared/devtools/tooltip/arrow-vertical-light.png)
   skin/classic/browser/devtools/tooltip/arrow-vertical-light@2x.png   (../shared/devtools/tooltip/arrow-vertical-light@2x.png)
 #ifdef E10S_TESTING_ONLY
diff --git a/browser/themes/shared/customizableui/panelUIOverlay.inc.css b/browser/themes/shared/customizableui/panelUIOverlay.inc.css
--- a/browser/themes/shared/customizableui/panelUIOverlay.inc.css
+++ b/browser/themes/shared/customizableui/panelUIOverlay.inc.css
@@ -13,16 +13,23 @@
 % we don't support nested calc(): https://bugzilla.mozilla.org/show_bug.cgi?id=968761
 %define menuPanelButtonWidth (@menuPanelWidth@ / 3 - 0.1px)
 %define exitSubviewGutterWidth 38px
 %define buttonStateHover :not(:-moz-any([disabled],[open],:active)):hover
 %define menuStateHover :not(:-moz-any([disabled],:active))[_moz-menuactive]
 %define buttonStateActive :not([disabled]):-moz-any([open],:hover:active)
 %define menuStateActive :not([disabled])[_moz-menuactive]:active
 
+:root {
+  --panel-toolbarbutton-hover-background-color: hsla(210,4%,10%,.08);
+  --panel-toolbarbutton-hover-border-color: hsla(210,4%,10%,.11);
+  --panel-toolbarbutton-active-background-color: hsla(210,4%,10%,.12);
+  --panel-toolbarbutton-active-border-color: hsla(210,4%,10%,.14);
+}
+
 %include ../browser.inc
 
 #PanelUI-popup #PanelUI-contents:empty {
   height: 128px;
 }
 
 #PanelUI-popup #PanelUI-contents:empty::before {
   content: "";
@@ -734,32 +741,32 @@ panelview .toolbarbutton-1,
 }
 
 panelview .toolbarbutton-1@buttonStateHover@,
 toolbarbutton.subviewbutton@buttonStateHover@,
 menu.subviewbutton@menuStateHover@,
 menuitem.subviewbutton@menuStateHover@,
 .widget-overflow-list .toolbarbutton-1@buttonStateHover@,
 .toolbaritem-combined-buttons@inAnyPanel@ > toolbarbutton@buttonStateHover@ {
-  background-color: hsla(210,4%,10%,.08);
-  border-color: hsla(210,4%,10%,.11);
+  background-color: var(--panel-toolbarbutton-hover-background-color);
+  border-color: var(--panel-toolbarbutton-hover-border-color);
 }
 
 .toolbaritem-combined-buttons@inAnyPanel@@buttonStateHover@ {
   border-color: hsla(210,4%,10%,.11);
 }
 
 panelview .toolbarbutton-1:-moz-any(@buttonStateActive@,[checked=true]),
 toolbarbutton.subviewbutton@buttonStateActive@,
 menu.subviewbutton@menuStateActive@,
 menuitem.subviewbutton@menuStateActive@,
 .widget-overflow-list .toolbarbutton-1@buttonStateActive@,
 .toolbaritem-combined-buttons@inAnyPanel@ > toolbarbutton@buttonStateActive@ {
-  background-color: hsla(210,4%,10%,.12);
-  border-color: hsla(210,4%,10%,.14);
+  background-color: var(--panel-toolbarbutton-active-background-color);
+  border-color: var(--panel-toolbarbutton-active-border-color);
   box-shadow: 0 1px 0 hsla(210,4%,10%,.03) inset;
 }
 
 .subviewbutton.panel-subview-footer {
   margin: 4px -4px -4px;
   background-color: hsla(210,4%,10%,.07);
   border-top: 1px solid hsla(210,4%,10%,.12);
   border-radius: 0;
diff --git a/browser/themes/shared/devedition.inc.css b/browser/themes/shared/devedition.inc.css
--- a/browser/themes/shared/devedition.inc.css
+++ b/browser/themes/shared/devedition.inc.css
@@ -1,3 +1,348 @@
 % This Source Code Form is subject to the terms of the Mozilla Public
 % License, v. 2.0. If a copy of the MPL was not distributed with this
 % file, You can obtain one at http://mozilla.org/MPL/2.0/.
+
+:root {
+  /* Chrome stuff */
+  --space-above-tabbar: 1px;
+  --chrome-background-color: #1C2126;
+  --chrome-color: #F5F7FA;
+  --chrome-secondary-background-color: #39424D;
+
+  --chrome-tab-color: #f5f7fa;
+  --chrome-tab-background-color: #1C2126;
+  --chrome-tab-color: #ced3d9;
+  --chrome-tab-hover-background-color: hsla(206,37%,4%,.5);
+  --chrome-tab-separator-color: #5F6670;
+  --chrome-tab-selection-color: #f5f7fa;
+  --chrome-tab-selection-background-color: #1a4666;
+  --chrome-tab-selection-box-shadow: 0 2px 0 #d7f1ff inset,
+                                     0 8px 3px -5px #2b82bf inset,
+                                     0 -2px 0 rgba(0,0,0,.2) inset;
+  --url-and-searchbar-background-color: #181B1F;
+
+  /* Toolbar buttons */
+  --toolbarbutton-hover-background: rgba(29, 79, 115, .8);
+  --toolbarbutton-hover-boxshadow: none;
+  --toolbarbutton-hover-bordercolor: #5F6670;
+
+  --toolbarbutton-active-background: rgba(29, 79, 115, 1);
+  --toolbarbutton-active-boxshadow: none;
+
+  --toolbarbutton-checkedhover-backgroundcolor: rgba(29, 79, 115, .5);
+
+  --toolbarbutton-combined-boxshadow: none;
+  --toolbarbutton-combined-backgroundimage: linear-gradient(#5F6670 0, #5F6670 18px);
+
+  /* Identity Box */
+  --identity-box-chrome-color: #46afe3;
+  --identity-box-chrome-background-image: linear-gradient(#5F6670 0, #5F6670 100%);
+  --identity-box-verified-background-image: linear-gradient(#5F6670 0, #5F6670 100%);
+
+  /* Toolbarbuttons */
+  --panel-toolbarbutton-hover-background-color: hsla(210,4%,56%,.08);
+  --panel-toolbarbutton-hover-border-color: hsla(210,4%,56%,.11);
+  --panel-toolbarbutton-active-background-color: hsla(210,4%,56%,.12);
+  --panel-toolbarbutton-active-border-color: hsla(210,4%,56%,.14);
+}
+
+:root[devtoolstheme="dark"] {
+  --searchbar-dropmarker-url: url("chrome://browser/skin/devtools/dropmarker.svg");
+  --searchbar-dropmarker-2x-url: url("chrome://browser/skin/devtools/dropmarker.svg");
+
+  /* XXX: do we really want this control, or should we just use the same dropmarker for both light and dark? */
+  --urlbar-dropmarker-url: url("chrome://browser/skin/devtools/dropmarker.svg");
+  --urlbar-dropmarker-region: auto;
+  --urlbar-dropmarker-2x-url: url("chrome://browser/skin/devtools/dropmarker.svg");
+  --urlbar-dropmarker-2x-region: auto;
+}
+
+:root[devtoolstheme="light"] {
+  --url-and-searchbar-background-color: #fff;
+
+  --chrome-background-color: #f0f1f2;
+  --chrome-color: #18191a;
+  --chrome-secondary-background-color: #ebeced;
+
+  --chrome-tab-color: #18191a;
+  --chrome-tab-background-color: #f0f1f2;
+  --chrome-tab-hover-background-color: rgba(170,170,170,.2);
+  --chrome-tab-color: #18191a;
+  --chrome-tab-separator-color: #aaa;
+  --chrome-tab-selection-color: #f5f7fa;
+  --chrome-tab-selection-background-color: #4c9ed9;
+  --chrome-tab-selection-box-shadow: 0 2px 0 #d7f1ff inset,
+                                     0 8px 3px -5px #2b82bf inset,
+                                     0 -2px 0 rgba(0,0,0,.06) inset;
+}
+
+.urlbar-history-dropmarker {
+ /* XXX: get a properly colored version of chrome://browser/skin/urlbar-history-dropmarker.png) and use
+ that instead so it is the right size */
+ -moz-image-region: auto !important;
+ list-style-image: url("chrome://browser/skin/devtools/dropmarker.svg");
+}
+
+/* XXX: why can't we just use :root in popup.css? */
+.panel-arrowcontent {
+  --panel-arrowcontent-background: rgba(19, 28, 38, 1);
+  --panel-arrowcontent-color: #F5F7FA;
+  --panel-arrowcontent-border: 3px solid #434850;
+}
+
+/* Toolbars and Tabs */
+#browser-panel, #titlebar-content {
+  /* Shows a 1px border (--space-above-tabbar)
+     of this color at the top of the browser */
+  background-color: var(--chrome-background-color);
+}
+
+.tab-close-button {
+  -moz-image-region: rect(0, 64px, 16px, 48px) !important;
+}
+
+/* XXX: Move this into a variable instead */
+:root[devtoolstheme="light"] .tab-close-button {
+  -moz-image-region: rect(0, 64px, 16px, 48px) !important;
+}
+
+::-moz-selection {
+  /* XXX: devtools dark theme selection color: #1d4f73;*/
+  background-color: #B4D5FF;
+  color: #000;
+}
+
+/* Change the color of the navigator toolbox border */
+#navigator-toolbox::after,
+#tabbrowser-tabs,
+#TabsToolbar,
+.tab-background-middle[selected],
+#tab-background-fill {
+  background: var(--chrome-background-color);
+  color: var(--chrome-color);
+}
+
+#navigator-toolbox > toolbar:not(#toolbar-menubar):not(#TabsToolbar),
+#browser-bottombox,
+.browserContainer > findbar {
+  background: var(--chrome-secondary-background-color) !important;
+  color: var(--chrome-color);
+}
+
+#navigator-toolbox > toolbar .toolbarbutton-text,
+#browser-bottombox .toolbarbutton-text,
+.browserContainer > findbar .toolbarbutton-text {
+  color: var(--chrome-color);
+}
+.subviewbutton > .toolbarbutton-text {
+  color: -moz-fieldText !important;
+}
+.tab-background-middle[selected] {
+  background-position: 0 0, 0 0px !important;
+  background-image: url(chrome://browser/skin/tabbrowser/tab-active-middle.png),
+            linear-gradient(transparent 0px, transparent 2px, #9FDFFF 2px, rgba(159,223,255,1) 4px, transparent 9px, transparent),
+            none !important;
+}
+
+#nav-bar {
+  background-image: none !important;
+}
+#tab-background-fill {
+  background-position: 0 2px !important;
+  background-image: linear-gradient(#9FDFFF 0px, rgba(159,223,255,1) 2px, transparent 7px, transparent) !important
+}
+/* URL bar and search bar*/
+.searchbar-textbox, #urlbar {
+  background-color: var(--url-and-searchbar-background-color) !important;
+  background-image: none !important;
+  color: inherit;
+  border: none !important;
+  box-shadow: none !important;
+}
+
+/**** End Toolbars and Tabs */
+
+/* Nav bar specific stuff */
+#PanelUI-button {
+  background-image: none !important;
+  border-left: 1px solid #5F6670 !important;
+  /* XXX: use css variables with panelUIOverlay.css to keep other bg props */
+}
+#nav-bar {
+  margin-top:0 !important;
+  border: none !important;
+  border-radius: 0 !important;
+  box-shadow: 0 -1px rgba(0,0,0,0.2) !important;
+}
+
+/* Don't want to use default colors when tabs aren't in titlebar */
+#main-window:not(:-moz-any([customizing],[tabsintitlebar])) #navigator-toolbox > #TabsToolbar {
+  -moz-appearance: none !important;
+}
+
+#TabsToolbar:not(:-moz-lwtheme) {
+  /*color: #F5F7FA;*/
+  text-shadow: none;
+}
+
+#TabsToolbar::after {
+  display: none !important;
+}
+
+#notification-popup-box {
+  background-color: transparent !important;
+}
+#notification-popup-box {
+  border-right-width: 1px;
+  padding-right: 8px;
+  margin-right: 0px;
+  border-image: linear-gradient(transparent 15%, #5a6169 15%, #5a6169 85%, transparent 85%) 1 1 !important;
+}
+#notification-popup-box > image:not([id*="sharing"]):not([id*="translated"]):not(.indexedDB-notification-icon):not(#indexedDB-notification-icon):not(.default-notification-icon):not(#default-notification-icon) {
+  filter: brightness(10) opacity(0.8);
+}
+
+#urlbar[pageproxystate] #identity-icon-labels {
+  filter: brightness(2.8) !important;
+}
+
+/***** End Nav bar specific stuff */
+
+
+/* Window Frame */
+#nav-bar-customization-target {
+  padding-top: 0 !important;
+  padding-bottom: 0 !important;
+}
+
+#urlbar {
+  margin-top: 2px;
+  margin-bottom: 2px;
+  padding-top: 1px;
+  padding-bottom: 1px;
+}
+
+#forward-button[disabled] {
+  visibility: hidden !important;
+}
+
+window:not([chromehidden~="toolbar"]) #urlbar-wrapper {
+  clip-path: none !important;
+  -moz-margin-start: -2px !important;
+}
+
+.search-go-button {
+  /* XXX: move to platform specific files:
+  #search-icon for the normal search icon
+  #search-icon-inverted for the inverted one
+  #search-icon-mac for the mac one
+  #search-icon-mac-inverted for the inverted mac one
+  */
+  list-style-image: url("chrome://browser/skin/devedition/Search.svg#search-icon-mac-inverted");
+}
+
+/***** End Window Frame */
+
+/* Square Tabs - https://userstyles.org/styles/104736/devfox-square-tabs */
+#TabsToolbar {
+  margin-top: 0 !important;
+}
+.tab-background {visibility: hidden !important}
+.tabs-newtab-button {
+  background-image: none !important;
+  margin: 0 !important;
+  width: 35px !important;
+}
+.tabs-newtab-button > .toolbarbutton-icon {
+  padding: 0 !important;
+}
+
+/* XXX: Make this a variable - just here to get inverting to work */
+
+#TabsToolbar:not(:-moz-lwtheme) {
+  color: white;
+}
+
+#tabbrowser-tabs[movingtab] > .tabbrowser-tab[beforeselected]:not([last-visible-tab])::after,
+.tabbrowser-tab:not([selected]):not([afterselected-visible]):not([first-visible-tab])::before,
+#tabbrowser-tabs:not([overflow]) > .tabbrowser-tab[last-visible-tab]:not([selected])::after {
+  content:"";
+  background-image: none !important;
+  background-color: var(--chrome-tab-separator-color) !important;
+  width: 1px !important;
+  -moz-margin-start: 0px !important;
+  -moz-margin-end: 0px !important;
+  display: -moz-box;
+}
+.tabbrowser-tab {
+  pointer-events: auto !important;
+}
+.tabbrowser-tab:hover, .tabs-newtab-button:hover {
+  background-color: var(--chrome-tab-hover-background-color);
+  color: var(--chrome-tab-hover-color);
+}
+.tabbrowser-tab {
+   color: var(--chrome-tab-color);
+   background-color: var(--chrome-tab-background-color);
+}
+.tabbrowser-tab[selected]:not(:-moz-lwtheme) {
+   color: var(--chrome-tab-selection-color);
+   background-color: var(--chrome-tab-selection-background-color);
+   box-shadow: var(--chrome-tab-selection-box-shadow);
+}
+
+/***** End Square Tabs */
+
+/* Panels */
+
+.panel-arrow[side="top"] {
+  list-style-image: url("chrome://browser/skin/devedition/arrow-vertical-devedition-dark.svg");
+  margin-bottom: -4px;
+}
+
+.panel-arrow[side="bottom"] {
+  list-style-image: url("chrome://browser/skin/devedition/arrow-vertical-devedition-dark.svg");
+  margin-top: -4px;
+}
+
+.panel-arrow[side="left"] {
+  list-style-image: url("chrome://browser/skin/devedition/arrow-horizontal-devedition-dark.svg");
+  margin-right: -4px;
+}
+
+.panel-arrow[side="right"] {
+  list-style-image: url("chrome://browser/skin/devedition/arrow-horizontal-devedition-dark.svg");
+  margin-left: -4px;
+}
+
+@media (min-resolution: 2dppx) {
+  .panel-arrow[side="top"],
+  .panel-arrow[side="bottom"] {
+    list-style-image: url("chrome://browser/skin/devedition/arrow-vertical-devedition-dark.svg");
+  }
+
+  .panel-arrow[side="left"],
+  .panel-arrow[side="right"] {
+    list-style-image: url("chrome://browser/skin/devedition/arrow-horizontal-devedition-dark.svg");
+  }
+}
+
+/* Autocomplete.  XXX: switch to CSS vars with browser.css and autocomplete.css if we want to keep this */
+.autocomplete-richlistbox {
+  background: #39424D;
+  color: HighlightText;
+}
+
+.ac-url-text,
+.ac-action-text {
+  color: #46afe3;
+}
+
+.autocomplete-richlistitem[selected="true"]:not([disabled="true"]) {
+  background-color: rgba(29, 79, 115, .8);
+  background-color: #46afe3;
+  background-color: red;
+}
+
+
+/***** End Panels */
diff --git a/browser/themes/shared/devedition/Search.svg b/browser/themes/shared/devedition/Search.svg
new file mode 100644
--- /dev/null
+++ b/browser/themes/shared/devedition/Search.svg
@@ -0,0 +1,41 @@
+<?xml version="1.0"?>
+<!-- This Source Code Form is subject to the terms of the Mozilla Public
+   - License, v. 2.0. If a copy of the MPL was not distributed with this
+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
+<svg xmlns="http://www.w3.org/2000/svg"
+     xmlns:xlink="http://www.w3.org/1999/xlink"
+     x="0px" y="0px"
+     viewBox="0 0 16 16"
+     enable-background="new 0 0 16 16"
+     width="16"
+     height="16"
+     xml:space="preserve">
+<style>
+  use:not(:target) {
+    display: none;
+  }
+
+  use {
+    fill: #797C80;
+  }
+
+  use[id*="-inverted"] {
+    fill: #B6BABF;
+  }
+
+  use[id*="-mac"] {
+    transform: translate(16px) scale(-1,1);
+  }
+</style>
+<defs style="display: none;">
+  <path id="search" fill-rule="evenodd" clip-rule="evenodd" d="M9.356,1.178c-3.014,0-5.458,2.45-5.458,5.472c0,1.086,0.32,2.096,0.864,2.947
+    l-3.279,3.287c-0.396,0.397-0.396,1.041,0,1.438l0.202,0.202c0.396,0.397,1.039,0.397,1.435,0l3.275-3.283
+    c0.854,0.554,1.869,0.88,2.962,0.88c3.014,0,5.458-2.45,5.458-5.471C14.814,3.627,12.371,1.178,9.356,1.178z M9.356,10.001
+    c-1.847,0-3.344-1.501-3.344-3.352c0-1.851,1.497-3.352,3.344-3.352c1.846,0,3.344,1.501,3.344,3.352
+    C12.7,8.501,11.203,10.001,9.356,10.001z"/>
+</defs>
+<use id="search-icon"               xlink:href="#search"/>
+<use id="search-icon-inverted"      xlink:href="#search"/>
+<use id="search-icon-mac"           xlink:href="#search"/>
+<use id="search-icon-mac-inverted"  xlink:href="#search"/>
+</svg>
diff --git a/browser/themes/shared/devedition/arrow-horizontal-dark-devedition.svg b/browser/themes/shared/devedition/arrow-horizontal-dark-devedition.svg
new file mode 100644
--- /dev/null
+++ b/browser/themes/shared/devedition/arrow-horizontal-dark-devedition.svg
@@ -0,0 +1,13 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!-- This Source Code Form is subject to the terms of the Mozilla Public
+   - License, v. 2.0. If a copy of the MPL was not distributed with this
+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
+
+<svg xmlns="http://www.w3.org/2000/svg"
+     width="10"
+     height="20">
+  <path d="M 10,0 L 0,10 10,20 z"
+        fill="#434850"/>
+  <path d="M 10,4 L 4,10 10,16 z"
+        fill="#0F1114"/>
+</svg>
diff --git a/browser/themes/shared/devedition/arrow-vertical-dark-devedition.svg b/browser/themes/shared/devedition/arrow-vertical-dark-devedition.svg
new file mode 100644
--- /dev/null
+++ b/browser/themes/shared/devedition/arrow-vertical-dark-devedition.svg
@@ -0,0 +1,13 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!-- This Source Code Form is subject to the terms of the Mozilla Public
+   - License, v. 2.0. If a copy of the MPL was not distributed with this
+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
+
+<svg xmlns="http://www.w3.org/2000/svg"
+     width="20"
+     height="10">
+  <path d="M 0,10 L 10,0 20,10 z"
+        fill="#434850"/>
+  <path d="M 4,10 L 10,4 16,10 z"
+        fill="#0F1114"/>
+</svg>
diff --git a/browser/themes/shared/devedition/url-history-dropmarker.svg b/browser/themes/shared/devedition/url-history-dropmarker.svg
new file mode 100644
--- /dev/null
+++ b/browser/themes/shared/devedition/url-history-dropmarker.svg
@@ -0,0 +1,19 @@
+<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="33" height="14" viewBox="0 0 33 14" enable-background="new 0 0 33 14">
+  <defs style="display: none;">
+    <polygon points="0,0 5.5,7 11,0" id="dropmarker-shape"/>
+  </defs>
+  <style>
+    use {
+      fill: #B6BABF;
+    }
+    .hover {
+      fill: #61BDEB;
+    }
+    .active {
+      fill: #39ACE6;
+    }
+  </style>
+  <use xlink:href="#dropmarker-shape" style="transform: translate(0, 4px)"></use>
+  <use xlink:href="#dropmarker-shape" style="transform: translate(11px, 4px)" class="hover"></use>
+  <use xlink:href="#dropmarker-shape" style="transform: translate(22px, 4px)" class="active"></use>
+</svg>
diff --git a/browser/themes/windows/jar.mn b/browser/themes/windows/jar.mn
--- a/browser/themes/windows/jar.mn
+++ b/browser/themes/windows/jar.mn
@@ -227,16 +227,20 @@ browser.jar:
         skin/classic/browser/tabview/stack-expander.png             (tabview/stack-expander.png)
         skin/classic/browser/tabview/tabview.png                    (tabview/tabview.png)
         skin/classic/browser/tabview/tabview-inverted.png           (tabview/tabview-inverted.png)
         skin/classic/browser/tabview/tabview.css                    (tabview/tabview.css)
         skin/classic/browser/translating-16.png                     (../shared/translation/translating-16.png)
         skin/classic/browser/translating-16@2x.png                  (../shared/translation/translating-16@2x.png)
         skin/classic/browser/translation-16.png                     (../shared/translation/translation-16.png)
         skin/classic/browser/translation-16@2x.png                  (../shared/translation/translation-16@2x.png)
+        skin/classic/browser/devedition/Search.svg                  (../shared/devedition/Search.svg)
+        skin/classic/browser/devedition/arrow-horizontal-devedition-dark.svg  (../shared/devedition/arrow-horizontal-dark-devedition.svg)
+        skin/classic/browser/devedition/arrow-vertical-devedition-dark.svg    (../shared/devedition/arrow-vertical-dark-devedition.svg)
+        skin/classic/browser/devedition/url-history-dropmarker.svg            (../shared/devedition/url-history-dropmarker.svg)
 *       skin/classic/browser/devtools/common.css                    (../shared/devtools/common.css)
 *       skin/classic/browser/devtools/dark-theme.css                (../shared/devtools/dark-theme.css)
 *       skin/classic/browser/devtools/light-theme.css               (../shared/devtools/light-theme.css)
         skin/classic/browser/devtools/filters.svg                   (../shared/devtools/filters.svg)
         skin/classic/browser/devtools/controls.png                  (../shared/devtools/images/controls.png)
         skin/classic/browser/devtools/controls@2x.png               (../shared/devtools/images/controls@2x.png)
         skin/classic/browser/devtools/newtab.png                    (../shared/devtools/images/newtab.png)
         skin/classic/browser/devtools/newtab@2x.png                 (../shared/devtools/images/newtab@2x.png)
@@ -656,16 +660,20 @@ browser.jar:
         skin/classic/aero/browser/tabview/stack-expander.png         (tabview/stack-expander.png)
         skin/classic/aero/browser/tabview/tabview.png                (tabview/tabview.png)
         skin/classic/aero/browser/tabview/tabview-inverted.png       (tabview/tabview-inverted.png)
         skin/classic/aero/browser/tabview/tabview.css                (tabview/tabview.css)
         skin/classic/aero/browser/translating-16.png                 (../shared/translation/translating-16.png)
         skin/classic/aero/browser/translating-16@2x.png              (../shared/translation/translating-16@2x.png)
         skin/classic/aero/browser/translation-16.png                 (../shared/translation/translation-16.png)
         skin/classic/aero/browser/translation-16@2x.png              (../shared/translation/translation-16@2x.png)
+        skin/classic/aero/devedition/Search.svg                      (../shared/devedition/Search.svg)
+        skin/classic/aero/devedition/arrow-horizontal-devedition-dark.svg  (../shared/devedition/arrow-horizontal-dark-devedition.svg)
+        skin/classic/aero/devedition/arrow-vertical-devedition-dark.svg    (../shared/devedition/arrow-vertical-dark-devedition.svg)
+        skin/classic/aero/devedition/url-history-dropmarker.svg            (../shared/devedition/url-history-dropmarker.svg)
 *       skin/classic/aero/browser/devtools/common.css                (../shared/devtools/common.css)
 *       skin/classic/aero/browser/devtools/dark-theme.css            (../shared/devtools/dark-theme.css)
 *       skin/classic/aero/browser/devtools/light-theme.css           (../shared/devtools/light-theme.css)
         skin/classic/aero/browser/devtools/filters.svg               (../shared/devtools/filters.svg)
         skin/classic/aero/browser/devtools/controls.png              (../shared/devtools/images/controls.png)
         skin/classic/aero/browser/devtools/controls@2x.png           (../shared/devtools/images/controls@2x.png)
         skin/classic/aero/browser/devtools/newtab.png                (../shared/devtools/images/newtab.png)
         skin/classic/aero/browser/devtools/newtab@2x.png             (../shared/devtools/images/newtab@2x.png)
