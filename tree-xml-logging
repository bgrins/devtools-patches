# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  00432a450b3af67c4d5711810691b27093880c62

diff --git a/toolkit/content/widgets/tree.xml b/toolkit/content/widgets/tree.xml
--- a/toolkit/content/widgets/tree.xml
+++ b/toolkit/content/widgets/tree.xml
@@ -366,38 +366,47 @@
       </method>
 
       <method name="_moveByOffset">
         <parameter name="offset"/>
         <parameter name="edge"/>
         <parameter name="event"/>
         <body>
           <![CDATA[
-            event.preventDefault();
+      event.preventDefault();
 
-            if (this.view.rowCount == 0)
-              return;
+      console.log(offset, edge, this.currentIndex, this.view.selection.single);
+
+      if (this.view.rowCount == 0)
+        return;
 
-            if (event.getModifierState("Accel") && this.view.selection.single) {
-              this.scrollByLines(offset);
-              return;
-            }
+      console.log("1");
+      if (event.getModifierState("Accel") && this.view.selection.single) {
+        this.scrollByLines(offset);
+      console.log("2");
+        return;
+      }
 
-            var c = this.currentIndex + offset;
-            if (offset > 0 ? c > edge : c < edge) {
-              if (this.view.selection.isSelected(edge) && this.view.selection.count <= 1)
-                return;
-              c = edge;
-            }
+      console.log("3");
+      var c = this.currentIndex + offset;
+      if (offset > 0 ? c > edge : c < edge) {
+        if (this.view.selection.isSelected(edge) && this.view.selection.count <= 1)
+          return;
+      console.log("4", c);
+        c = edge;
+      }
 
-            if (!event.getModifierState("Accel"))
-              this.view.selection.timedSelect(c, this._selectDelay);
-            else // Ctrl+Up/Down moves the anchor without selecting
-              this.currentIndex = c;
-            this.ensureRowIsVisible(c);
+      console.log("5", c);
+      if (!event.getModifierState("Accel"))
+        this.view.selection.timedSelect(c, this._selectDelay);
+      else // Ctrl+Up/Down moves the anchor without selecting
+        this.currentIndex = c;
+
+      console.log("6", this.currentIndex);
+      this.ensureRowIsVisible(c);
           ]]>
         </body>
       </method>
 
       <method name="_moveByOffsetShift">
         <parameter name="offset"/>
         <parameter name="edge"/>
         <parameter name="event"/>
@@ -711,17 +720,17 @@
               // Fall through for actual action
             case event.DIRECTION_UP:
               this.ensureRowIsVisible(targetRow);
               break;
           }
         ]]>
       </handler>
       <handler event="select" phase="target"
-               action="if (event.originalTarget == this) this.stopEditing(true);"/>
+               action="console.log(event.originalTarget, this, event.originalTarget == this); if (event.originalTarget == this) this.stopEditing(true);"/>
       <handler event="focus">
         <![CDATA[
           this.focused = true;
           if (this.currentIndex == -1 && this.view.rowCount > 0) {
             this.currentIndex = this.getFirstVisibleRow();
           }
         ]]>
       </handler>
