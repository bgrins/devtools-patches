# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  5412e38f03c1b00d5287a7e0d113a91bf9420ef5
Temporary workaround for focus in browser.xhtml

diff --git a/dom/base/Document.cpp b/dom/base/Document.cpp
--- a/dom/base/Document.cpp
+++ b/dom/base/Document.cpp
@@ -4987,16 +4987,26 @@ Element* Document::GetActiveElement() {
   // Get the focused element.
   Element* focusedElement = GetRetargetedFocusedElement();
   if (focusedElement) {
     return focusedElement;
   }
 
   // No focused element anywhere in this document.  Try to get the BODY.
   if (IsHTMLOrXHTML()) {
+
+    // XXX: How do we actually want to handle this?
+    if (GetDocumentURI()->GetSpecOrDefault().EqualsLiteral("chrome://browser/content/browser.xhtml")) {
+      Element* docElement = GetDocumentElement();
+      if (docElement) {
+        printf("Early return!\n");
+        return docElement;
+      }
+    }
+
     Element* bodyElement = AsHTMLDocument()->GetBody();
     if (bodyElement) {
       return bodyElement;
     }
     // Special case to handle the transition to browser.xhtml where there is
     // currently not a body element, but we need to match the XUL behavior.
     // This should be removed when bug 1492582 is resolved.
     if (nsContentUtils::IsChromeDoc(this)) {
