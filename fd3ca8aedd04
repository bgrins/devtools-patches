
# HG changeset patch
# User nchevobbe <nchevobbe@mozilla.com>
# Date 1491903696 -7200
# Node ID fd3ca8aedd0437739a40c672061c83c4b402253e
# Parent  c12c64479a3ebdc2f047ad50ef770ce3ddbade34
Bug 1088900 - Use ConsoleMessage's "parameters" property for console.group. r=

Because we now enable custom styling on console.group, we can't rely solely on groupName
to output the group. We can have multiple pieces on which to apply different styles, like
for console.log, so we use the same properties to have the same behavior for custom styles.

MozReview-Commit-ID: 7IKl919Dg7a

diff --git a/devtools/client/webconsole/new-console-output/utils/messages.js b/devtools/client/webconsole/new-console-output/utils/messages.js
--- a/devtools/client/webconsole/new-console-output/utils/messages.js
+++ b/devtools/client/webconsole/new-console-output/utils/messages.js
@@ -91,23 +91,25 @@
           ) {
             // If the class of the first parameter is not supported,
             // we handle the call as a simple console.log
             type = "log";
           }
           break;
         case "group":
           type = MESSAGE_TYPE.START_GROUP;
-          parameters = null;
-          messageText = message.groupName || l10n.getStr("noGroupLabel");
+          if (parameters.length === 0) {
+            parameters = [l10n.getStr("noGroupLabel")];
+          }
           break;
         case "groupCollapsed":
           type = MESSAGE_TYPE.START_GROUP_COLLAPSED;
-          parameters = null;
-          messageText = message.groupName || l10n.getStr("noGroupLabel");
+          if (parameters.length === 0) {
+            parameters = [l10n.getStr("noGroupLabel")];
+          }
           break;
         case "groupEnd":
           type = MESSAGE_TYPE.END_GROUP;
           parameters = null;
           break;
         case "dirxml":
           // Handle console.dirxml calls as simple console.log
           type = "log";

