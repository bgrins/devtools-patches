# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Date 1546560540 28800
#      Thu Jan 03 16:09:00 2019 -0800
# Node ID 2ccf1e733b990885e3de75964f80f8cdb0e71bc6
# Parent  6743745f3d880a53163b8cd0f0577a859c47abab
Bug 1517040 - Allow Thunderbird to continue using richlistbox as XBL, and to extend the Custom Element class;r=paolo

Differential Revision: https://phabricator.services.mozilla.com/D15698

diff --git a/toolkit/content/widgets/richlistbox.js b/toolkit/content/widgets/richlistbox.js
--- a/toolkit/content/widgets/richlistbox.js
+++ b/toolkit/content/widgets/richlistbox.js
@@ -1,19 +1,19 @@
 /* This Source Code Form is subject to the terms of the Mozilla Public
  * License, v. 2.0. If a copy of the MPL was not distributed with this
  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
-
 "use strict";
 
 // This is loaded into all XUL windows. Wrap in a block to prevent
 // leaking to window scope.
+// eslint-disable-next-line no-lone-blocks
 {
 
-class MozRichListBox extends MozElements.BaseControl {
+MozElements.RichListBox = class RichListBox extends MozXULElement {
   constructor() {
     super();
 
     this.addEventListener("keypress", event => {
       if (event.altKey || event.metaKey) {
         return;
       }
 
@@ -813,18 +813,21 @@ class MozRichListBox extends MozElements
 
   /**
    * For backwards-compatibility and for convenience.
    * Use ensureElementIsVisible instead
    */
   ensureSelectedElementIsVisible() {
     return this.ensureElementIsVisible(this.selectedItem);
   }
-}
+};
 
-MozXULElement.implementCustomInterface(MozRichListBox, [
+MozXULElement.implementCustomInterface(MozElements.RichListBox, [
   Ci.nsIDOMXULSelectControlElement,
   Ci.nsIDOMXULMultiSelectControlElement,
 ]);
 
-customElements.define("richlistbox", MozRichListBox);
+// Bug 1517040 - allow TB to continue to use XBL for richlistbox.
+if (AppConstants.MOZ_APP_NAME != "thunderbird") {
+  customElements.define("richlistbox", MozElements.RichListBox);
+}
 
 }
