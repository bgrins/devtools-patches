# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  f02a1818d98cd177c3ad18df8de05ca7a8fbaf3f
Bug 1374837 - Pipe stderr to stdout to fix the Browser Toolbox in certain Windows builds;r=kmag

This is working around an issue with Subprocess that affects some developers
using a 32 bit build on a 64 bit Windows

MozReview-Commit-ID: COsKOkBVjSZ

diff --git a/devtools/client/framework/ToolboxProcess.jsm b/devtools/client/framework/ToolboxProcess.jsm
--- a/devtools/client/framework/ToolboxProcess.jsm
+++ b/devtools/client/framework/ToolboxProcess.jsm
@@ -272,16 +272,18 @@ BrowserToolboxProcess.prototype = {
     if (!system.constants.MOZILLA_OFFICIAL) {
       args.push("-purgecaches");
     }
 
     this._dbgProcessPromise = Subprocess.call({
       command,
       arguments: args,
       environmentAppend: true,
+      // Workaround for the process not opening in local Windows build - see Bug 1398901
+      stderr: "stdout",
       environment: {
         // Disable safe mode for the new process in case this was opened via the
         // keyboard shortcut.
         MOZ_DISABLE_SAFE_MODE_KEY: "1",
       },
     }).then(proc => {
       this._dbgProcess = proc;
 
