# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  def0fd8429f955dcd8f29ae54cd2e2e5cd28032d

diff --git a/browser/base/content/tabbrowser.js b/browser/base/content/tabbrowser.js
--- a/browser/base/content/tabbrowser.js
+++ b/browser/base/content/tabbrowser.js
@@ -5364,33 +5364,36 @@ var StatusPanel = {
 var TabBarVisibility = {
   _initialUpdateDone: false,
 
   update() {
     let toolbar = document.getElementById("TabsToolbar");
     let collapse = false;
     if (!gBrowser /* gBrowser isn't initialized yet */ ||
         gBrowser.tabs.length - gBrowser._removingTabs.length == 1) {
+      console.log("Early return 1", gBrowser);
       collapse = !window.toolbar.visible;
     }
 
     if (collapse == toolbar.collapsed && this._initialUpdateDone) {
+      console.log("Early return 2");
       return;
     }
     this._initialUpdateDone = true;
 
     toolbar.collapsed = collapse;
     let navbar = document.getElementById("nav-bar");
     navbar.setAttribute("tabs-hidden", collapse);
 
     document.getElementById("menu_closeWindow").hidden = collapse;
     document.getElementById("menu_close").setAttribute("label",
       gTabBrowserBundle.GetStringFromName(collapse ? "tabs.close" : "tabs.closeTab"));
 
     TabsInTitlebar.allowedBy("tabs-visible", !collapse);
+    console.log("Did full write", collapse);
   },
 };
 
 var TabContextMenu = {
   contextTab: null,
   _updateToggleMuteMenuItems(aTab, aConditionFn) {
     ["muted", "soundplaying"].forEach(attr => {
       if (!aConditionFn || aConditionFn(attr)) {
