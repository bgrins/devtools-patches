# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  d6b0a6f96890888c33b3535aac925c596c62f71a
Bug 1408949 - Remove unnecessary clearing of devtools.toolbox.splitconsoleEnabled;r=Honza

This is cleared in shared-head.js

MozReview-Commit-ID: 7svp6ZiUqnE

diff --git a/devtools/client/debugger/new/test/mochitest/browser_dbg-console.js b/devtools/client/debugger/new/test/mochitest/browser_dbg-console.js
--- a/devtools/client/debugger/new/test/mochitest/browser_dbg-console.js
+++ b/devtools/client/debugger/new/test/mochitest/browser_dbg-console.js
@@ -1,18 +1,14 @@
 // Return a promise with a reference to jsterm, opening the split
 // console if necessary.  This cleans up the split console pref so
 // it won't pollute other tests.
 function getSplitConsole(dbg) {
   const { toolbox, win } = dbg;
 
-  registerCleanupFunction(() => {
-    Services.prefs.clearUserPref("devtools.toolbox.splitconsoleEnabled");
-  });
-
   if (!win) {
     win = toolbox.win;
   }
 
   if (!toolbox.splitConsole) {
     pressKey(dbg, "Escape");
   }
 
diff --git a/devtools/client/debugger/new/test/mochitest/browser_dbg-toggling-tools.js b/devtools/client/debugger/new/test/mochitest/browser_dbg-toggling-tools.js
--- a/devtools/client/debugger/new/test/mochitest/browser_dbg-toggling-tools.js
+++ b/devtools/client/debugger/new/test/mochitest/browser_dbg-toggling-tools.js
@@ -1,18 +1,14 @@
 // Return a promise with a reference to jsterm, opening the split
 // console if necessary.  This cleans up the split console pref so
 // it won't pollute other tests.
 function getSplitConsole(dbg) {
   const { toolbox, win } = dbg;
 
-  registerCleanupFunction(() => {
-    Services.prefs.clearUserPref("devtools.toolbox.splitconsoleEnabled");
-  });
-
   if (!win) {
     win = toolbox.win;
   }
 
   if (!toolbox.splitConsole) {
     pressKey(dbg, "Escape");
   }
 
diff --git a/devtools/client/debugger/test/mochitest/browser_dbg_split-console-paused-reload.js b/devtools/client/debugger/test/mochitest/browser_dbg_split-console-paused-reload.js
--- a/devtools/client/debugger/test/mochitest/browser_dbg_split-console-paused-reload.js
+++ b/devtools/client/debugger/test/mochitest/browser_dbg_split-console-paused-reload.js
@@ -57,11 +57,10 @@ function* runTests() {
   let mainTargetConsoleEvalResult = yield jsterm.execute("$_");
 
   is(
     mainTargetConsoleEvalResult.querySelector(".console-string").textContent,
     '"privateVarValue"',
     "Got the expected split console log on $_ executed on resumed debugger"
   );
 
-  Services.prefs.clearUserPref("devtools.toolbox.splitconsoleEnabled");
   yield closeDebuggerAndFinish(panel);
 }
diff --git a/devtools/client/framework/test/browser_toolbox_split_console.js b/devtools/client/framework/test/browser_toolbox_split_console.js
--- a/devtools/client/framework/test/browser_toolbox_split_console.js
+++ b/devtools/client/framework/test/browser_toolbox_split_console.js
@@ -72,14 +72,12 @@ function* testUseKeyWithSplitConsoleWron
   let consoleInput = gToolbox.getPanel("webconsole").hud.jsterm.inputNode;
   consoleInput.focus();
   synthesizeKeyShortcut("F4", panelWin);
 
   ok(!commandCalled, "Shortcut key shouldn't trigger the command");
 }
 
 function* cleanup() {
-  // We don't want the open split console to confuse other tests..
-  Services.prefs.clearUserPref("devtools.toolbox.splitconsoleEnabled");
   yield gToolbox.destroy();
   gBrowser.removeCurrentTab();
   gToolbox = panelWin = null;
 }
diff --git a/devtools/client/inspector/test/browser_inspector_menu-04-use-in-console.js b/devtools/client/inspector/test/browser_inspector_menu-04-use-in-console.js
--- a/devtools/client/inspector/test/browser_inspector_menu-04-use-in-console.js
+++ b/devtools/client/inspector/test/browser_inspector_menu-04-use-in-console.js
@@ -2,20 +2,16 @@
 /* Any copyright is dedicated to the Public Domain.
 http://creativecommons.org/publicdomain/zero/1.0/ */
 "use strict";
 
 // Tests "Use in Console" menu item
 
 const TEST_URL = URL_ROOT + "doc_inspector_menu.html";
 
-registerCleanupFunction(() => {
-  Services.prefs.clearUserPref("devtools.toolbox.splitconsoleEnabled");
-});
-
 // Use the old webconsole since the node isn't being rendered as an HTML tag
 // in the new one (Bug 1304794)
 Services.prefs.setBoolPref("devtools.webconsole.new-frontend-enabled", false);
 registerCleanupFunction(function* () {
   Services.prefs.clearUserPref("devtools.webconsole.new-frontend-enabled");
 });
 
 add_task(function* () {
diff --git a/devtools/client/storage/test/head.js b/devtools/client/storage/test/head.js
--- a/devtools/client/storage/test/head.js
+++ b/devtools/client/storage/test/head.js
@@ -8,17 +8,16 @@
 /* import-globals-from ../../framework/test/shared-head.js */
 
 // shared-head.js handles imports, constants, and utility functions
 Services.scriptloader.loadSubScript(
   "chrome://mochitests/content/browser/devtools/client/framework/test/shared-head.js",
   this);
 
 const {TableWidget} = require("devtools/client/shared/widgets/TableWidget");
-const SPLIT_CONSOLE_PREF = "devtools.toolbox.splitconsoleEnabled";
 const STORAGE_PREF = "devtools.storage.enabled";
 const DOM_CACHE = "dom.caches.enabled";
 const DUMPEMIT_PREF = "devtools.dump.emit";
 const DEBUGGERLOG_PREF = "devtools.debugger.log";
 // Allows Cache API to be working on usage `http` test page
 const CACHES_ON_HTTP_PREF = "dom.caches.testing.enabled";
 const PATH = "browser/devtools/client/storage/test/";
 const MAIN_DOMAIN = "http://test1.example.org/" + PATH;
@@ -39,17 +38,16 @@ var gToolbox, gPanelWindow, gWindow, gUI
 Services.prefs.setBoolPref(STORAGE_PREF, true);
 Services.prefs.setBoolPref(CACHES_ON_HTTP_PREF, true);
 registerCleanupFunction(() => {
   gToolbox = gPanelWindow = gWindow = gUI = null;
   Services.prefs.clearUserPref(CACHES_ON_HTTP_PREF);
   Services.prefs.clearUserPref(DEBUGGERLOG_PREF);
   Services.prefs.clearUserPref(DOM_CACHE);
   Services.prefs.clearUserPref(DUMPEMIT_PREF);
-  Services.prefs.clearUserPref(SPLIT_CONSOLE_PREF);
   Services.prefs.clearUserPref(STORAGE_PREF);
 });
 
 /**
  * This generator function opens the given url in a new tab, then sets up the
  * page by waiting for all cookies, indexedDB items etc.
  *
  * @param url {String} The url to be opened in the new tab
diff --git a/devtools/client/webconsole/new-console-output/test/mochitest/browser_webconsole_split_focus.js b/devtools/client/webconsole/new-console-output/test/mochitest/browser_webconsole_split_focus.js
--- a/devtools/client/webconsole/new-console-output/test/mochitest/browser_webconsole_split_focus.js
+++ b/devtools/client/webconsole/new-console-output/test/mochitest/browser_webconsole_split_focus.js
@@ -54,13 +54,12 @@
     while (activeElement && activeElement.contentDocument) {
       activeElement = activeElement.contentDocument.activeElement;
     }
     return activeElement;
   }
 
   function finish() {
     toolbox = TEST_URI = null;
-    Services.prefs.clearUserPref("devtools.toolbox.splitconsoleEnabled");
     Services.prefs.clearUserPref("devtools.toolbox.splitconsoleHeight");
     finishTest();
   }
 }
diff --git a/devtools/client/webconsole/new-console-output/test/mochitest/browser_webconsole_split_persist.js b/devtools/client/webconsole/new-console-output/test/mochitest/browser_webconsole_split_persist.js
--- a/devtools/client/webconsole/new-console-output/test/mochitest/browser_webconsole_split_persist.js
+++ b/devtools/client/webconsole/new-console-output/test/mochitest/browser_webconsole_split_persist.js
@@ -107,13 +107,12 @@
     let contentWindow = toolbox.win;
     contentWindow.focus();
     EventUtils.sendKey("ESCAPE", contentWindow);
     return onceSplitConsole;
   }
 
   function finish() {
     toolbox = TEST_URI = null;
-    Services.prefs.clearUserPref("devtools.toolbox.splitconsoleEnabled");
     Services.prefs.clearUserPref("devtools.toolbox.splitconsoleHeight");
     finishTest();
   }
 }
diff --git a/devtools/client/webconsole/test/browser_webconsole_split_focus.js b/devtools/client/webconsole/test/browser_webconsole_split_focus.js
--- a/devtools/client/webconsole/test/browser_webconsole_split_focus.js
+++ b/devtools/client/webconsole/test/browser_webconsole_split_focus.js
@@ -54,13 +54,12 @@
     while (activeElement && activeElement.contentDocument) {
       activeElement = activeElement.contentDocument.activeElement;
     }
     return activeElement;
   }
 
   function finish() {
     toolbox = TEST_URI = null;
-    Services.prefs.clearUserPref("devtools.toolbox.splitconsoleEnabled");
     Services.prefs.clearUserPref("devtools.toolbox.splitconsoleHeight");
     finishTest();
   }
 }
diff --git a/devtools/client/webconsole/test/browser_webconsole_split_persist.js b/devtools/client/webconsole/test/browser_webconsole_split_persist.js
--- a/devtools/client/webconsole/test/browser_webconsole_split_persist.js
+++ b/devtools/client/webconsole/test/browser_webconsole_split_persist.js
@@ -107,13 +107,12 @@
     let contentWindow = toolbox.win;
     contentWindow.focus();
     EventUtils.sendKey("ESCAPE", contentWindow);
     return onceSplitConsole;
   }
 
   function finish() {
     toolbox = TEST_URI = null;
-    Services.prefs.clearUserPref("devtools.toolbox.splitconsoleEnabled");
     Services.prefs.clearUserPref("devtools.toolbox.splitconsoleHeight");
     finishTest();
   }
 }
