
# HG changeset patch
# User nchevobbe <nchevobbe@mozilla.com>
# Date 1491903257 -7200
# Node ID 2836fa920b954a112888cc58445546b1a1b57b78
# Parent  731639fccc709a4dd95fed7e9dda88efb2227906
Bug 1088900 - Parse console.group/groupCollapse for custom styling. r=baku

Process the arguments of "MethodGroup" and "MethodGroupCollapsed"
Use the result of ProcessArguments to compute the groupName so we can get
rid of the "%c" parts.

MozReview-Commit-ID: 5B2jqG5RoRj

diff --git a/dom/console/Console.cpp b/dom/console/Console.cpp
--- a/dom/console/Console.cpp
+++ b/dom/console/Console.cpp
@@ -1555,16 +1555,18 @@
   switch (aData->mMethodName) {
     case MethodLog:
     case MethodInfo:
     case MethodWarn:
     case MethodError:
     case MethodException:
     case MethodDebug:
     case MethodAssert:
+    case MethodGroup:
+    case MethodGroupCollapsed:
       event.mArguments.Construct();
       event.mStyles.Construct();
       if (NS_WARN_IF(!ProcessArguments(aCx, aArguments,
                                        event.mArguments.Value(),
                                        event.mStyles.Value()))) {
         return false;
       }
 
@@ -1576,17 +1578,17 @@
                                            event.mArguments.Value()))) {
         return false;
       }
   }
 
   if (aData->mMethodName == MethodGroup ||
       aData->mMethodName == MethodGroupCollapsed ||
       aData->mMethodName == MethodGroupEnd) {
-    ComposeGroupName(aCx, aArguments, event.mGroupName);
+    ComposeGroupName(aCx, event.mArguments.Value(), event.mGroupName);
   }
 
   else if (aData->mMethodName == MethodTime && !aArguments.IsEmpty()) {
     event.mTimer = CreateStartTimerValue(aCx, aData->mStartTimerLabel,
                                          aData->mStartTimerStatus);
   }
 
   else if (aData->mMethodName == MethodTimeEnd && !aArguments.IsEmpty()) {

