# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  8fd82fc12d2553aa4389210f17785785b89dfa19
Test lw theme failures without any preprocessor conditions

try: -b do -p linux,linux64,linux64-asan,linux64-st-an,linux64-valgrind,linux64-br-haz,macosx64,win32,win64,android-api-9,android-api-11,android-x86 -u all[Ubuntu,10.6,10.10,Windows XP,Windows 7,Windows 8,Android] -t all[Ubuntu,10.6,10.10,Windows XP,Windows 7,Windows 8,Android]

diff --git a/browser/app/profile/firefox.js b/browser/app/profile/firefox.js
--- a/browser/app/profile/firefox.js
+++ b/browser/app/profile/firefox.js
@@ -1322,20 +1322,18 @@ pref("services.sync.prefs.sync.security.
 pref("services.sync.prefs.sync.security.tls.version.min", true);
 pref("services.sync.prefs.sync.security.tls.version.max", true);
 pref("services.sync.prefs.sync.signon.rememberSignons", true);
 pref("services.sync.prefs.sync.spellchecker.dictionary", true);
 pref("services.sync.prefs.sync.xpinstall.whitelist.required", true);
 #endif
 
 // Developer edition preferences
-#ifdef MOZ_DEV_EDITION
 pref("lightweightThemes.selectedThemeID", "firefox-devedition@mozilla.org");
 pref("browser.devedition.theme.enabled", true);
-#endif
 
 // Developer edition promo preferences
 pref("devtools.devedition.promo.shown", false);
 pref("devtools.devedition.promo.url", "https://www.mozilla.org/firefox/developer/?utm_source=firefox-dev-tools&utm_medium=firefox-browser&utm_content=betadoorhanger");
 
 // Only potentially show in beta release
 #if MOZ_UPDATE_CHANNEL == beta
   pref("devtools.devedition.promo.enabled", true);
diff --git a/browser/components/nsBrowserGlue.js b/browser/components/nsBrowserGlue.js
--- a/browser/components/nsBrowserGlue.js
+++ b/browser/components/nsBrowserGlue.js
@@ -713,30 +713,28 @@ BrowserGlue.prototype = {
     Services.prefs.addObserver(POLARIS_ENABLED, this, false);
 #endif
 
 #ifdef MOZ_DEBUG_UA
     UserAgentOverrides.init();
     DebugUserAgent.init();
 #endif
 
-#ifndef RELEASE_BUILD
     let browserBundle = Services.strings.createBundle("chrome://browser/locale/browser.properties");
     let brandBundle = Services.strings.createBundle("chrome://branding/locale/brand.properties");
     let themeName = browserBundle.GetStringFromName("deveditionTheme.name");
     let vendorShortName = brandBundle.GetStringFromName("vendorShortName");
 
     LightweightThemeManager.addBuiltInTheme({
       id: "firefox-devedition@mozilla.org",
       name: themeName,
       headerURL: "resource:///chrome/browser/content/browser/defaultthemes/devedition.header.png",
       iconURL: "resource:///chrome/browser/content/browser/defaultthemes/devedition.icon.png",
       author: vendorShortName,
     });
-#endif
 
     Services.obs.notifyObservers(null, "browser-ui-startup-complete", "");
 
     AddonWatcher.init(this._notifySlowAddon);
   },
 
   _checkForOldBuildUpdates: function () {
     // check for update if our build is old
