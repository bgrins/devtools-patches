# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  200691b3395383bf4d9b490ad6a3508bb89885c1
Bug 1122662 - Resize graphs when window resizes;r=vporof

diff --git a/browser/devtools/performance/performance.xul b/browser/devtools/performance/performance.xul
--- a/browser/devtools/performance/performance.xul
+++ b/browser/devtools/performance/performance.xul
@@ -169,20 +169,22 @@
                   pack="center"
                   flex="1">
               <vbox>
                 <hbox class="devtools-toolbarbutton-group"
                       pack="center">
                   <toolbarbutton class="devtools-toolbarbutton record-button"
                                  label="&profilerUI.stopRecording;" />
                 </hbox>
-                <label class="realtime-disabled-message"
-                       value="Realtime recording data disabled on non-multiprocess Firefox."/>
-                <label class="realtime-disabled-on-e10s-message"
-                       value="Enable multiprocess Firefox in preferences for rendering recording data in realtime."/>
+                <label class="realtime-disabled-message">
+                  Realtime recording data disabled on non-multiprocess Firefox.
+                </label>
+                <label class="realtime-disabled-on-e10s-message">
+                  Enable multiprocess Firefox in preferences for rendering recording data in realtime.
+                </label>
                 <label class="buffer-status-message"
                        tooltiptext="&profilerUI.bufferStatusTooltip;"/>
                 <label class="buffer-status-message-full"
                        value="&profilerUI.bufferStatusFull;"/>
               </vbox>
             </hbox>
             <hbox id="console-recording-notice"
                   class="notice-container"
@@ -195,20 +197,22 @@
                       <label class="console-profile-command" />
                       <label value="&profilerUI.console.recordingNoticeEnd;" />
                     </hbox>
                     <hbox class="console-profile-stop-notice">
                       <label value="&profilerUI.console.stopCommandStart;" />
                       <label class="console-profile-command" />
                       <label value="&profilerUI.console.stopCommandEnd;" />
                     </hbox>
-                    <label class="realtime-disabled-message"
-                           value="Realtime recording data disabled on non-multiprocess Firefox."/>
-                    <label class="realtime-disabled-on-e10s-message"
-                           value="Enable multiprocess Firefox in preferences for rendering recording data in realtime."/>
+                    <label class="realtime-disabled-message">
+                      Realtime recording data disabled on non-multiprocess Firefox.
+                    </label>
+                    <label class="realtime-disabled-on-e10s-message">
+                      Enable multiprocess Firefox in preferences for rendering recording data in realtime.
+                    </label>
                     <label class="buffer-status-message"
                            tooltiptext="&profilerUI.bufferStatusTooltip;"/>
                     <label class="buffer-status-message-full"
                            value="&profilerUI.bufferStatusFull;"/>
                   </vbox>
             </hbox>
             <deck id="details-pane" flex="1">
               <hbox id="waterfall-view" flex="1">
diff --git a/browser/themes/shared/devtools/performance.inc.css b/browser/themes/shared/devtools/performance.inc.css
--- a/browser/themes/shared/devtools/performance.inc.css
+++ b/browser/themes/shared/devtools/performance.inc.css
@@ -110,16 +110,20 @@
 #performance-view toolbarbutton.record-button[checked] {
   color: var(--theme-selection-color);
   background: var(--theme-selection-background);
 }
 
 #performance-view .realtime-disabled-message,
 #performance-view .realtime-disabled-on-e10s-message {
   display: none;
+  /* This label does not want to wrap naturally (based on some combination of
+     it's parents and flex).  Quick and dirty way to force it to wrap -> don't
+     let it get bigger than half the screen size */
+  max-width: 60vw;
 }
 
 #performance-view[e10s="disabled"] .realtime-disabled-on-e10s-message {
   display: block;
   opacity: 0.5;
 
 }
 #performance-view[e10s="unsupported"] .realtime-disabled-message {
@@ -143,16 +147,32 @@
   font-weight: bold;
   opacity: 1;
 }
 
 #details-pane-container[buffer-status="full"] .buffer-status-message-full {
   display: block;
 }
 
+/* Graphs */
+
+/* These rules prevent graph frames from not being able to shrink once expanded
+   by not letting a width attribute set on them expand the boundingClientRect
+   of the parent elements.  See Bug 1122662. */
+#overview-pane > hbox,
+#js-flamegraph-view {
+  display: flex;
+}
+
+#overview-pane iframe,
+#js-flamegraph-view iframe {
+  width: 100%;
+  min-width: 50px;
+}
+
 /* Overview Panel */
 
 #main-record-button {
   list-style-image: url(profiler-stopwatch.svg);
 }
 
 #main-record-button[checked] {
   list-style-image: url(profiler-stopwatch-checked.svg);
