# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  1cc6294c9a50e2c79563e8ec22a12f15a78aa886

diff --git a/toolkit/content/customElements.js b/toolkit/content/customElements.js
--- a/toolkit/content/customElements.js
+++ b/toolkit/content/customElements.js
@@ -344,16 +344,19 @@
         }
 
         // Clear out any existing cached elements:
         this._inheritedElements = null;
 
         this.initializedAttributeInheritance = true;
         for (let attr in flippedInheritedAttributes) {
           if (this.hasAttribute(attr)) {
+            if (this.tagName == "panel") {
+              console.log(attr);
+            }
             this.inheritAttribute(flippedInheritedAttributes[attr], attr);
           }
         }
       }
 
       /*
        * Implements attribute value inheritance by child elements.
        *
diff --git a/toolkit/content/widgets/panel.js b/toolkit/content/widgets/panel.js
--- a/toolkit/content/widgets/panel.js
+++ b/toolkit/content/widgets/panel.js
@@ -47,16 +47,25 @@
         this.setAttribute("consumeoutsideclicks", "false");
       }
 
       this.initializeAttributeInheritance();
 
       this._fadeTimer = null;
     }
 
+    getElementForAttrInheritance() {
+      // We only inherit attributes on a single node, so to optimize this
+      // just return an existing reference to it:
+      console.trace();
+      if (this.shadowRoot.lastElementChild) {
+        return this.shadowRoot.lastElementChild.lastElementChild;
+      }
+    }
+
     get fragment() {
       if (!this.constructor.hasOwnProperty("_fragment")) {
         this.constructor._fragment = MozXULElement.parseXULToFragment(`
         <html:link rel="stylesheet" href="chrome://global/skin/global.css"/>
         <vbox class="panel-arrowcontainer" flex="1">
           <box class="panel-arrowbox" part="arrowbox">
             <image class="panel-arrow" part="arrow"/>
           </box>
@@ -64,17 +73,17 @@
         </vbox>
       `);
       }
       return document.importNode(this.constructor._fragment, true);
     }
 
     static get inheritedAttributes() {
       return {
-        ".panel-arrowcontent": "side,align,dir,orient,pack",
+        "panel-arrowcontent": "align,dir,orient,pack",
       };
     }
 
     get isArrowPanel() {
       return this.getAttribute("type") == "arrow";
     }
 
     adjustArrowPosition() {
