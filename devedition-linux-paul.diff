# HG changeset patch
# User Paul Rouget <paul@mozilla.com>
bug 1053434 - linux updates


diff --git a/browser/themes/linux/browser.css b/browser/themes/linux/browser.css
index 2e03e0e..6d16522 100644
--- a/browser/themes/linux/browser.css
+++ b/browser/themes/linux/browser.css
@@ -13,16 +13,27 @@
 %include ../shared/browser.inc
 %include linuxShared.inc
 %filter substitution
 
 %define forwardTransitionLength 150ms
 %define conditionalForwardWithUrlbar window:not([chromehidden~="toolbar"]) #urlbar-wrapper
 %define conditionalForwardWithUrlbarWidth 30
 
+:root {
+  --toolbarbutton-hover-background: hsla(0,0%,100%,.3) linear-gradient(hsla(0,0%,100%,.7), hsla(0,0%,100%,.2));
+  --toolbarbutton-hover-boxshadow: 0 1px 0 hsla(0,0%,100%,.3) inset, 0 0 0 1px hsla(0,0%,100%,.2) inset, 0 1px 0 hsla(0,0%,0%,.03)
+  --toolbarbutton-hover-bordercolor: rgb(154,154,154);
+  --toolbarbutton-active-boxshadow: 0 1px 1px hsla(0,0%,0%,.1) inset, 0 0 1px hsla(0,0%,0%,.3) inset;
+  --toolbarbutton-active-background: rgba(154,154,154,.5) linear-gradient(hsla(0,0%,100%,.7), hsla(0,0%,100%,.4));
+  --toolbarbutton-checkedhover-backgroundcolor: rgba(90%,90%,90%,.4);
+  --identity-box-chrome-color: inherit;
+  --identity-box-verified-background: #fff;
+}
+
 #menubar-items {
   -moz-box-orient: vertical; /* for flex hack */
 }
 
 #main-menubar {
   -moz-box-flex: 1; /* make menu items expand to fill toolbar height */
 }
 
@@ -585,44 +596,38 @@ toolbarbutton[sdk-button="true"][cui-areatype="toolbar"] > .toolbarbutton-icon {
   -moz-padding-end: 5px;
 }
 
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1[open]:not([disabled=true]) > .toolbarbutton-menubutton-button > .toolbarbutton-icon,
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1:not([disabled=true]):not([open]):hover > .toolbarbutton-menubutton-button > .toolbarbutton-icon,
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1:not([disabled=true]):not([open]):hover > .toolbarbutton-menubutton-dropmarker > .dropmarker-icon,
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1:not([disabled=true]):hover > .toolbarbutton-badge-container > .toolbarbutton-icon,
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1:not([disabled=true]):hover > .toolbarbutton-icon {
-  background-color: hsla(0,0%,100%,.3);
-  background-image: linear-gradient(hsla(0,0%,100%,.7), hsla(0,0%,100%,.2));
-  border: 1px solid rgb(154,154,154);
-  box-shadow: 0 1px 0 hsla(0,0%,100%,.3) inset,
-              0 0 0 1px hsla(0,0%,100%,.2) inset,
-              0 1px 0 hsla(0,0%,0%,.03);
+  background: var(--toolbarbutton-hover-background);
+  border: 1px solid var(--toolbarbutton-hover-bordercolor);
+  box-shadow: var(--toolbarbutton-hover-boxshadow);
 }
 
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1:hover > .toolbarbutton-menubutton-dropmarker > .dropmarker-icon,
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1[open] > .toolbarbutton-menubutton-dropmarker > .dropmarker-icon {
   margin-top: 4px;
   margin-bottom: 4px;
 }
 
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1 > .toolbarbutton-menubutton-button:not([disabled=true]):-moz-any(:hover:active, [open="true"]) > .toolbarbutton-icon,
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1[open="true"] > .toolbarbutton-menubutton-dropmarker:not([disabled=true]) > .dropmarker-icon,
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1:not([disabled=true]):-moz-any([open],[checked],:hover:active) > .toolbarbutton-badge-container > .toolbarbutton-icon,
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1:not([disabled=true]):-moz-any([open],[checked],:hover:active) > .toolbarbutton-icon {
-  background-color: rgba(154,154,154,.5);
-  background-image: linear-gradient(hsla(0,0%,100%,.7), hsla(0,0%,100%,.4));
-  border: 1px solid rgb(154,154,154);
-  box-shadow: 0 1px 1px hsla(0,0%,0%,.1) inset,
-              0 0 1px hsla(0,0%,0%,.3) inset;
+  box-shadow: var(--toolbarbutton-active-boxshadow);
+  border: 1px solid var(--toolbarbutton-hover-bordercolor);
   transition-duration: 10ms;
 }
 
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1[checked]:not(:active):hover > .toolbarbutton-icon {
-  background-color: rgba(90%,90%,90%,.4);
+  background-color: var(--toolbarbutton-checkedhover-backgroundcolor);
   transition: background-color 150ms;
 }
 
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1 > .toolbarbutton-menubutton-button[open],
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1 > .toolbarbutton-menubutton-button:hover:active,
 :-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1:hover:active {
   padding: 3px;
 }
@@ -966,17 +971,18 @@ toolbarbutton[sdk-button="true"][cui-areatype="toolbar"] > .toolbarbutton-icon {
 }
 
 #urlbar[pageproxystate="valid"] > #identity-box.chromeUI,
 #urlbar[pageproxystate="valid"] > #identity-box.verifiedIdentity {
   -moz-margin-end: 4px;
 }
 
 #identity-box.verifiedIdentity:not(:-moz-lwtheme) {
-  background-color: #fff;
+  color: var(--identity-box-chrome-color);
+  background: var(--identity-box-verified-background);
 }
 
 #identity-box:-moz-focusring {
   outline: 1px dotted #000;
   outline-offset: -3px;
 }
 
 #identity-icon-labels {
diff --git a/browser/themes/linux/devedition.css b/browser/themes/linux/devedition.css
index 1c93724..dfe8ebb 100644
--- a/browser/themes/linux/devedition.css
+++ b/browser/themes/linux/devedition.css
@@ -4,40 +4,38 @@
 
 %include ../shared/devedition.inc.css
 
 .close-icon,
 .tab-close-button:not([selected]):not(:hover):not([brighttext]) {
   background-image: -moz-image-rect(url("chrome://global/skin/icons/close.svg"), 0, 64, 16, 48);
 }
 
-#bookmarks-menu-button[cui-areatype="toolbar"] > .toolbarbutton-menubutton-dropmarker > .dropmarker-icon {
-  margin-top: 0;
-  margin-bottom: 0;
-}
-:-moz-any(#TabsToolbar, #nav-bar) .toolbarbutton-1 > .toolbarbutton-menubutton-button > .toolbarbutton-icon {
-  padding-top: 0;
-  padding-bottom: 0;
-}
-
 /* Square back and forward buttons */
 #back-button:not(:-moz-lwtheme) > .toolbarbutton-icon,
 #forward-button:not(:-moz-lwtheme) > .toolbarbutton-icon {
   height: 22px;
-  padding: 0;
   margin: 0;
-  border-radius: 0;
-  box-shadow: none;
   border: none;
+  padding: 2px 6px;
+  box-shadow: none !important;
   background: #252C33;
 }
 
+#back-button:hover:not([disabled="true"]):not([open="true"]):not(:active) > .toolbarbutton-icon {
+  background: #252C33;
+}
 
+#back-button:not(:-moz-lwtheme) > .toolbarbutton-icon {
+  border-radius: 2px 0 0 2px;
+}
 
 #PopupAutoCompleteRichResult {
-  background: var(--autocomplete-background-color);
   -moz-appearance: none;
+  background: var(--autocomplete-background-color);
 }
 
-.panel-arrowcontent {
-  background: var(--panel-arrowcontent-background);
-  border: var(--panel-arrowcontent-border);
-}
\ No newline at end of file
+.urlbar-history-dropmarker {
+  -moz-appearance: none;
+  padding: 0 3px;
+  list-style-image: var(--urlbar-dropmarker-url);
+  -moz-image-region: var(--urlbar-dropmarker-region);
+}
diff --git a/browser/themes/shared/devedition.inc.css b/browser/themes/shared/devedition.inc.css
index 72d730b..7c9f62a 100644
--- a/browser/themes/shared/devedition.inc.css
+++ b/browser/themes/shared/devedition.inc.css
@@ -31,18 +31,18 @@
   --toolbarbutton-active-boxshadow: none;
   --toolbarbutton-checkedhover-backgroundcolor: #1D4F73;
   --toolbarbutton-combined-boxshadow: none;
   --toolbarbutton-combined-backgroundimage: linear-gradient(#5F6670 0, #5F6670 18px);
   --toolbarbutton-text-shadow: none;
 
   /* Identity box */
   --identity-box-chrome-color: #46afe3;
-  --identity-box-chrome-background-image: linear-gradient(#5F6670 0, #5F6670 100%);
-  --identity-box-verified-background-image: linear-gradient(#5F6670 0, #5F6670 100%);
+  --identity-box-chrome-background: linear-gradient(#5F6670 0, #5F6670 100%);
+  --identity-box-verified-background: linear-gradient(#5F6670 0, #5F6670 100%);
 
   /* Url and search bars */
   --url-and-searchbar-background-color: #171B1F;
   --url-and-searchbar-color: #fff;
   --urlbar-dropmarker-url: url("chrome://browser/skin/devedition/urlbar-history-dropmarker.svg");
   --urlbar-dropmarker-region: rect(0px, 11px, 14px, 0px);
   --urlbar-dropmarker-active-region: rect(0px, 22px, 14px, 11px);
   --urlbar-dropmarker-2x-url: url("chrome://browser/skin/devedition/urlbar-history-dropmarker.svg");
@@ -319,20 +319,19 @@ menupopup .panel-arrowcontent {
 }
 
 #BMB_bookmarksPopup arrowscrollbox {
   background: var(--panel-arrowcontent-background);
 }
 
 /* End Panels */
 
-/* XXX: do we need this? */
 #notification-popup-box {
-  background-color: rgba(255,255,255,0.5);
+  background-color: transparent;
 }
 
 #notification-popup-box {
   -moz-border-end-width: 1px;
   /* Compensate the replaced 8px border-image */
   -moz-padding-end: 8px;
   border-radius: 0;
   border-image: linear-gradient(transparent 15%, #5a6169 15%, #5a6169 85%, transparent 85%) 1 1 !important;
-}
\ No newline at end of file
+}
diff --git a/browser/themes/shared/devedition/panelarrow-horizontal.svg b/browser/themes/shared/devedition/panelarrow-horizontal.svg
new file mode 100644
index 0000000..dae4639
--- /dev/null
+++ b/browser/themes/shared/devedition/panelarrow-horizontal.svg
@@ -0,0 +1,13 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!-- This Source Code Form is subject to the terms of the Mozilla Public
+   - License, v. 2.0. If a copy of the MPL was not distributed with this
+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
+
+<svg xmlns="http://www.w3.org/2000/svg"
+     width="10"
+     height="20">
+  <path d="M 10,0 L 0,10 10,20 z"
+        fill="hsla(210,4%,10%,.2)"/>
+  <path d="M 10,1 L 1,10 10,19 z"
+        fill="-moz-field"/>
+</svg>
diff --git a/browser/themes/shared/devedition/panelarrow-vertical.svg b/browser/themes/shared/devedition/panelarrow-vertical.svg
new file mode 100644
index 0000000..4e559ed
--- /dev/null
+++ b/browser/themes/shared/devedition/panelarrow-vertical.svg
@@ -0,0 +1,13 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!-- This Source Code Form is subject to the terms of the Mozilla Public
+   - License, v. 2.0. If a copy of the MPL was not distributed with this
+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
+
+<svg xmlns="http://www.w3.org/2000/svg"
+     width="20"
+     height="10">
+  <path d="M 0,10 L 10,0 20,10 z"
+        fill="hsla(210,4%,10%,.2)"/>
+  <path d="M 1,10 L 10,1 19,10 z"
+        fill="-moz-field"/>
+</svg>
