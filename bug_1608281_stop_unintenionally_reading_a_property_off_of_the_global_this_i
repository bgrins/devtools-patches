# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Date 1579199706 28800
#      Thu Jan 16 10:35:06 2020 -0800
# Node ID 4e078e4bb6cac7b4914939a31b35ab77a621f76b
# Parent  46e1717494fbf0f1913e22052c3304fe9f7c19b8
Bug 1608281 - Stop unintenionally reading a property off of the global `this` in FirstStartup

This code currently returns `undefined`:

```
var {FirstStartup} = ChromeUtils.import("resource://gre/modules/FirstStartup.jsm");
FirstStartup.state
```

But it's meant to return 0 (NOT_STARTED), and this patch fixes that.

Differential Revision: https://phabricator.services.mozilla.com/D60172

diff --git a/toolkit/modules/FirstStartup.jsm b/toolkit/modules/FirstStartup.jsm
--- a/toolkit/modules/FirstStartup.jsm
+++ b/toolkit/modules/FirstStartup.jsm
@@ -30,17 +30,17 @@ const PROBE_NAME = "firstStartup";
  */
 var FirstStartup = {
   NOT_STARTED: 0,
   IN_PROGRESS: 1,
   TIMED_OUT: 2,
   SUCCESS: 3,
   UNSUPPORTED: 4,
 
-  _state: this.NOT_STARTED,
+  _state: 0, // NOT_STARTED,
   /**
    * Initialize and run first-startup services. This will always run synchronously
    * and spin the event loop until either all required services have
    * completed, or until a timeout is reached.
    *
    * In the latter case, services are expected to run post-UI instead as usual.
    */
   init() {
