# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  dc2ea9f1bf9d7a6b9ff4c111ce8211f6e7fb4142
Bug 1459985 - Include stringbundle Custom Element registration inside profile manager;r=mossop

Currently stringbundle.js is loaded in response to the document-element-inserted message
in MainProcessSingleton. But since the profile manager loads before that script is run,
we don't register the Custom Element. This fixes that by explicitly including the script.

MozReview-Commit-ID: GqQk1VUv0Df

diff --git a/toolkit/profile/content/createProfileWizard.xul b/toolkit/profile/content/createProfileWizard.xul
--- a/toolkit/profile/content/createProfileWizard.xul
+++ b/toolkit/profile/content/createProfileWizard.xul
@@ -15,17 +15,19 @@
 <wizard id="createProfileWizard"
         title="&newprofile.title;"
         xmlns:html="http://www.w3.org/1999/xhtml"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
         onwizardfinish="return onFinish();"
         onload="initWizard();"
         style="&window.size;">
-  
+  <script type="application/javascript"
+          src="chrome://global/content/elements/stringbundle.js"/>
+
   <stringbundle id="bundle_profileManager"
                 src="chrome://mozapps/locale/profile/profileSelection.properties"/>
 
   <script type="application/javascript" src="chrome://mozapps/content/profile/createProfileWizard.js"/>
 
   <wizardpage id="explanation" onpageshow="enableNextButton();">
     <description>&profileCreationExplanation_1.text;</description>
     <description>&profileCreationExplanation_2.text;</description>
diff --git a/toolkit/profile/content/profileSelection.xul b/toolkit/profile/content/profileSelection.xul
--- a/toolkit/profile/content/profileSelection.xul
+++ b/toolkit/profile/content/profileSelection.xul
@@ -24,16 +24,19 @@
   buttons="accept,cancel"
   style="width: 30em;"
   onload="startup();"
   ondialogaccept="return acceptDialog()"
   ondialogcancel="return exitDialog()"
   buttonlabelaccept="&start.label;"
   buttonlabelcancel="&exit.label;">
 
+  <script type="application/javascript"
+          src="chrome://global/content/elements/stringbundle.js"/>
+
   <stringbundle id="bundle_profileManager"
                 src="chrome://mozapps/locale/profile/profileSelection.properties"/>
   <stringbundle id="bundle_brand"
                 src="chrome://branding/locale/brand.properties"/>
 
   <script type="application/javascript" src="chrome://mozapps/content/profile/profileSelection.js"/>
 
   <description class="label">&pmDescription.label;</description>
