# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  3c2e6f33567448c19defafb656e6cb9f3a729391
Bug 1172574 - Prevent the default browser check and the about:config warning by default for the scratch_user;r=Mossop

diff --git a/python/mozbuild/mozbuild/mach_commands.py b/python/mozbuild/mozbuild/mach_commands.py
--- a/python/mozbuild/mozbuild/mach_commands.py
+++ b/python/mozbuild/mozbuild/mach_commands.py
@@ -1324,17 +1324,20 @@ class RunProgram(MachCommandBase):
                 args.append('-no-remote')
 
             if not background and sys.platform == 'darwin':
                 args.append('-foreground')
 
             no_profile_option_given = \
                 all(p not in params for p in ['-profile', '--profile', '-P'])
             if no_profile_option_given and not noprofile:
-                prefs = { }
+                prefs = {
+                   'browser.shell.checkDefaultBrowser': False,
+                   'general.warnOnAboutConfig': False,
+                }
                 prefs.update(self._mach_context.settings.runprefs)
                 prefs.update([p.split('=', 1) for p in setpref])
                 for pref in prefs:
                     prefs[pref] = Preferences.cast(prefs[pref])
 
                 path = os.path.join(self.topobjdir, 'tmp', 'scratch_user')
                 profile = Profile(path, preferences=prefs)
                 args.append('-profile')
