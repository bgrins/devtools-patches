# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  5eb1a6d525902c9c1f1db7e4810c6e565929dea1
Bug 1172574 - Prevent the default browser check and the about:config warning by default for the scratch_user;r=Mossop

diff --git a/python/mozbuild/mozbuild/mach_commands.py b/python/mozbuild/mozbuild/mach_commands.py
--- a/python/mozbuild/mozbuild/mach_commands.py
+++ b/python/mozbuild/mozbuild/mach_commands.py
@@ -1326,17 +1326,20 @@ class RunProgram(MachCommandBase):
                 args.append('-no-remote')
 
             if not background and sys.platform == 'darwin':
                 args.append('-foreground')
 
             no_profile_option_given = \
                 all(p not in params for p in ['-profile', '--profile', '-P'])
             if no_profile_option_given and not noprofile:
-                prefs = { }
+                prefs = {
+                   'browser.shell.checkDefaultBrowser': False,
+                   'general.warnOnAboutConfig': False,
+                }
                 prefs.update([p.split('=', 1) for p in setpref])
                 prefs.update(self._mach_context.settings.runprefs)
 
                 path = os.path.join(self.topobjdir, 'tmp', 'scratch_user')
                 profile = Profile(path, preferences=prefs, restore=False)
                 args.append('-profile')
                 args.append(profile.profile)
 
