# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  8aa428237b4e9d0591b899772641a640d8f6a385

diff --git a/toolkit/content/tests/chrome/test_menulist_paging.xul b/toolkit/content/tests/chrome/test_menulist_paging.xul
--- a/toolkit/content/tests/chrome/test_menulist_paging.xul
+++ b/toolkit/content/tests/chrome/test_menulist_paging.xul
@@ -92,17 +92,19 @@ let tests = [
                                    ups: [3, 1, 1] },
   { list: "menulist4", initial: 5, scroll: 2, downs: [], ups: [] }
 ];
 
 function startTest()
 {
   let popup = document.getElementById("menulist-popup1");
   let menupopupHeight = popup.getBoundingClientRect().height;
-  let menuitemHeight = popup.firstChild.getBoundingClientRect().height;
+  let menuitem = popup.firstElementChild;
+  menuitem.render(); // Typically this happens when the popup is opened for the first time.
+  let menuitemHeight = menuitem.getBoundingClientRect().height;
 
   // First, set the height of each popup to the height of four menuitems plus
   // any padding and border on the menupopup.
   let height = menuitemHeight * 4 + (menupopupHeight - menuitemHeight * 10);
   popup.height = height;
   document.getElementById("menulist-popup2").height = height;
   document.getElementById("menulist-popup3").height = height;
   document.getElementById("menulist-popup4").height = height;
