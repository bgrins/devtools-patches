# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  09a4282d1172ac255038e7ccacfd772140b219e2
Bug 1375280 - Force remote debugging prefs off if jsdebugger isn't requested for mochitests;r=jryans

Since the remote debugging pref defaults will be set to true in local builds,
force them off for tests unless --jsdebugger is passed, to limit differences
locally and in automation.

MozReview-Commit-ID: KmkXAGhFXhf

diff --git a/testing/mochitest/mochitest_options.py b/testing/mochitest/mochitest_options.py
--- a/testing/mochitest/mochitest_options.py
+++ b/testing/mochitest/mochitest_options.py
@@ -727,16 +727,22 @@ class MochitestArguments(ArgumentContain
             options.symbolsPath = os.path.join(build_obj.distdir, 'crashreporter-symbols')
 
         if options.jsdebugger:
             options.extraPrefs += [
                 "devtools.debugger.remote-enabled=true",
                 "devtools.chrome.enabled=true",
                 "devtools.debugger.prompt-connection=false"
             ]
+        else:
+            options.extraPrefs += [
+                "devtools.debugger.remote-enabled=false",
+                "devtools.chrome.enabled=false",
+                "devtools.debugger.prompt-connection=true"
+            ]
 
         if options.debugOnFailure and not options.jsdebugger:
             parser.error(
                 "--debug-on-failure requires --jsdebugger.")
 
         if options.debuggerArgs and not options.debugger:
             parser.error(
                 "--debugger-args requires --debugger.")
