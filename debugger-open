# HG changeset patch
# Parent 8f2f3001ab0b293d7c1a76bef5ec988a57ee307e
# User Brian Grinstead <bgrinstead@mozilla.com>
Bug 956087 - Debugger statements should automatically fire up the debugger

diff --git a/browser/devtools/debugger/panel.js b/browser/devtools/debugger/panel.js
--- a/browser/devtools/debugger/panel.js
+++ b/browser/devtools/debugger/panel.js
@@ -98,16 +98,18 @@ DebuggerPanel.prototype = {
     return this._controller.Breakpoints.removeBreakpoint(aLocation);
   },
 
   handleHostChanged: function() {
     this._view.handleHostChanged(this._toolbox.hostType);
   },
 
   highlightWhenPaused: function() {
+    // Bring focus back to the debugger panel
+    this._toolbox.selectTool("jsdebugger");
     this._toolbox.highlightTool("jsdebugger");
 
     // Also raise the toolbox window if it is undocked or select the
     // corresponding tab when toolbox is docked.
     this._toolbox.raise();
   },
 
   unhighlightWhenResumed: function() {
diff --git a/browser/devtools/framework/toolbox.js b/browser/devtools/framework/toolbox.js
--- a/browser/devtools/framework/toolbox.js
+++ b/browser/devtools/framework/toolbox.js
@@ -319,16 +319,20 @@ Toolbox.prototype = {
 
           promise.all([
             splitConsolePromise,
             buttonsPromise,
             framesPromise
           ]).then(() => {
             this.emit("ready");
             deferred.resolve();
+
+            // Load the debugger so that we can detect a debugger; statement
+            // even if the user hasn't clicked on the tab yet.
+            this.loadTool("jsdebugger");
           }, deferred.reject);
         });
       };
 
       // Load the toolbox-level actor fronts and utilities now
       this._target.makeRemote().then(() => {
         iframe.setAttribute("src", this._URL);
         iframe.setAttribute("aria-label", toolboxStrings("toolbox.label"))
