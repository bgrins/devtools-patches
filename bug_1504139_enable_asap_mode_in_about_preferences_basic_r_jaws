# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Date 1549306245 28800
#      Mon Feb 04 10:50:45 2019 -0800
# Node ID 53a2b9e0b0896f8152c358d6f48537e19bc62c8e
# Parent  fc35330e07dac48cab0ae9cbe3f98565091f0880
Bug 1504139 - Enable ASAP mode in about_preferences_basic;r=jaws

Our best guess as to what caused this regression is that we hit a tiny cliff,
where enough delay was introduced by the change that we ended up painting
for the next frame's vsync. ASAP mode causes us to paint ASAP after the DOM
has been dirtied, without waiting for vsync.

Differential Revision: https://phabricator.services.mozilla.com/D18584

diff --git a/testing/talos/talos/test.py b/testing/talos/talos/test.py
--- a/testing/talos/talos/test.py
+++ b/testing/talos/talos/test.py
@@ -1032,8 +1032,11 @@ class about_preferences_basic(Pageloader
     tpcycles = 25
     tppagecycles = 1
     gecko_profile_interval = 1
     gecko_profile_entries = 2000000
     filters = filter.ignore_first.prepare(5) + filter.median.prepare()
     unit = 'ms'
     lower_is_better = True
     fnbpaint = True
+    """ASAP mode"""
+    preferences = {'layout.frame_rate': 0,
+                   'docshell.event_starvation_delay_hint': 1}
