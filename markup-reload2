# HG changeset patch
# Parent 2a0d75a59098a3a1699c7700a7eaec8f56bf462a
# User Brian Grinstead <bgrinstead@mozilla.com>
Bug 1036324 - Fix markup view disappearing on reload during request

diff --git a/toolkit/devtools/server/actors/inspector.js b/toolkit/devtools/server/actors/inspector.js
--- a/toolkit/devtools/server/actors/inspector.js
+++ b/toolkit/devtools/server/actors/inspector.js
@@ -3150,17 +3150,21 @@ function DocumentWalker(aNode, aRootWin,
     throw new Error("Got an invalid root window in DocumentWalker");
   }
 
   this.walker = Cc["@mozilla.org/inspector/deep-tree-walker;1"].createInstance(Ci.inIDeepTreeWalker);
   this.walker.showAnonymousContent = true;
   this.walker.showSubDocuments = true;
   this.walker.showDocumentsAsNodes = true;
   this.walker.init(aRootWin.document, aShow);
-  this.walker.currentNode = aNode;
+
+  // If the walker cannot find or set the currentNode don't throw.
+  try {
+    this.walker.currentNode = aNode;
+  } catch(e) { }
   this.filter = aFilter;
 }
 
 DocumentWalker.prototype = {
   get node() this.walker.node,
   get whatToShow() this.walker.whatToShow,
   get currentNode() this.walker.currentNode,
   set currentNode(aVal) this.walker.currentNode = aVal,
