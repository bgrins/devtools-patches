# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  97208b5251d7e86cb4051711609b6236a944981e
Bug 1496829 - Prevent the findbar close animation when adopting a tab that has a previously-closed findbar;r=Gijs

The connectedCallback fires after it's already in the DOM, so even though we hide it immediately
we still trigger the CSS animation.

diff --git a/toolkit/content/widgets/findbar.js b/toolkit/content/widgets/findbar.js
--- a/toolkit/content/widgets/findbar.js
+++ b/toolkit/content/widgets/findbar.js
@@ -43,19 +43,23 @@ class MozFindbar extends XULElement {
         <image anonid="find-status-icon" class="findbar-find-fast find-status-icon" />
         <description anonid="find-status" control="findbar-textbox" class="findbar-find-fast findbar-find-status" />
       </hbox>
       <toolbarbutton anonid="find-closebutton" class="findbar-closebutton close-icon" data-l10n-id="findbar-find-button-close" oncommand="close();" />
     `);
   }
 
   connectedCallback() {
+    // If the findbar is never going to get opened - for example when adopting a tab
+    // with a closed findbar into another window - then we don't want the hiding to
+    // be animated:
+    this.setAttribute("noanim", "true");
+    this.hidden = true;
     this.appendChild(document.importNode(this.content, true));
 
-    this.hidden = true;
 
     /**
      * Please keep in sync with toolkit/modules/FindBarChild.jsm
      */
     this.FIND_NORMAL = 0;
 
     this.FIND_TYPEAHEAD = 1;
 
