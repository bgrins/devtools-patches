# HG changeset patch
# Parent  010ecb3b3b25616052550722940bbf9faba1cf89
Bug 1164210: 4116() should return a true Array r=florent

diff --git a/toolkit/devtools/webconsole/utils.js b/toolkit/devtools/webconsole/utils.js
--- a/toolkit/devtools/webconsole/utils.js
+++ b/toolkit/devtools/webconsole/utils.js
@@ -1633,17 +1633,26 @@ WebConsoleCommands._registerOriginal("$"
  *
  * @param string aSelector
  *        A string that is passed to window.document.querySelectorAll.
  * @return nsIDOMNodeList
  *         Returns the result of document.querySelectorAll(aSelector).
  */
 WebConsoleCommands._registerOriginal("$$", function JSTH_$$(aOwner, aSelector)
 {
-  return aOwner.window.document.querySelectorAll(aSelector);
+  let nodes = new aOwner.window.wrappedJSObject.Array();
+  let results = aOwner.window.document.querySelectorAll(aSelector);
+
+  let node;
+
+  for (var i = 0; i < results.length; ++i) {
+    nodes.push(results[i]);
+  }
+
+  return nodes;
 });
 
 /**
  * Returns the result of the last console input evaluation
  *
  * @return object|undefined
  * Returns last console evaluation or undefined
  */
