# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  f9b4c81ca1a0a8d8a8d82ade1dc6b6e67e009cb4
Bug 1243388 - Don't access CPOW in browser_webconsole_bug_597756_reopen_closed_tab.js;r=linclark

diff --git a/devtools/client/webconsole/test/browser_webconsole_bug_597756_reopen_closed_tab.js b/devtools/client/webconsole/test/browser_webconsole_bug_597756_reopen_closed_tab.js
--- a/devtools/client/webconsole/test/browser_webconsole_bug_597756_reopen_closed_tab.js
+++ b/devtools/client/webconsole/test/browser_webconsole_bug_597756_reopen_closed_tab.js
@@ -49,16 +49,17 @@ add_task(function* () {
 
   yield testMessages();
 
   HUD = null;
 });
 
 function reload(browser) {
   let loaded = loadBrowser(browser);
+  //
   content.location.reload();
   return loaded;
 }
 
 function testMessages() {
   return waitForMessages({
     webconsole: HUD,
     messages: [{
diff --git a/devtools/client/webconsole/webconsole.js b/devtools/client/webconsole/webconsole.js
--- a/devtools/client/webconsole/webconsole.js
+++ b/devtools/client/webconsole/webconsole.js
@@ -3365,19 +3365,20 @@ JSTerm.prototype = {
         deferred.resolve(response);
       }
       else {
         deferred.reject(response);
       }
     }
 
     let frameActor = null;
-    if ("frame" in options) {
+    if (options.hasOwnProperty("frame") && options.frame != -1) {
       frameActor = this.getFrameActor(options.frame);
     }
+    console.log("requestEvaluation", options.frame, frameActor)
 
     let evalOptions = {
       bindObjectActor: options.bindObjectActor,
       frameActor: frameActor,
       selectedNodeActor: options.selectedNodeActor,
       selectedObjectActor: options.selectedObjectActor,
     };
 
