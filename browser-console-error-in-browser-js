# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  e31bba82ae4f3772bb142f953f7a718ae4cfb37c
Bug 1175637 - Make sure browserWin.BrowserViewSourceOfDocument exists before attempting to call it;r=jryans

This handles the case when there is a syntax error in browser.js that shows up in the
Browser Console, and you try to click the link to the source.  Without this, an exception
is thrown but with it the source opens in a new window.

diff --git a/browser/devtools/webconsole/hudservice.js b/browser/devtools/webconsole/hudservice.js
--- a/browser/devtools/webconsole/hudservice.js
+++ b/browser/devtools/webconsole/hudservice.js
@@ -435,17 +435,17 @@ WebConsole.prototype = {
    *        The URL of the file.
    * @param integer aSourceLine
    *        The line number which should be highlighted.
    */
   viewSource: function WC_viewSource(aSourceURL, aSourceLine) {
     // Attempt to access view source via a browser first, which may display it in
     // a tab, if enabled.
     let browserWin = Services.wm.getMostRecentWindow("navigator:browser");
-    if (browserWin) {
+    if (browserWin && browserWin.BrowserViewSourceOfDocument) {
       return browserWin.BrowserViewSourceOfDocument({
         URL: aSourceURL,
         lineNumber: aSourceLine
       });
     }
     this.gViewSourceUtils.viewSource(aSourceURL, null, this.iframeWindow.document, aSourceLine || 0);
   },
 
