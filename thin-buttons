# HG changeset patch
# Parent 7717dd65a4f685e11fea8e532716abad3afd496c
# User Brian Grinstead <bgrinstead@mozilla.com>
Bug 942292 - DevTools themes - make the toolbars thinner part 2;r=vporof

diff --git a/browser/devtools/canvasdebugger/canvasdebugger.xul b/browser/devtools/canvasdebugger/canvasdebugger.xul
--- a/browser/devtools/canvasdebugger/canvasdebugger.xul
+++ b/browser/devtools/canvasdebugger/canvasdebugger.xul
@@ -16,17 +16,18 @@
   <script src="chrome://browser/content/devtools/theme-switching.js"/>
   <script type="application/javascript" src="canvasdebugger.js"/>
 
   <hbox class="theme-body" flex="1">
     <vbox id="snapshots-pane">
       <toolbar id="snapshots-toolbar"
                class="devtools-toolbar">
         <hbox id="snapshots-controls"
-              class="devtools-toolbarbutton-group">
+              class="devtools-toolbarbutton-group"
+              separators="true">
           <toolbarbutton id="record-snapshot"
                          class="devtools-toolbarbutton"
                          oncommand="SnapshotsListView._onRecordButtonClick()"
                          tooltiptext="&canvasDebuggerUI.recordSnapshot.tooltip;"
                          hidden="true"/>
           <toolbarbutton id="import-snapshot"
                          class="devtools-toolbarbutton"
                          oncommand="SnapshotsListView._onImportButtonClick()"
diff --git a/browser/devtools/debugger/debugger-view.js b/browser/devtools/debugger/debugger-view.js
--- a/browser/devtools/debugger/debugger-view.js
+++ b/browser/devtools/debugger/debugger-view.js
@@ -528,19 +528,21 @@ let DebuggerView = {
   toggleInstrumentsPane: function(aFlags, aTabIndex) {
     let pane = this._instrumentsPane;
     let button = this._instrumentsPaneToggleButton;
 
     ViewHelpers.togglePane(aFlags, pane);
 
     if (aFlags.visible) {
       button.removeAttribute("pane-collapsed");
+      button.setAttribute("pane-opened", "");
       button.setAttribute("tooltiptext", this._collapsePaneString);
     } else {
       button.setAttribute("pane-collapsed", "");
+      button.removeAttribute("pane-opened");
       button.setAttribute("tooltiptext", this._expandPaneString);
     }
 
     if (aTabIndex !== undefined) {
       pane.selectedIndex = aTabIndex;
     }
   },
 
diff --git a/browser/devtools/debugger/debugger.xul b/browser/devtools/debugger/debugger.xul
--- a/browser/devtools/debugger/debugger.xul
+++ b/browser/devtools/debugger/debugger.xul
@@ -331,17 +331,17 @@
       <vbox id="stackframes" flex="1"/>
       <textbox id="searchbox"
                class="devtools-searchinput" type="search"/>
       <toolbarbutton id="instruments-pane-toggle"
                      class="devtools-toolbarbutton"
                      tooltiptext="&debuggerUI.panesButton.tooltip;"
                      tabindex="0"/>
       <toolbarbutton id="debugger-options"
-                     class="devtools-option-toolbarbutton"
+                     class="devtools-toolbarbutton devtools-option-toolbarbutton"
                      tooltiptext="&debuggerUI.optsButton.tooltip;"
                      popup="debuggerPrefsContextMenu"
                      tabindex="0"/>
     </toolbar>
     <vbox id="globalsearch" orient="vertical" hidden="true"/>
     <splitter class="devtools-horizontal-splitter" hidden="true"/>
     <hbox id="debugger-widgets" flex="1">
       <tabbox id="sources-pane"
diff --git a/browser/devtools/profiler/profiler.xul b/browser/devtools/profiler/profiler.xul
--- a/browser/devtools/profiler/profiler.xul
+++ b/browser/devtools/profiler/profiler.xul
@@ -20,17 +20,18 @@
   <script type="application/javascript;version=1.8"
           src="chrome://browser/content/devtools/theme-switching.js"/>
   <script type="text/javascript" src="sidebar.js"/>
   <box flex="1" id="profiler-chrome"
     class="devtools-responsive-container theme-body">
     <vbox class="profiler-sidebar theme-sidebar">
       <toolbar class="devtools-toolbar">
         <hbox id="profiler-controls"
-              class="devtools-toolbarbutton-group">
+              class="devtools-toolbarbutton-group"
+              separators="true">
           <toolbarbutton id="profiler-start"
             tooltiptext="&startProfiler.tooltip;"
             class="devtools-toolbarbutton"
             disabled="true"/>
           <toolbarbutton id="profiler-import"
             class="devtools-toolbarbutton"
             disabled="true"
             label="&importProfile.label;"/>
diff --git a/browser/devtools/styleeditor/styleeditor.xul b/browser/devtools/styleeditor/styleeditor.xul
--- a/browser/devtools/styleeditor/styleeditor.xul
+++ b/browser/devtools/styleeditor/styleeditor.xul
@@ -78,24 +78,26 @@
   <xul:keyset id="sourceEditorKeys"/>
 
   <xul:stack id="style-editor-chrome" class="loading theme-body">
 
     <xul:box class="splitview-root" context="sidebar-context">
       <xul:box class="splitview-controller">
         <xul:box class="splitview-main">
           <xul:toolbar class="devtools-toolbar">
-            <xul:toolbarbutton class="style-editor-newButton devtools-toolbarbutton"
-                        accesskey="&newButton.accesskey;"
-                        tooltiptext="&newButton.tooltip;"
-                        label="&newButton.label;"/>
-            <xul:toolbarbutton class="style-editor-importButton devtools-toolbarbutton"
-                        accesskey="&importButton.accesskey;"
-                        tooltiptext="&importButton.tooltip;"
-                        label="&importButton.label;"/>
+            <xul:hbox class="devtools-toolbarbutton-group" separators="true">
+              <xul:toolbarbutton class="style-editor-newButton devtools-toolbarbutton"
+                          accesskey="&newButton.accesskey;"
+                          tooltiptext="&newButton.tooltip;"
+                          label="&newButton.label;"/>
+              <xul:toolbarbutton class="style-editor-importButton devtools-toolbarbutton"
+                          accesskey="&importButton.accesskey;"
+                          tooltiptext="&importButton.tooltip;"
+                          label="&importButton.label;"/>
+            </xul:hbox>
           </xul:toolbar>
         </xul:box>
         <xul:box id="splitview-resizer-target" class="theme-sidebar splitview-nav-container"
                 persist="height">
           <ol class="splitview-nav" tabindex="0"></ol>
           <div class="splitview-nav placeholder empty">
             <p><strong>&noStyleSheet.label;</strong></p>
             <p>&noStyleSheet-tip-start.label;
diff --git a/browser/devtools/webconsole/webconsole.xul b/browser/devtools/webconsole/webconsole.xul
--- a/browser/devtools/webconsole/webconsole.xul
+++ b/browser/devtools/webconsole/webconsole.xul
@@ -157,17 +157,18 @@ function goUpdateConsoleCommands() {
             <menuitem label="&btnConsoleLog;" type="checkbox" autocheck="false"
                       prefKey="log"/>
           </menupopup>
         </toolbarbutton>
 
         <toolbarbutton class="webconsole-clear-console-button devtools-toolbarbutton"
                        label="&btnClear.label;" tooltiptext="&btnClear.tooltip;"
                        accesskey="&btnClear.accesskey;"
-                       tabindex="8"/>
+                       tabindex="8"
+                       separators="true"/>
 
         <spacer flex="1"/>
 
         <textbox class="compact hud-filter-box devtools-searchinput" type="search"
                  placeholder="&filterOutput.placeholder;" tabindex="2"/>
       </toolbar>
 
       <hbox id="output-wrapper" flex="1" context="output-contextmenu" tooltip="aHTMLTooltip">
diff --git a/browser/themes/shared/devtools/toolbars.inc.css b/browser/themes/shared/devtools/toolbars.inc.css
--- a/browser/themes/shared/devtools/toolbars.inc.css
+++ b/browser/themes/shared/devtools/toolbars.inc.css
@@ -4,45 +4,64 @@
  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
 %endif
 %filter substitution
 %define smallSeparatorDark linear-gradient(transparent 15%, #5a6169 15%, #5a6169 85%, transparent 85%)
 %define smallSeparatorLight linear-gradient(transparent 15%, #aaa 15%, #aaa 85%, transparent 85%)
 %define solidSeparatorDark linear-gradient(#2d5b7d, #2d5b7d)
 %define solidSeparatorLight linear-gradient(#aaa, #aaa)
 
-
+/* Toolbar */
 .devtools-toolbar {
   -moz-appearance: none;
   padding: 0 3px;
   border-bottom-width: 1px;
   border-bottom-style: solid;
   min-height: 24px;
   box-sizing: border-box;
 }
 
+/* Toolbar buttons */
 .devtools-menulist,
 .devtools-toolbarbutton {
   -moz-appearance: none;
   -moz-box-align: center;
+  background: transparent;
   min-width: 78px;
   min-height: 21px;
   padding: 1px;
   text-shadow: none;
-  border: 1px solid hsla(210,8%,5%,.45);
-  border-radius: 3px;
+  border-radius: 0;
+  border-width: 1px;
+  border-style: solid;
   margin: 0 3px;
 }
 
 .devtools-menulist:-moz-focusring,
 .devtools-toolbarbutton:-moz-focusring {
   outline: 1px dotted hsla(210,30%,85%,0.7);
   outline-offset: -4px;
 }
 
+.devtools-toolbar .devtools-toolbarbutton {
+  border-width: 0;
+}
+
+.devtools-toolbar .devtools-toolbarbutton-group[separators] .devtools-toolbarbutton[type=menu-button],
+.devtools-toolbar .devtools-toolbarbutton-group[separators] .devtools-toolbarbutton,
+.devtools-toolbar .devtools-toolbarbutton[type=menu-button],
+.devtools-toolbar .devtools-toolbarbutton[separators] {
+  border-left-width: 1px;
+  border-right-width: 1px;
+}
+
+.devtools-toolbarbutton:not([label]) {
+  border-width: 0;
+}
+
 .devtools-toolbarbutton > .toolbarbutton-icon {
   margin: 0;
 }
 
 .devtools-toolbarbutton:not([label]) {
   min-width: 32px;
 }
 
@@ -50,167 +69,103 @@
   display: none;
 }
 
 .devtools-toolbarbutton > .toolbarbutton-menubutton-button {
   -moz-box-orient: horizontal;
   padding: 0;
 }
 
-.theme-dark .devtools-menulist,
-.theme-dark .devtools-toolbarbutton {
-  background: linear-gradient(hsla(212,7%,57%,.35), hsla(212,7%,57%,.1)) padding-box;
-  color: inherit;
-  box-shadow: 0 1px 0 hsla(210,16%,76%,.15) inset, 0 0 0 1px hsla(210,16%,76%,.15) inset, 0 1px 0 hsla(210,16%,76%,.15);
-}
-
-.theme-light .devtools-menulist,
-.theme-light .devtools-toolbarbutton {
-  background: #f7f7f7;
-  color: #18191a;
-  border-color: #bbb;
-}
-
-.theme-light .devtools-menulist[open=true],
-.theme-light .devtools-toolbarbutton[open=true],
-.theme-light .devtools-toolbarbutton[open=true]:hover,
-.theme-light .devtools-toolbarbutton[open=true]:hover:active,
-.theme-light .devtools-toolbarbutton[checked=true],
-.theme-light .devtools-toolbarbutton[checked=true]:hover  {
-  background: #ddd;
-}
-
-.theme-light .devtools-toolbarbutton:hover {
-  background: #eee;
-}
-
-.theme-light .devtools-toolbarbutton:hover:active,
-.theme-light .devtools-toolbarbutton[checked=true]:hover:active {
-  background: #e8e8e8;
-}
-
-.theme-light .devtools-toolbarbutton[type=menu-button] > .toolbarbutton-menubutton-button {
-  color: #667380;
-}
-
-.theme-light .devtools-toolbarbutton[type=menu-button][checked=true] > .toolbarbutton-menubutton-button {
-  color: #18191a;
-}
-
-.theme-dark .devtools-toolbarbutton:not([checked]):hover:active {
-  border-color: hsla(210,8%,5%,.6);
-  background: linear-gradient(hsla(220,6%,10%,.3), hsla(212,7%,57%,.15) 65%, hsla(212,7%,57%,.3));
-  box-shadow: 0 0 3px hsla(210,8%,5%,.25) inset, 0 1px 3px hsla(210,8%,5%,.25) inset, 0 1px 0 hsla(210,16%,76%,.15);
-}
-
-.theme-dark .devtools-menulist[open=true],
-.theme-dark .devtools-toolbarbutton[open=true],
-.theme-dark .devtools-toolbarbutton[checked=true] {
-  border-color: hsla(210,8%,5%,.6) !important;
-  background: linear-gradient(hsla(220,6%,10%,.6), hsla(210,11%,18%,.45) 75%, hsla(210,11%,30%,.4));
-  box-shadow: 0 1px 3px hsla(210,8%,5%,.25) inset, 0 1px 3px hsla(210,8%,5%,.25) inset, 0 1px 0 hsla(210,16%,76%,.15);
-}
-
-.theme-dark .devtools-toolbarbutton[checked=true] {
-  color: hsl(208,100%,60%);
-}
-
-.theme-dark .devtools-toolbarbutton[checked=true]:hover {
-  background-color: transparent !important;
-}
-
-.theme-dark .devtools-toolbarbutton[checked=true]:hover:active {
-  background-color: hsla(210,8%,5%,.2) !important;
-}
-
-.devtools-option-toolbarbutton {
-  -moz-appearance: none;
-  list-style-image: url("chrome://browser/skin/devtools/tool-options.svg");
-  background: none;
-  opacity: .8;
-  border: none;
-}
-
-.devtools-option-toolbarbutton[open=true] {
-  opacity: 1;
-}
-
-.devtools-menulist > .menulist-label-box {
-  text-align: center;
-}
-
-.devtools-menulist > .menulist-dropmarker {
-  -moz-appearance: none;
-  display: -moz-box;
-  list-style-image: url("chrome://browser/skin/devtools/dropmarker.png");
-  -moz-box-align: center;
-  min-width: 16px;
-}
-
-.devtools-toolbarbutton[type=menu-button] > .toolbarbutton-menubutton-button {
-  -moz-appearance: none;
-  color: inherit;
-  border-width: 0;
-}
-
-.theme-dark .devtools-toolbarbutton[type=menu-button] > .toolbarbutton-menubutton-button {
-  -moz-border-end: 1px solid hsla(210,8%,5%,.45);
-  box-shadow: -1px 0 0 hsla(210,16%,76%,.15) inset, 1px 0 0 hsla(210,16%,76%,.15);
-}
-
-.theme-dark .devtools-toolbarbutton[type=menu-button]:-moz-locale-dir(rtl) > .toolbarbutton-menubutton-button {
-  box-shadow: 1px 0 0 hsla(210,16%,76%,.15) inset, -1px 0 0 hsla(210,16%,76%,.15);
-}
-
-.theme-light .devtools-toolbarbutton[type=menu-button] > .toolbarbutton-menubutton-button {
-  -moz-border-end: 1px solid #bbb;
-}
-
 .devtools-toolbarbutton[type=menu-button] {
   padding: 0 1px;
   -moz-box-align: stretch;
 }
 
 .devtools-toolbarbutton[type=menu] > .toolbarbutton-menu-dropmarker,
 .devtools-toolbarbutton[type=menu-button] > .toolbarbutton-menubutton-dropmarker {
   -moz-appearance: none !important;
   list-style-image: url("chrome://browser/skin/devtools/dropmarker.png");
   -moz-box-align: center;
   padding: 0 3px;
 }
 
 /* Toolbar button groups */
-.theme-light .devtools-toolbarbutton-group > .devtools-toolbarbutton,
-.theme-dark .devtools-toolbarbutton-group > .devtools-toolbarbutton {
+.devtools-toolbarbutton-group > .devtools-toolbarbutton {
   margin: 0;
   box-shadow: none;
-  border-radius: 0;
-  border-width: 0;
-  -moz-border-end-width: 1px;
   outline-offset: -3px;
 }
 
-.devtools-toolbarbutton-group > .devtools-toolbarbutton:last-of-type {
-  -moz-border-end-width: 0;
-}
-
 .devtools-toolbarbutton-group {
-  border-radius: 3px;
   margin: 0 3px;
 }
 
-.theme-dark .devtools-toolbarbutton-group {
-  box-shadow: 0 1px 0 hsla(210,16%,76%,.15) inset,
-              0 0 0 1px hsla(210,16%,76%,.15) inset,
-              0 1px 0 hsla(210,16%,76%,.15);
-  border: 1px solid hsla(210,8%,5%,.45);
+.devtools-toolbarbutton-group .devtools-toolbarbutton:not(:first-child) {
+  border-left: none;
 }
 
-.theme-light .devtools-toolbarbutton-group {
-  border: 1px solid #bbb;
+.theme-dark .devtools-menulist,
+.theme-dark .devtools-toolbarbutton {
+  color: #a9bacb; /* Body text - high contrast */
+  background-color: #343c45; /* Toolbars */
+  border-color: #000; /* Splitters */
+  color: inherit;
+}
+.theme-light .devtools-menulist,
+.theme-light .devtools-toolbarbutton {
+  color: #292e33; /* Body text - high contrast */
+  background-color: #f0f1f2; /* Toolbars */
+  border-color: #aaa; /* Splitters */
+}
+
+.theme-dark .devtools-menulist[open=true],
+.theme-dark .devtools-toolbarbutton[open=true],
+.theme-dark .devtools-toolbarbutton[open=true]:hover,
+.theme-dark .devtools-toolbarbutton[open=true]:hover:active,
+.theme-dark .devtools-toolbarbutton[checked=true],
+.theme-dark .devtools-toolbarbutton[checked=true]:hover,
+.theme-dark .devtools-toolbarbutton[pane-opened]  {
+  background: rgba(0, 0, 0, .4); /* Splitters */
+}
+.theme-light .devtools-menulist[open=true],
+.theme-light .devtools-toolbarbutton[open=true],
+.theme-light .devtools-toolbarbutton[open=true]:hover,
+.theme-light .devtools-toolbarbutton[open=true]:hover:active,
+.theme-light .devtools-toolbarbutton[checked=true],
+.theme-light .devtools-toolbarbutton[checked=true]:hover,
+.theme-light .devtools-toolbarbutton[pane-opened] {
+  background: rgba(170, 170, 170, .4); /* Splitters */
+}
+
+.theme-dark .devtools-toolbarbutton:hover {
+  background: rgba(0, 0, 0, .1); /* Splitters */
+}
+.theme-light .devtools-toolbarbutton:hover {
+  background: rgba(170, 170, 170, .1); /* Splitters */
+}
+
+.theme-dark .devtools-toolbarbutton:hover:active,
+.theme-dark .devtools-toolbarbutton[checked=true]:hover:active {
+  background: rgba(0, 0, 0, .2); /* Splitters */
+}
+.theme-light .devtools-toolbarbutton:hover:active,
+.theme-light .devtools-toolbarbutton[checked=true]:hover:active {
+  background: rgba(170, 170, 170, .2); /* Splitters */
+}
+
+.devtools-option-toolbarbutton {
+  -moz-appearance: none;
+  list-style-image: url("chrome://browser/skin/devtools/tool-options.svg");
+  background: none;
+  opacity: .8;
+  border: none;
+}
+
+.devtools-option-toolbarbutton[open=true] {
+  opacity: 1;
 }
 
 /* Text input */
 
 .devtools-textinput,
 .devtools-searchinput {
   -moz-appearance: none;
   margin: 0 3px;
diff --git a/browser/themes/shared/devtools/webconsole.inc.css b/browser/themes/shared/devtools/webconsole.inc.css
--- a/browser/themes/shared/devtools/webconsole.inc.css
+++ b/browser/themes/shared/devtools/webconsole.inc.css
@@ -177,20 +177,16 @@ a {
 }
 
 /* WebConsole colored drops */
 
 .webconsole-filter-button {
   -moz-user-focus: normal;
 }
 
-.webconsole-filter-button[checked] {
-  color: white !important;
-}
-
 .webconsole-filter-button > .toolbarbutton-menubutton-button:before {
   content: "";
   display: inline-block;
   height: 8px;
   width: 8px;
   border-radius: 50%;
   margin-left: 5px;
   border-width: 1px;
