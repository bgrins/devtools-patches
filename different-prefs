# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  3f3375e645c8bdc8bbd63e8c1f40f7c2da8c7070
Don't check for default browser or warn about about:config in local builds

diff --git a/browser/app/profile/firefox.js b/browser/app/profile/firefox.js
--- a/browser/app/profile/firefox.js
+++ b/browser/app/profile/firefox.js
@@ -249,18 +249,25 @@ pref("browser.uidensity", 0);
 // Whether Firefox will automatically override the uidensity to "touch"
 // while the user is in a touch environment (such as Windows tablet mode).
 #ifdef MOZ_PHOTON_THEME
 pref("browser.touchmode.auto", true);
 #else
 pref("browser.touchmode.auto", false);
 #endif
 
+#ifdef MOZILLA_OFFICIAL
 // At startup, check if we're the default browser and prompt user if not.
 pref("browser.shell.checkDefaultBrowser", true);
+#else
+// In local builds, skip the default browser check. This is sticky so that
+// the default doesn't get reset if the profile is shared with an official channel
+sticky_pref("browser.shell.checkDefaultBrowser", false);
+#endif
+
 pref("browser.shell.shortcutFavicons",true);
 pref("browser.shell.mostRecentDateSetAsDefault", "");
 pref("browser.shell.skipDefaultBrowserCheckOnFirstRun", true);
 pref("browser.shell.didSkipDefaultBrowserCheckOnFirstRun", false);
 pref("browser.shell.defaultBrowserCheckCount", 0);
 pref("browser.defaultbrowser.notificationbar", false);
 
 // 0 = blank, 1 = home (browser.startup.homepage), 2 = last visited page, 3 = resume previous browser session
@@ -503,18 +510,19 @@ pref("browser.bookmarks.autoExportHTML",
 //  0: no backups created (and deletes all existing backups)
 pref("browser.bookmarks.max_backups",             15);
 
 pref("browser.bookmarks.showRecentlyBookmarked",  true);
 
 // Scripts & Windows prefs
 pref("dom.disable_open_during_load",              true);
 pref("javascript.options.showInConsole",          true);
-#ifdef DEBUG
-pref("general.warnOnAboutConfig",                 false);
+
+#ifndef MOZILLA_OFFICIAL
+sticky_pref("general.warnOnAboutConfig",          false);
 #endif
 
 // This is the pref to control the location bar, change this to true to
 // force this - this makes the origin of popup windows more obvious to avoid
 // spoofing. We would rather not do it by default because it affects UE for web
 // applications, but without it there isn't a really good way to prevent chrome
 // spoofing, see bug 337344
 pref("dom.disable_window_open_feature.location",  true);
