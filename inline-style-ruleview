# HG changeset patch
# Parent 540d85f60c57daaf9614f6c19b2d13e5cf77da95
# User Brian Grinstead <bgrinstead@mozilla.com>
Bug 942297 - [ruleview] Styles do not refresh after being updated from the rule view, then from an inline style

diff --git a/browser/devtools/styleinspector/rule-view.js b/browser/devtools/styleinspector/rule-view.js
--- a/browser/devtools/styleinspector/rule-view.js
+++ b/browser/devtools/styleinspector/rule-view.js
@@ -724,24 +724,26 @@ Rule.prototype = {
   /**
    * Get the list of TextProperties from the style.  Needs
    * to parse the style's cssText.
    */
   _getTextProperties: function Rule_getTextProperties()
   {
     let textProps = [];
     let store = this.elementStyle.store;
+    console.log("GEtting text properties", this.style.cssText)
     let props = this._parseCSSText(this.style.cssText);
     for (let prop of props) {
       let name = prop.name;
       if (this.inherited && !domUtils.isInheritedProperty(name)) {
         continue;
       }
-      let value = store.userProperties.getProperty(this.style, name, prop.value);
-      let textProp = new TextProperty(this, name, value, prop.priority);
+
+      // let value = store.userProperties.getProperty(this.style, name, prop.value);
+      let textProp = new TextProperty(this, name, prop.value, prop.priority);
       textProps.push(textProp);
     }
 
     return textProps;
   },
 
   /**
    * Return the list of disabled properties from the store for this rule.
@@ -771,16 +773,18 @@ Rule.prototype = {
   /**
    * Reread the current state of the rules and rebuild text
    * properties as needed.
    */
   refresh: function Rule_refresh(aOptions)
   {
     this.matchedSelectors = aOptions.matchedSelectors || [];
     let newTextProps = this._getTextProperties();
+    console.log("Refreshing rule-view", newTextProps);
+    debugger;
 
     // Update current properties for each property present on the style.
     // This will mark any touched properties with _visited so we
     // can detect properties that weren't touched (because they were
     // removed from the style).
     // Also keep track of properties that didn't exist in the current set
     // of properties.
     let brandNewProps = [];
