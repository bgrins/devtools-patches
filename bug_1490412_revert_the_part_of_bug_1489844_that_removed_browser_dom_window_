# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Date 1536698240 25200
#      Tue Sep 11 13:37:20 2018 -0700
# Node ID 99243b5da736228ce164af82934d4d9299f400d5
# Parent  423bdf7a802b0d302244492b423609187de39f56
Bug 1490412 - Revert the part of Bug 1489844 that removed browser.dom.window.dump.enabled from all.js;r=Ehsan

Moving this to C++ caused browser.dom.window.dump.enabled to become false in artifact
builds, since MOZILLA_OFFICIAL is true for the binaries used in that case. Restoring
the preference in all.js fixes this, since that file is built locally with artifact builds.

Differential Revision: https://phabricator.services.mozilla.com/D5586

diff --git a/modules/libpref/init/all.js b/modules/libpref/init/all.js
--- a/modules/libpref/init/all.js
+++ b/modules/libpref/init/all.js
@@ -1054,16 +1054,23 @@ pref("toolkit.asyncshutdown.crash_timeou
 #else
 // MOZ_ASAN builds can be considerably slower. Extending the grace period
 // of both asyncshutdown and the terminator.
 pref("toolkit.asyncshutdown.crash_timeout", 180000); // 3 minutes
 #endif // MOZ_ASAN
 // Extra logging for AsyncShutdown barriers and phases
 pref("toolkit.asyncshutdown.log", false);
 
+#ifdef MOZILLA_OFFICIAL
+// enable JS dump() function.
+pref("browser.dom.window.dump.enabled", false, sticky);
+#else
+pref("browser.dom.window.dump.enabled", true, sticky);
+#endif
+
 // Controls whether EventEmitter module throws dump message on each emit
 pref("toolkit.dump.emit", false);
 
 // Enable recording/replaying executions.
 #if defined(XP_MACOSX) && defined(NIGHTLY_BUILD)
 pref("devtools.recordreplay.enabled", false);
 pref("devtools.recordreplay.enableRewinding", true);
 #endif
