# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  21a9d7dc2e02a71b765fd4724200b23c9d695067
Bug 1226810 - Modifications to acorn after upgrade;r=fitzgen

diff --git a/devtools/shared/acorn/UPGRADING.md b/devtools/shared/acorn/UPGRADING.md
--- a/devtools/shared/acorn/UPGRADING.md
+++ b/devtools/shared/acorn/UPGRADING.md
@@ -21,8 +21,11 @@ 3. Copy acorn.js to our tree:
 
 4. Copy acorn_loose.js to our tree:
 
        $ cp acorn_loose.js /path/to/mozilla-central/devtools/shared/acorn/acorn_loose.js
 
 5. Copy util/walk.js to our tree:
 
        $ cp util/walk.js /path/to/mozilla-central/devtools/shared/acorn/walk.js
+
+6. Check and see if javascript pretty-printing and scratchpad work without any errors.  As of version 2.6.4 we need to comment out lines in acorn_loose.js that attempt to extend the acorn object, like `acorn.parse_dammit = parse_dammit`.
+
diff --git a/devtools/shared/acorn/acorn_loose.js b/devtools/shared/acorn/acorn_loose.js
--- a/devtools/shared/acorn/acorn_loose.js
+++ b/devtools/shared/acorn/acorn_loose.js
@@ -573,19 +573,21 @@ exports.pluginsLoose = _state.pluginsLoo
 acorn.defaultOptions.tabSize = 4;
 
 function parse_dammit(input, options) {
   var p = new _state.LooseParser(input, options);
   p.next();
   return p.parseTopLevel();
 }
 
-acorn.parse_dammit = parse_dammit;
-acorn.LooseParser = _state.LooseParser;
-acorn.pluginsLoose = _state.pluginsLoose;
+// Don't define new properties on acorn because of:
+// TypeError: can't define property "parse_dammit": Object is not extensible
+// acorn.parse_dammit = parse_dammit;
+// acorn.LooseParser = _state.LooseParser;
+// acorn.pluginsLoose = _state.pluginsLoose;
 
 },{"..":1,"./expression":2,"./state":5,"./statement":6,"./tokenize":7}],4:[function(_dereq_,module,exports){
 "use strict";
 
 exports.__esModule = true;
 exports.isDummy = isDummy;
 
 function isDummy(node) {
