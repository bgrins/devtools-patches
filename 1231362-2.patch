# vim: se ft=diff :
# HG changeset patch
# User Gabriel Luong <gabriel.luong@gmail.com>
# Date 2015-12-09 11:27
Bug 1231362 - Part 2: Upgrade existing CodeMirror keymap to 5.9.0 r=bgrins

diff --git a/devtools/client/sourceeditor/codemirror/keymap/sublime.js b/devtools/client/sourceeditor/codemirror/keymap/sublime.js
--- a/devtools/client/sourceeditor/codemirror/keymap/sublime.js
+++ b/devtools/client/sourceeditor/codemirror/keymap/sublime.js
@@ -235,17 +235,19 @@
         else
           cm.replaceRange("", Pos(from, 0), Pos(from + 1, 0), "+swapLine");
         cm.replaceRange(line + "\n", Pos(to, 0), null, "+swapLine");
       }
       cm.scrollIntoView();
     });
   };

-  map[ctrl + "/"] = "toggleComment";
+  map[ctrl + "/"] = function(cm) {
+    cm.toggleComment({ indent: true });
+  }

   cmds[map[ctrl + "J"] = "joinLines"] = function(cm) {
     var ranges = cm.listSelections(), joined = [];
     for (var i = 0; i < ranges.length; i++) {
       var range = ranges[i], from = range.from();
       var start = from.line, end = range.to().line;
       while (i < ranges.length - 1 && ranges[i + 1].from().line == end)
         end = ranges[++i].to().line;
diff --git a/devtools/client/sourceeditor/codemirror/keymap/vim.js b/devtools/client/sourceeditor/codemirror/keymap/vim.js
--- a/devtools/client/sourceeditor/codemirror/keymap/vim.js
+++ b/devtools/client/sourceeditor/codemirror/keymap/vim.js
@@ -3203,17 +3203,17 @@
         }
       }
       if (state.nextCh || state.curMoveThrough) {
         return Pos(line, state.index);
       }
       return cur;
     }

-    /*
+    /**
      * Returns the boundaries of the next word. If the cursor in the middle of
      * the word, then returns the boundaries of the current word, starting at
      * the cursor. If the cursor is at the start/end of a word, and we are going
      * forward/backward, respectively, find the boundaries of the next word.
      *
      * @param {CodeMirror} cm CodeMirror object.
      * @param {Cursor} cur The cursor position.
      * @param {boolean} forward True to search forward. False to search
