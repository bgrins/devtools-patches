# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  f74dd7f123aca26dd6dd61d3218433b35303634e

diff --git a/devtools/client/shared/test/browser_dbg_WorkerTargetActor.attach.js b/devtools/client/shared/test/browser_dbg_WorkerTargetActor.attach.js
--- a/devtools/client/shared/test/browser_dbg_WorkerTargetActor.attach.js
+++ b/devtools/client/shared/test/browser_dbg_WorkerTargetActor.attach.js
@@ -58,16 +58,17 @@ function test() {
     executeSoon(() => {
       tab.linkedBrowser.goBack();
     });
     yield waitForWorkerClose(workerTargetFront2);
     is(workerTargetFront2.isClosed, true, "worker in tab 2 should be closed");
 
     ({ workers } = yield listWorkers(targetFront));
     workerTargetFront1 = findWorker(workers, WORKER1_URL);
+    yield new Promise(r=>r);
     yield workerTargetFront1.attach();
     is(workerTargetFront1.isClosed, false, "worker in tab 1 should not be closed");
 
     yield target.destroy();
     SpecialPowers.setIntPref(MAX_TOTAL_VIEWERS, oldMaxTotalViewers);
     finish();
   });
 }
