# HG changeset patch
# Parent 87f56ae05a165738fc29e71651373b4aed1601db
# User Brian Grinstead <bgrinstead@mozilla.com>
testing breadcrumb

diff --git a/browser/devtools/inspector/breadcrumbs.js b/browser/devtools/inspector/breadcrumbs.js
--- a/browser/devtools/inspector/breadcrumbs.js
+++ b/browser/devtools/inspector/breadcrumbs.js
@@ -378,19 +378,22 @@ HTMLBreadcrumbs.prototype = {
    *
    * @param aIdx Index of the displayed-button to select
    */
   setCursor: function BC_setCursor(aIdx)
   {
     // Unselect the previously selected button
     if (this.currentIndex > -1 && this.currentIndex < this.nodeHierarchy.length) {
       this.nodeHierarchy[this.currentIndex].button.removeAttribute("checked");
+      this.nodeHierarchy[this.currentIndex].separator.removeAttribute("checked");
     }
     if (aIdx > -1) {
       this.nodeHierarchy[aIdx].button.setAttribute("checked", "true");
+      this.nodeHierarchy[aIdx].separator.setAttribute("checked", "true");
+
       if (this.hadFocus)
         this.nodeHierarchy[aIdx].button.focus();
     }
     this.currentIndex = aIdx;
   },
 
   /**
    * Get the index of the node in the cache.
@@ -415,16 +418,17 @@ HTMLBreadcrumbs.prototype = {
    *
    * @param aIdx
    */
   cutAfter: function BC_cutAfter(aIdx)
   {
     while (this.nodeHierarchy.length > (aIdx + 1)) {
       let toRemove = this.nodeHierarchy.pop();
       this.container.removeChild(toRemove.button);
+      this.container.removeChild(toRemove.separator);
     }
   },
 
   /**
    * Build a button representing the node.
    *
    * @param aNode The node from the page.
    * @returns aNode The <button>.
@@ -473,19 +477,23 @@ HTMLBreadcrumbs.prototype = {
       let originalLength = this.nodeHierarchy.length;
       let stopNode = null;
       if (originalLength > 0) {
         stopNode = this.nodeHierarchy[originalLength - 1].node;
       }
       while (toAppend && toAppend != stopNode) {
         if (toAppend.tagName) {
           let button = this.buildButton(toAppend);
+          let separator = this.chromeDoc.createElement("box");
+          separator.className = "breadcrumbs-widget-separator";
+          separator.flex = 0;
           fragment.insertBefore(button, lastButtonInserted);
-          lastButtonInserted = button;
-          this.nodeHierarchy.splice(originalLength, 0, {node: toAppend, button: button});
+          fragment.insertBefore(separator, button);
+          lastButtonInserted = separator;
+          this.nodeHierarchy.splice(originalLength, 0, {node: toAppend, button: button, separator: separator });
         }
         toAppend = toAppend.parentNode();
       }
       this.container.appendChild(fragment, this.container.firstChild);
   },
 
   /**
    * Get a child of a node that can be displayed in the breadcrumbs
diff --git a/browser/themes/osx/jar.mn b/browser/themes/osx/jar.mn
--- a/browser/themes/osx/jar.mn
+++ b/browser/themes/osx/jar.mn
@@ -269,16 +269,18 @@ browser.jar:
   skin/classic/browser/devtools/commandline.css             (devtools/commandline.css)
   skin/classic/browser/devtools/markup-view.css             (../shared/devtools/markup-view.css)
   skin/classic/browser/devtools/editor-error.png             (devtools/editor-error.png)
   skin/classic/browser/devtools/editor-breakpoint.png        (devtools/editor-breakpoint.png)
   skin/classic/browser/devtools/editor-debug-location.png    (devtools/editor-debug-location.png)
 * skin/classic/browser/devtools/webconsole.css                  (devtools/webconsole.css)
   skin/classic/browser/devtools/webconsole_networkpanel.css     (devtools/webconsole_networkpanel.css)
   skin/classic/browser/devtools/webconsole.png                  (devtools/webconsole.png)
+  skin/classic/browser/devtools/breadcrumb-divider@2x.png       (../shared/devtools/images/breadcrumb-divider@2x.png)
+  skin/classic/browser/devtools/filters.svg     (../shared/devtools/filters.svg)
   skin/classic/browser/devtools/breadcrumbs-scrollbutton.png                 (devtools/breadcrumbs-scrollbutton.png)
   skin/classic/browser/devtools/breadcrumbs/ltr-end-pressed.png              (devtools/breadcrumbs/ltr-end-pressed.png)
   skin/classic/browser/devtools/breadcrumbs/ltr-end-selected-pressed.png     (devtools/breadcrumbs/ltr-end-selected-pressed.png)
   skin/classic/browser/devtools/breadcrumbs/ltr-end-selected.png             (devtools/breadcrumbs/ltr-end-selected.png)
   skin/classic/browser/devtools/breadcrumbs/ltr-end.png                      (devtools/breadcrumbs/ltr-end.png)
   skin/classic/browser/devtools/breadcrumbs/ltr-middle-pressed.png           (devtools/breadcrumbs/ltr-middle-pressed.png)
   skin/classic/browser/devtools/breadcrumbs/ltr-middle-selected-pressed.png  (devtools/breadcrumbs/ltr-middle-selected-pressed.png)
   skin/classic/browser/devtools/breadcrumbs/ltr-middle-selected.png          (devtools/breadcrumbs/ltr-middle-selected.png)
diff --git a/browser/themes/shared/devtools/widgets.inc.css b/browser/themes/shared/devtools/widgets.inc.css
--- a/browser/themes/shared/devtools/widgets.inc.css
+++ b/browser/themes/shared/devtools/widgets.inc.css
@@ -22,76 +22,25 @@
   -moz-margin-end: 3px;
   /* A fake 1px-shadow is included in the border-images of the
      breadcrumbs-widget-items, to match toolbar-buttons style.
      This negative margin compensates the extra row of pixels created
      by the shadow.*/
   margin-bottom: -1px;
 }
 
-/* Preloading hack, LTR */
-
-.breadcrumbs-widget-container:-moz-locale-dir(ltr)::after {
-  content: '';
-  display: block;
-  background-image:
-    url(breadcrumbs/ltr-start.png),
-    url(breadcrumbs/ltr-start-selected.png),
-    url(breadcrumbs/ltr-start-pressed.png),
-    url(breadcrumbs/ltr-start-selected-pressed.png),
-    url(breadcrumbs/ltr-middle.png),
-    url(breadcrumbs/ltr-middle-selected.png),
-    url(breadcrumbs/ltr-middle-pressed.png),
-    url(breadcrumbs/ltr-middle-selected-pressed.png),
-    url(breadcrumbs/ltr-end.png),
-    url(breadcrumbs/ltr-end-selected.png),
-    url(breadcrumbs/ltr-end-pressed.png),
-    url(breadcrumbs/ltr-end-selected-pressed.png);
-}
-
-/* Preloading hack, RTL */
-
-.breadcrumbs-widget-container:-moz-locale-dir(rtl)::after {
-  content: '';
-  display: block;
-  background-image:
-    url(breadcrumbs/rtl-start.png),
-    url(breadcrumbs/rtl-start-selected.png),
-    url(breadcrumbs/rtl-start-pressed.png),
-    url(breadcrumbs/rtl-start-selected-pressed.png),
-    url(breadcrumbs/rtl-middle.png),
-    url(breadcrumbs/rtl-middle-selected.png),
-    url(breadcrumbs/rtl-middle-pressed.png),
-    url(breadcrumbs/rtl-middle-selected-pressed.png),
-    url(breadcrumbs/rtl-end.png),
-    url(breadcrumbs/rtl-end-selected.png),
-    url(breadcrumbs/rtl-end-pressed.png),
-    url(breadcrumbs/rtl-end-selected-pressed.png);
-}
-
 .scrollbutton-up,
 .scrollbutton-down {
   -moz-appearance: none;
-  background: linear-gradient(hsla(212,7%,57%,.35), hsla(212,7%,57%,.1)) padding-box;
-  box-shadow: 0 1px 0 hsla(210,16%,76%,.15) inset,
-              0 0 0 1px hsla(210,16%,76%,.15) inset,
-              0 1px 0 hsla(210,16%,76%,.15);
-  border: 1px solid hsla(210,8%,5%,.45);
+  background: transparent;
+  box-shadow: none;
+  border: none;
   margin: 0 0 1px;
 }
 
-.scrollbutton-up:not([disabled]):active:hover,
-.scrollbutton-down:not([disabled]):active:hover {
-  background: linear-gradient(hsla(220,6%,10%,.3), hsla(212,7%,57%,.15) 65%, hsla(212,7%,57%,.3));
-  box-shadow: 0 0 3px hsla(210,8%,5%,.25) inset,
-              0 1px 3px hsla(210,8%,5%,.25) inset,
-              0 1px 0 hsla(210,16%,76%,.15);
-  border-color: hsla(210,8%,5%,.6);
-}
-
 .scrollbutton-up > .toolbarbutton-icon,
 .scrollbutton-down > .toolbarbutton-icon {
   -moz-appearance: none;
   list-style-image: url("breadcrumbs-scrollbutton.png");
   -moz-image-region: rect(0px,7px,16px,0px);
   margin: 0 5px;
 }
 
@@ -112,163 +61,103 @@
 
 .breadcrumbs-widget-item {
   background-color: transparent;
   -moz-appearance: none;
   overflow: hidden;
   min-width: 85px;
   max-width: 250px;
   min-height: 25px;
-  border-style: solid;
-  border-width: 1px 13px 2px 13px;
-  margin: 0 -11px 0 0;
+  margin: 0;
   padding: 0 9px;
+  border: none;
   outline: none;
   color: hsl(210,30%,85%);
 }
 
+.breadcrumbs-widget-separator {
+  display: -moz-box;
+  width: 12px;
+  overflow: hidden;
+  background-image: url(breadcrumb-divider@2x.png);
+  background-size: 12px 24px;
+  background-position: center right;
+  background-repeat: no-repeat;
+}
+
+.breadcrumbs-widget-separator[checked],
+.breadcrumbs-widget-item[checked] {
+  background: #1d4f73;
+}
+
+.breadcrumbs-widget-item[checked] + .breadcrumbs-widget-separator,
+.breadcrumbs-widget-separator:first-child {
+  background-image: none;
+}
+
+.breadcrumbs-widget-separator[checked]:first-child:after {
+  display: none;
+}
+
+/* "Notch" taken out of active crumb and the crumb following the active
+ * is accomplished by rotating an element and hiding overlow.
+ */
+.breadcrumbs-widget-separator[checked]:after,
+.breadcrumbs-widget-item[checked] + .breadcrumbs-widget-separator:after {
+  content: "";
+  display: block;
+  width: 25px;
+  height: 25px;
+  background: #343c45;
+  /*background: orange;*/
+  transform: translateX(-17px) rotate(45deg);
+  -moz-box-sizing: border-box;
+  border: solid 1px rgba(255, 255, 255, 0.1);
+}
+
+.breadcrumbs-widget-item[checked] + .breadcrumbs-widget-separator:after {
+  background: #1d4f73;
+  border: none;
+}
+
+/* RTL Support only requires flipping the separator icons and arrows */
+/*.breadcrumbs-widget-separator:not([checked]):-moz-locale-dir(rtl),
+.breadcrumbs-widget-item:not([checked]) + .breadcrumbs-widget-separator:-moz-locale-dir(rtl) {
+  transform:  scaleX(-1);
+}*/
+
+.breadcrumbs-widget-separator:-moz-locale-dir(rtl),
+.breadcrumbs-widget-item + .breadcrumbs-widget-separator:-moz-locale-dir(rtl) {
+  transform:  scaleX(-1);
+}
+
+.breadcrumbs-widget-separator[checked]:-moz-locale-dir(rtl):after,
+.breadcrumbs-widget-item[checked] + .breadcrumbs-widget-separator:-moz-locale-dir(rtl):after {
+  transform: translateX(-5px) rotate(45deg);
+}
+
+
 .breadcrumbs-widget-item:-moz-focusring > label {
+  border-top: 1px solid transparent;
   border-bottom: 1px dotted hsla(210,30%,85%,0.4);
 }
 
-.breadcrumbs-widget-item[checked] .breadcrumbs-widget-item-tag {
-  color: hsl(208,100%,60%);
-}
-
-.breadcrumbs-widget-item[checked] .breadcrumbs-widget-item-id {
-  color: hsl(205,100%,70%);
-}
-
+.breadcrumbs-widget-item[checked] .breadcrumbs-widget-item-tag,
+.breadcrumbs-widget-item[checked] .breadcrumbs-widget-item-id,
 .breadcrumbs-widget-item[checked] .breadcrumbs-widget-item-pseudo-classes {
-  color: hsl(20,100%,70%);
+  color: #f5f7fa;
 }
 
 .breadcrumbs-widget-item-id,
 .breadcrumbs-widget-item-classes {
-  color: #8d99a6;
+  color: #b6babf;
 }
 
 .breadcrumbs-widget-item-pseudo-classes {
-  color: hsl(20,100%,85%);
-}
-
-/* Breadcrumbs LTR */
-
-.breadcrumbs-widget-item:-moz-locale-dir(ltr) {
-  border-image: url("breadcrumbs/ltr-middle.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:not([checked]):hover:active:-moz-locale-dir(ltr) {
-  border-image: url("breadcrumbs/ltr-middle-pressed.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item[checked]:-moz-locale-dir(ltr) {
-  border-image: url("breadcrumbs/ltr-middle-selected.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item[checked]:hover:active:-moz-locale-dir(ltr) {
-  border-image: url("breadcrumbs/ltr-middle-selected-pressed.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:first-of-type:-moz-locale-dir(ltr) {
-  border-image: url("breadcrumbs/ltr-start.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:first-of-type:not([checked]):hover:active:-moz-locale-dir(ltr) {
-  border-image: url("breadcrumbs/ltr-start-pressed.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:first-of-type[checked]:-moz-locale-dir(ltr) {
-  border-image: url("breadcrumbs/ltr-start-selected.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:first-of-type[checked]:hover:active:-moz-locale-dir(ltr) {
-  border-image: url("breadcrumbs/ltr-start-selected-pressed.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:last-of-type:-moz-locale-dir(ltr) {
-  border-image: url("breadcrumbs/ltr-end.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:last-of-type:not([checked]):hover:active:-moz-locale-dir(ltr) {
-  border-image: url("breadcrumbs/ltr-end-pressed.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:last-of-type[checked]:-moz-locale-dir(ltr) {
-  border-image: url("breadcrumbs/ltr-end-selected.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:last-of-type[checked]:hover:active:-moz-locale-dir(ltr) {
-  border-image: url("breadcrumbs/ltr-end-selected-pressed.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-container[overflows] > .breadcrumbs-widget-item:first-of-type:-moz-locale-dir(ltr) {
-  border-left-width: 0;
-}
-
-.breadcrumbs-widget-container[overflows] > .breadcrumbs-widget-item:last-of-type:-moz-locale-dir(ltr) {
-  border-right-width: 0;
-}
-
-/* Breadcrumbs RTL */
-
-.breadcrumbs-widget-item:-moz-locale-dir(rtl) {
-  border-image: url("breadcrumbs/rtl-middle.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:not([checked]):hover:active:-moz-locale-dir(rtl) {
-  border-image: url("breadcrumbs/rtl-middle-pressed.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item[checked]:-moz-locale-dir(rtl) {
-  border-image: url("breadcrumbs/rtl-middle-selected.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item[checked]:hover:active:-moz-locale-dir(rtl) {
-  border-image: url("breadcrumbs/rtl-middle-selected-pressed.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:first-of-type:-moz-locale-dir(rtl) {
-  border-image: url("breadcrumbs/rtl-start.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:first-of-type:not([checked]):hover:active:-moz-locale-dir(rtl) {
-  border-image: url("breadcrumbs/rtl-start-pressed.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:first-of-type[checked]:-moz-locale-dir(rtl) {
-  border-image: url("breadcrumbs/rtl-start-selected.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:first-of-type[checked]:hover:active:-moz-locale-dir(rtl) {
-  border-image: url("breadcrumbs/rtl-start-selected-pressed.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:last-of-type:-moz-locale-dir(rtl) {
-  border-image: url("breadcrumbs/rtl-end.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:last-of-type:not([checked]):hover:active:-moz-locale-dir(rtl) {
-  border-image: url("breadcrumbs/rtl-end-pressed.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:last-of-type[checked]:-moz-locale-dir(rtl) {
-  border-image: url("breadcrumbs/rtl-end-selected.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-item:last-of-type[checked]:hover:active:-moz-locale-dir(rtl) {
-  border-image: url("breadcrumbs/rtl-end-selected-pressed.png") 1 13 2 13 fill stretch;
-}
-
-.breadcrumbs-widget-container[overflows] > .breadcrumbs-widget-item:first-of-type:-moz-locale-dir(rtl) {
-  border-right-width: 0;
-}
-
-.breadcrumbs-widget-container[overflows] > .breadcrumbs-widget-item:last-of-type:-moz-locale-dir(rtl) {
-  border-left-width: 0;
+  color: #d99b28;
 }
 
 /* SimpleListWidget */
 
 %filter substitution
 %define slw_selectionGradient linear-gradient(hsl(206,59%,39%), hsl(206,59%,29%))
 %define slw_selectionTextColor #fff
 
