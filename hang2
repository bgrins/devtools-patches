# HG changeset patch
# Parent 1bab2224b51a05a1bab282dc04f4c74dc5d4870c
# User Brian Grinstead <bgrinstead@mozilla.com>
Bug 927630 - Hang if tabs switched while Inspector is opening.

diff --git a/toolkit/devtools/LayoutHelpers.jsm b/toolkit/devtools/LayoutHelpers.jsm
--- a/toolkit/devtools/LayoutHelpers.jsm
+++ b/toolkit/devtools/LayoutHelpers.jsm
@@ -336,17 +336,17 @@ LayoutHelpers.prototype = {
   /**
    * like win.parent === win, but goes through mozbrowsers and mozapps iframes.
    */
   isTopLevelWindow: function LH_isTopLevelWindow(win) {
     let docShell = win.QueryInterface(Ci.nsIInterfaceRequestor)
                    .getInterface(Ci.nsIWebNavigation)
                    .QueryInterface(Ci.nsIDocShell);
 
-    return docShell === this._topDocShell;
+    return win.parent === win || docShell === this._topDocShell;
   },
 
   /**
    * like win.parent, but goes through mozbrowsers and mozapps iframes.
    */
   getParentWindow: function LH_getParentWindow(win) {
     if (this.isTopLevelWindow(win)) {
       return null;
