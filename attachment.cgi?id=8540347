# HG changeset patch
# Parent 84591285b846d449c846afc2ab3e72e8b95dc8e1
# User Tim Nguyen <ntim.bugs@gmail.com>
Bug 1019186 - Use new throbbers for DevTools UI. r=bgrins

diff --git a/browser/devtools/canvasdebugger/canvasdebugger.js b/browser/devtools/canvasdebugger/canvasdebugger.js
--- a/browser/devtools/canvasdebugger/canvasdebugger.js
+++ b/browser/devtools/canvasdebugger/canvasdebugger.js
@@ -512,29 +512,31 @@ let SnapshotsListView = Heritage.extend(
         return;
       }
       let footer = $(".snapshot-item-footer", snapshotItem.target);
       let save = $(".snapshot-item-save", snapshotItem.target);
 
       // Show a throbber and a "Savingâ€¦" label if serializing isn't immediate.
       setNamedTimeout("call-list-save", CALLS_LIST_SLOW_SAVE_DELAY, () => {
         footer.setAttribute("saving", "");
+        footer.classList.add("devtools-throbber");
         save.setAttribute("disabled", "true");
         save.setAttribute("value", L10N.getStr("snapshotsList.savingLabel"));
       });
 
       serialized.then(inputStream => {
         let outputStream = FileUtils.openSafeFileOutputStream(fp.file);
 
         NetUtil.asyncCopy(inputStream, outputStream, status => {
           if (!Components.isSuccessCode(status)) {
             console.error("Could not save recorded animation frame snapshot file.");
           }
           clearNamedTimeout("call-list-save");
           footer.removeAttribute("saving");
+          footer.classList.remove("devtools-throbber");
           save.removeAttribute("disabled");
           save.setAttribute("value", L10N.getStr("snapshotsList.saveLabel"));
         });
       });
     }});
   }
 });
 
diff --git a/browser/devtools/shadereditor/shadereditor.xul b/browser/devtools/shadereditor/shadereditor.xul
--- a/browser/devtools/shadereditor/shadereditor.xul
+++ b/browser/devtools/shadereditor/shadereditor.xul
@@ -30,17 +30,17 @@
               standalone="true"
               label="&shaderEditorUI.reloadNotice1;"
               oncommand="gFront.setup({ reload: true });"/>
       <label id="requests-menu-reload-notice-label"
              class="plain"
              value="&shaderEditorUI.reloadNotice2;"/>
     </hbox>
     <hbox id="waiting-notice"
-          class="notice-container"
+          class="notice-container devtools-throbber"
           align="center"
           pack="center"
           flex="1"
           hidden="true">
       <label id="requests-menu-waiting-notice-label"
              class="plain"
              value="&shaderEditorUI.emptyNotice;"/>
     </hbox>
diff --git a/browser/devtools/styleeditor/styleeditor.xul b/browser/devtools/styleeditor/styleeditor.xul
--- a/browser/devtools/styleeditor/styleeditor.xul
+++ b/browser/devtools/styleeditor/styleeditor.xul
@@ -104,16 +104,17 @@
             <xul:toolbarbutton id="style-editor-options"
                         class="devtools-toolbarbutton devtools-option-toolbarbutton"
                         tooltiptext="&optionsButton.tooltip;"
                         popup="style-editor-options-popup"/>
           </xul:toolbar>
         </xul:box>
         <xul:box id="splitview-resizer-target" class="theme-sidebar splitview-nav-container"
                 persist="height">
+          <div class="devtools-throbber"></div>
           <ol class="splitview-nav" tabindex="0"></ol>
           <div class="splitview-nav placeholder empty">
             <p><strong>&noStyleSheet.label;</strong></p>
             <p>&noStyleSheet-tip-start.label;
               <a href="#"
                 class="style-editor-newButton">&noStyleSheet-tip-action.label;</a>
               &noStyleSheet-tip-end.label;</p>
           </div>
diff --git a/browser/devtools/webaudioeditor/webaudioeditor.xul b/browser/devtools/webaudioeditor/webaudioeditor.xul
--- a/browser/devtools/webaudioeditor/webaudioeditor.xul
+++ b/browser/devtools/webaudioeditor/webaudioeditor.xul
@@ -37,17 +37,17 @@
               standalone="true"
               label="&webAudioEditorUI.reloadNotice1;"
               oncommand="gFront.setup({ reload: true });"/>
       <label id="requests-menu-reload-notice-label"
              class="plain"
              value="&webAudioEditorUI.reloadNotice2;"/>
     </hbox>
     <hbox id="waiting-notice"
-          class="notice-container"
+          class="notice-container devtools-throbber"
           align="center"
           pack="center"
           flex="1"
           hidden="true">
       <label id="requests-menu-waiting-notice-label"
              class="plain"
              value="&webAudioEditorUI.emptyNotice;"/>
     </hbox>
diff --git a/browser/themes/shared/devtools/canvasdebugger.inc.css b/browser/themes/shared/devtools/canvasdebugger.inc.css
--- a/browser/themes/shared/devtools/canvasdebugger.inc.css
+++ b/browser/themes/shared/devtools/canvasdebugger.inc.css
@@ -115,23 +115,17 @@
 }
 
 .snapshot-item-save[disabled=true] {
   text-decoration: none;
   pointer-events: none;
 }
 
 .snapshot-item-footer[saving]::before {
-  display: inline-block;
-  content: "";
-  background: url("chrome://global/skin/icons/loading_16.png") center no-repeat;
-  width: 16px;
-  height: 16px;
   margin-top: -2px;
-  -moz-margin-end: 4px;
 }
 
 #snapshots-list .selected label {
   /* Text inside a selected item should not be custom colored. */
   color: inherit !important;
 }
 
 /* Debugging pane controls */
diff --git a/browser/themes/shared/devtools/shadereditor.inc.css b/browser/themes/shared/devtools/shadereditor.inc.css
--- a/browser/themes/shared/devtools/shadereditor.inc.css
+++ b/browser/themes/shared/devtools/shadereditor.inc.css
@@ -13,25 +13,16 @@
 #reload-notice {
   font-size: 120%;
 }
 
 #waiting-notice {
   font-size: 110%;
 }
 
-#waiting-notice::before {
-  display: inline-block;
-  content: "";
-  background: url("chrome://global/skin/icons/loading_16.png") center no-repeat;
-  width: 16px;
-  height: 16px;
-  -moz-margin-end: 6px;
-}
-
 /* Shaders pane */
 
 #shaders-pane {
   min-width: 150px;
 }
 
 #shaders-pane + .devtools-side-splitter {
   border-color: transparent;
diff --git a/browser/themes/shared/devtools/splitview.css b/browser/themes/shared/devtools/splitview.css
--- a/browser/themes/shared/devtools/splitview.css
+++ b/browser/themes/shared/devtools/splitview.css
@@ -6,20 +6,23 @@
 %filter substitution
 %define smw_marginDark #000
 %define smw_marginLight #aaa
 %define smw_itemDarkTopBorder rgba(0,0,0,0.2)
 %define smw_itemDarkBottomBorder rgba(128,128,128,0.15)
 %define smw_itemLightTopBorder rgba(128,128,128,0.15)
 %define smw_itemLightBottomBorder transparent
 
-.loading .splitview-nav-container {
-  background-image: url(chrome://global/skin/icons/loading_16.png);
-  background-repeat: no-repeat;
-  background-position: center center;
+.devtools-throbber {
+  display: none;
+  text-align: center;
+}
+
+.loading .devtools-throbber {
+  display: block;
 }
 
 .theme-dark .splitview-nav-container {
   background-color: var(--theme-toolbar-background);
 }
 
 .splitview-nav {
   -moz-appearance: none;
diff --git a/browser/themes/shared/devtools/toolbars.inc.css b/browser/themes/shared/devtools/toolbars.inc.css
--- a/browser/themes/shared/devtools/toolbars.inc.css
+++ b/browser/themes/shared/devtools/toolbars.inc.css
@@ -858,8 +858,30 @@
   border-bottom: 1px solid var(--theme-splitter-color);
 }
 
 .devtools-side-splitter {
   -moz-border-end: 1px solid var(--theme-splitter-color);
   border-color: var(--theme-splitter-color); /* Needed for responsive container at low width. */
 }
 
+/* Throbbers */
+.devtools-throbber::before {
+  content: "";
+  display: inline-block;
+  vertical-align: bottom;
+  -moz-margin-end: 0.5em;
+  width: 1em;
+  height: 1em;
+  border: 2px solid currentColor;
+  border-right-color: transparent;
+  border-radius: 50%;
+  animation: 1.1s linear spin infinite;
+}
+
+@keyframes spin {
+  from {
+    transform: none;
+  }
+  to {
+    transform: rotate(360deg);
+  }
+}
\ No newline at end of file
diff --git a/browser/themes/shared/devtools/webaudioeditor.inc.css b/browser/themes/shared/devtools/webaudioeditor.inc.css
--- a/browser/themes/shared/devtools/webaudioeditor.inc.css
+++ b/browser/themes/shared/devtools/webaudioeditor.inc.css
@@ -12,25 +12,16 @@
 #reload-notice {
   font-size: 120%;
 }
 
 #waiting-notice {
   font-size: 110%;
 }
 
-#waiting-notice::before {
-  display: inline-block;
-  content: "";
-  background: url("chrome://global/skin/icons/loading_16.png") center no-repeat;
-  width: 16px;
-  height: 16px;
-  -moz-margin-end: 6px;
-}
-
 /* Context Graph */
 svg {
   overflow: hidden;
   -moz-box-flex: 1;
 }
 
 /* Edges in graph */
 .edgePath path {
