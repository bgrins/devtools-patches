# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  e75cdea30242a3525724766b43957ae01d3925ca

diff --git a/browser/base/content/browser.xhtml b/browser/base/content/browser.xhtml
--- a/browser/base/content/browser.xhtml
+++ b/browser/base/content/browser.xhtml
@@ -728,25 +728,17 @@
                   is="tabbrowser-tabs"
                   flex="1"
                   setfocus="false"
                   tooltip="tabbrowser-tab-tooltip"
                   stopwatchid="FX_TAB_CLICK_MS">
               <hbox class="tab-drop-indicator-box">
                 <image class="tab-drop-indicator" hidden="true"/>
               </hbox>
-              <arrowscrollbox orient="horizontal" flex="1" style="min-width: 1px;" clicktoscroll="true" class="tabbrowser-arrowscrollbox" scrolledtostart="true" scrolledtoend="true">
-                <tab is="tabbrowser-tab" class="tabbrowser-tab" selected="true" visuallyselected="true" fadein="true"/>
-                <toolbarbutton id="tabs-newtab-button"
-                               class="toolbarbutton-1"
-                               command="cmd_newNavigatorTab"
-                               onclick="checkForMiddleClick(this, event);"
-                               tooltip="dynamic-shortcut-tooltip"/>
-                <spacer class="closing-tabs-spacer" style="width: 0;"/>
-              </arrowscrollbox>
+              <arrowscrollbox orient="horizontal" flex="1" style="min-width: 1px;" clicktoscroll="true" class="tabbrowser-arrowscrollbox" scrolledtostart="true" scrolledtoend="true" />
               <html:span id="tabbrowser-tab-a11y-desc" hidden="true"/>
             </tabs>
 
             <toolbarbutton id="new-tab-button"
                            class="toolbarbutton-1 chromeclass-toolbar-additional"
                            label="&tabCmd.label;"
                            command="cmd_newNavigatorTab"
                            onclick="checkForMiddleClick(this, event);"
diff --git a/browser/base/content/tabbrowser-tabs.js b/browser/base/content/tabbrowser-tabs.js
--- a/browser/base/content/tabbrowser-tabs.js
+++ b/browser/base/content/tabbrowser-tabs.js
@@ -28,16 +28,30 @@
       this.addEventListener("drop", this);
       this.addEventListener("dragend", this);
       this.addEventListener("dragexit", this);
     }
 
     init() {
       this.arrowScrollbox = this.querySelector("arrowscrollbox");
 
+      // XXX: Shadow DOM slotting gets confused if this is inline in browser.xhtml:
+      this.arrowScrollbox.prepend(
+        MozXULElement.parseXULToFragment(
+          `<tab is="tabbrowser-tab" class="tabbrowser-tab" selected="true" visuallyselected="true" fadein="true"/>
+            <toolbarbutton id="tabs-newtab-button"
+                          class="tabs-newtab-button toolbarbutton-1"
+                          command="cmd_newNavigatorTab"
+                          onclick="checkForMiddleClick(this, event);"
+                          tooltip="dynamic-shortcut-tooltip"/>
+            <spacer class="closing-tabs-spacer" style="width: 0;"/>
+          `
+        )
+      );
+
       this.baseConnect();
 
       this._firstTab = null;
       this._lastTab = null;
       this._beforeSelectedTab = null;
       this._beforeHoveredTab = null;
       this._afterHoveredTab = null;
       this._hoveredTab = null;
