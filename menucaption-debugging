# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Parent  5c48b5edfc4ca945a2eaa5896454f3f4efa9052a
Bug 1418494 - Flatten menucaption-inmenulist into menucaption;r=mconley

The only time menucaptions are created are for optgroups, and they
always get instantiated as menucaption-inmenulist. Flatten the
inheritance here to get rid of a binding.

MozReview-Commit-ID: KWzor0QDdma

diff --git a/toolkit/content/widgets/menu.xml b/toolkit/content/widgets/menu.xml
--- a/toolkit/content/widgets/menu.xml
+++ b/toolkit/content/widgets/menu.xml
@@ -182,22 +182,16 @@
     <content>
       <xul:label class="menu-text" xbl:inherits="value=label,accesskey,crop,highlightable" crop="right"/>
       <xul:hbox class="menu-accel-container" anonid="accel">
         <xul:label class="menu-accel" xbl:inherits="value=acceltext"/>
       </xul:hbox>
     </content>
   </binding>
 
-  <binding id="menucaption" extends="chrome://global/content/bindings/menu.xml#menu-base">
-    <content>
-      <xul:label class="menu-text" xbl:inherits="value=label,crop" crop="right"/>
-    </content>
-  </binding>
-
   <binding id="menu-menubar"
            extends="chrome://global/content/bindings/menu.xml#menu-base">
     <content>
       <xul:label class="menubar-text" xbl:inherits="value=label,accesskey,crop" crop="right"/>
       <children includes="menupopup"/>
     </content>
   </binding>
 
@@ -231,17 +225,17 @@
                 xbl:inherits="selected,disabled,checked">
         <xul:image class="menu-iconic-icon" xbl:inherits="src=image,validate,src"/>
       </xul:hbox>
       <xul:label class="menu-iconic-text" flex="1" xbl:inherits="value=label,accesskey,crop,highlightable" crop="right"/>
       <xul:label class="menu-iconic-highlightable-text" xbl:inherits="xbl:text=label,crop,accesskey,highlightable" crop="right"/>
     </content>
   </binding>
 
-  <binding id="menucaption-inmenulist" extends="chrome://global/content/bindings/menu.xml#menucaption">
+  <binding id="menucaption" extends="chrome://global/content/bindings/menu.xml#menu-base">
     <content>
       <xul:hbox class="menu-iconic-left" align="center" pack="center"
                 xbl:inherits="selected,disabled,checked">
         <xul:image class="menu-iconic-icon" xbl:inherits="src=image,validate,src"/>
       </xul:hbox>
       <xul:label class="menu-iconic-text" flex="1" xbl:inherits="value=label,crop,highlightable" crop="right"/>
       <xul:label class="menu-iconic-highlightable-text" xbl:inherits="xbl:text=label,crop,highlightable" crop="right"/>
     </content>
diff --git a/toolkit/content/xul.css b/toolkit/content/xul.css
--- a/toolkit/content/xul.css
+++ b/toolkit/content/xul.css
@@ -951,20 +951,16 @@ menulist[editable="true"] {
 menulist[type="description"] {
   -moz-binding: url("chrome://global/content/bindings/menulist.xml#menulist-description");
 }
 
 menulist > menupopup > menuitem {
   -moz-binding: url("chrome://global/content/bindings/menu.xml#menuitem-iconic-noaccel");
 }
 
-menulist > menupopup > menucaption {
-  -moz-binding: url("chrome://global/content/bindings/menu.xml#menucaption-inmenulist");
-}
-
 dropmarker {
   -moz-binding: url("chrome://global/content/bindings/general.xml#dropmarker");
 }
 
 /********** splitter **********/
 
 splitter {
   -moz-binding: url("chrome://global/content/bindings/splitter.xml#splitter");
diff --git a/toolkit/themes/linux/global/menu.css b/toolkit/themes/linux/global/menu.css
--- a/toolkit/themes/linux/global/menu.css
+++ b/toolkit/themes/linux/global/menu.css
@@ -99,17 +99,16 @@ menulist > menupopup > menu {
 }
 
 .menu-text {
   /* This is (18 + the size of end-padding on .menu-iconic-left)px */
   margin-inline-start: 21px !important;
   font-weight: inherit;
 }
 
-menucaption > .menu-text,
 menucaption > .menu-iconic-text {
   margin-inline-start: 0 !important;
   font-weight: bold;
 }
 
 .menu-description {
   font-style: italic;
   color: GrayText;
diff --git a/toolkit/themes/osx/global/menu.css b/toolkit/themes/osx/global/menu.css
--- a/toolkit/themes/osx/global/menu.css
+++ b/toolkit/themes/osx/global/menu.css
@@ -34,17 +34,16 @@ menuitem[_moz-menuactive="true"][disable
 }
 
 .menu-text,
 .menu-iconic-text {
   font-weight: inherit;
   color: inherit;
 }
 
-menucaption > .menu-text,
 menucaption > .menu-iconic-text {
   font-weight: bold;
 }
 
 .menu-description {
   font-style: italic;
   color: -moz-mac-menutextdisable;
   margin-inline-start: 1ex !important;
diff --git a/toolkit/themes/windows/global/menu.css b/toolkit/themes/windows/global/menu.css
--- a/toolkit/themes/windows/global/menu.css
+++ b/toolkit/themes/windows/global/menu.css
@@ -64,17 +64,16 @@ menuitem.spell-suggestion {
 
 .menu-text,
 .menu-iconic-text {
   font-weight: inherit;
   margin-inline-start: 2px !important;
   padding-inline-end: 2px;
 }
 
-menucaption > .menu-text,
 menucaption > .menu-iconic-text {
   font-weight: bold;
   padding-inline-start: 0 !important;
 }
 
 .menu-description {
   font-style: italic;
   color: GrayText;
