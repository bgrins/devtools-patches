# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Date 1555886096 25200
#      Sun Apr 21 15:34:56 2019 -0700
# Node ID 6b5b34c8fc8637cf49a2db5ba1024eb47d6b4fd3
# Parent  5b2a282f73d3a6dfef9094f7f64eb72d0f227e13
Bug 1546024 - Clear the _inheritedElements cache on chrome custom elements when re-calling initializeAttributeInheritance

Otherwise we can end  up setting the proper attribute on removed children when elements get disconnected
and reconnected.

Differential Revision: https://phabricator.services.mozilla.com/D28306

diff --git a/toolkit/content/customElements.js b/toolkit/content/customElements.js
--- a/toolkit/content/customElements.js
+++ b/toolkit/content/customElements.js
@@ -306,16 +306,17 @@ MozElements.MozElementMixin = Base => {
   *
   */
   initializeAttributeInheritance() {
     let {flippedInheritedAttributes} = this.constructor;
     if (!flippedInheritedAttributes) {
       return;
     }
 
+    this._inheritedElements = {};
     this.initializedAttributeInheritance = true;
     for (let attr in flippedInheritedAttributes) {
       if (this.hasAttribute(attr)) {
         this.inheritAttribute(flippedInheritedAttributes[attr], attr);
       }
     }
   }
 
