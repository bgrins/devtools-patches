# HG changeset patch
# User Brian Grinstead <bgrinstead@mozilla.com>
# Date 1568328588 25200
#      Thu Sep 12 15:49:48 2019 -0700
# Node ID d60c6029b31825a3f18120fdd95d1e424f1dd6f8
# Parent  6aec99b90f85428f659777d3fcb80aedb539acab
Bug 1580978 - Migrate the notification-popup-box element to ftl

Differential Revision: https://phabricator.services.mozilla.com/D45758

diff --git a/browser/base/content/browser.xhtml b/browser/base/content/browser.xhtml
--- a/browser/base/content/browser.xhtml
+++ b/browser/base/content/browser.xhtml
@@ -925,59 +925,59 @@
                          tooltiptext="&urlbar.installBlocked.tooltip;"/>
                 </box>
                 <box id="notification-popup-box"
                      hidden="true"
                      onmouseover="document.getElementById('identity-box').classList.add('no-hover');"
                      onmouseout="document.getElementById('identity-box').classList.remove('no-hover');"
                      align="center">
                   <image id="default-notification-icon" class="notification-anchor-icon" role="button"
-                         tooltiptext="&urlbar.defaultNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-default-notification-anchor"/>
                   <image id="geo-notification-icon" class="notification-anchor-icon geo-icon" role="button"
-                         tooltiptext="&urlbar.geolocationNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-geolocation-notification-anchor"/>
                   <image id="autoplay-media-notification-icon" class="notification-anchor-icon autoplay-media-icon" role="button"
-                         tooltiptext="&urlbar.autoplayNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-autoplay-notification-anchor"/>
                   <image id="addons-notification-icon" class="notification-anchor-icon install-icon" role="button"
-                         tooltiptext="&urlbar.addonsNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-addons-notification-anchor"/>
                   <image id="canvas-notification-icon" class="notification-anchor-icon" role="button"
-                         tooltiptext="&urlbar.canvasNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-canvas-notification-anchor"/>
                   <image id="indexedDB-notification-icon" class="notification-anchor-icon indexedDB-icon" role="button"
-                         tooltiptext="&urlbar.indexedDBNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-indexed-db-notification-anchor"/>
                   <image id="password-notification-icon" class="notification-anchor-icon login-icon" role="button"
-                         tooltiptext="&urlbar.passwordNotificationAnchor.tooltip;"/>
-                  <stack id="plugins-notification-icon" class="notification-anchor-icon" role="button" align="center"
-                         tooltiptext="&urlbar.pluginsNotificationAnchor.tooltip;">
+                         data-l10n-id="urlbar-password-notification-anchor"/>
+                  <stack id="plugins-notification-icon" class="notification-anchor-icon" role="button" align="center" data-l10n-id="urlbar-plugins-notification-anchor">
                     <image class="plugin-icon" />
                     <image id="plugin-icon-badge" />
                   </stack>
                   <image id="web-notifications-notification-icon" class="notification-anchor-icon desktop-notification-icon" role="button"
-                         tooltiptext="&urlbar.webNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-web-notification-anchor"/>
                   <image id="webRTC-shareDevices-notification-icon" class="notification-anchor-icon camera-icon" role="button"
-                         tooltiptext="&urlbar.webRTCShareDevicesNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-web-rtc-share-devices-notification-anchor"/>
                   <image id="webRTC-shareMicrophone-notification-icon" class="notification-anchor-icon microphone-icon" role="button"
-                         tooltiptext="&urlbar.webRTCShareMicrophoneNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-web-rtc-share-microphone-notification-anchor"/>
                   <image id="webRTC-shareScreen-notification-icon" class="notification-anchor-icon screen-icon" role="button"
-                         tooltiptext="&urlbar.webRTCShareScreenNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-web-rtc-share-screen-notification-anchor"/>
                   <image id="servicesInstall-notification-icon" class="notification-anchor-icon service-icon" role="button"
-                         tooltiptext="&urlbar.servicesNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-services-notification-anchor"/>
                   <image id="translate-notification-icon" class="notification-anchor-icon translation-icon" role="button"
-                         tooltiptext="&urlbar.translateNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-translate-notification-anchor"/>
                   <image id="translated-notification-icon" class="notification-anchor-icon translation-icon in-use" role="button"
-                         tooltiptext="&urlbar.translatedNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-translated-notification-anchor"/>
                   <image id="eme-notification-icon" class="notification-anchor-icon drm-icon" role="button"
-                         tooltiptext="&urlbar.emeNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-eme-notification-anchor"/>
                   <image id="persistent-storage-notification-icon" class="notification-anchor-icon persistent-storage-icon" role="button"
-                         tooltiptext="&urlbar.persistentStorageNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-persistent-storage-notification-anchor"/>
                   <image id="midi-notification-icon" class="notification-anchor-icon midi-icon" role="button"
-                         tooltiptext="&urlbar.midiNotificationAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-midi-notification-anchor"/>
                   <image id="webauthn-notification-icon" class="notification-anchor-icon" role="button"
-                         tooltiptext="&urlbar.webAuthnAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-web-authn-anchor"/>
                   <image id="storage-access-notification-icon" class="notification-anchor-icon storage-access-icon" role="button"
-                         tooltiptext="&urlbar.storageAccessAnchor.tooltip;"/>
+                         data-l10n-id="urlbar-storage-access-anchor"/>
                 </box>
+
                 <image id="remote-control-icon"
                        tooltiptext="&urlbar.remoteControlNotificationAnchor.tooltip;"/>
                 <hbox id="identity-icon-labels">
                   <label id="identity-icon-label" class="plain" flex="1"/>
                   <label id="identity-icon-country-label" class="plain"/>
                 </hbox>
               </box>
               <box id="urlbar-label-box" align="center">
diff --git a/browser/locales/en-US/browser/browser.ftl b/browser/locales/en-US/browser/browser.ftl
--- a/browser/locales/en-US/browser/browser.ftl
+++ b/browser/locales/en-US/browser/browser.ftl
@@ -1,6 +1,46 @@
 # This Source Code Form is subject to the terms of the Mozilla Public
 # License, v. 2.0. If a copy of the MPL was not distributed with this
 # file, You can obtain one at http://mozilla.org/MPL/2.0/.
 
 browser-urlbar-identity-button =
     .aria-label = View site information
+urlbar-services-notification-anchor =
+    .tooltiptext = Open install message panel
+urlbar-web-notification-anchor =
+    .tooltiptext = Change whether you can receive notifications from the site
+urlbar-midi-notification-anchor =
+    .tooltiptext = Open MIDI panel
+urlbar-eme-notification-anchor =
+    .tooltiptext = Manage use of DRM software
+urlbar-web-authn-anchor =
+    .tooltiptext = Open Web Authentication panel
+urlbar-canvas-notification-anchor =
+    .tooltiptext = Manage canvas extraction permission
+urlbar-web-rtc-share-microphone-notification-anchor =
+    .tooltiptext = Manage sharing your microphone with the site
+urlbar-default-notification-anchor =
+    .tooltiptext = Open message panel
+urlbar-geolocation-notification-anchor =
+    .tooltiptext = Open location request panel
+urlbar-storage-access-anchor =
+    .tooltiptext = Open browsing activity permission panel
+urlbar-translate-notification-anchor =
+    .tooltiptext = Translate this page
+urlbar-web-rtc-share-screen-notification-anchor =
+    .tooltiptext = Manage sharing your windows or screen with the site
+urlbar-indexed-db-notification-anchor =
+    .tooltiptext = Open offline storage message panel
+urlbar-password-notification-anchor =
+    .tooltiptext = Open save password message panel
+urlbar-translated-notification-anchor =
+    .tooltiptext = Manage page translation
+urlbar-plugins-notification-anchor =
+    .tooltiptext = Manage plug-in use
+urlbar-web-rtc-share-devices-notification-anchor =
+    .tooltiptext = Manage sharing your camera and/or microphone with the site
+urlbar-autoplay-notification-anchor =
+    .tooltiptext = Open autoplay panel
+urlbar-persistent-storage-notification-anchor =
+    .tooltiptext = Store data in Persistent Storage
+urlbar-addons-notification-anchor =
+    .tooltiptext = Open add-on installation message panel
diff --git a/browser/locales/en-US/chrome/browser/browser.dtd b/browser/locales/en-US/chrome/browser/browser.dtd
--- a/browser/locales/en-US/chrome/browser/browser.dtd
+++ b/browser/locales/en-US/chrome/browser/browser.dtd
@@ -166,39 +166,17 @@ convenience of Safari and Chrome users o
 <!ENTITY reloadCmd.accesskey          "R">
 <!ENTITY stopCmd.label                "Stop">
 <!ENTITY stopCmd.accesskey            "S">
 <!ENTITY stopCmd.macCommandKey        ".">
 <!ENTITY goEndCap.tooltip             "Go to the address in the Location Bar">
 <!ENTITY printButton.label            "Print">
 <!ENTITY printButton.tooltip          "Print this page">
 
-<!ENTITY urlbar.defaultNotificationAnchor.tooltip         "Open message panel">
-<!ENTITY urlbar.geolocationNotificationAnchor.tooltip     "Open location request panel">
-<!ENTITY urlbar.autoplayNotificationAnchor.tooltip        "Open autoplay panel">
-<!ENTITY urlbar.addonsNotificationAnchor.tooltip          "Open add-on installation message panel">
-<!ENTITY urlbar.canvasNotificationAnchor.tooltip          "Manage canvas extraction permission">
-<!ENTITY urlbar.indexedDBNotificationAnchor.tooltip       "Open offline storage message panel">
-<!ENTITY urlbar.passwordNotificationAnchor.tooltip        "Open save password message panel">
-<!ENTITY urlbar.pluginsNotificationAnchor.tooltip         "Manage plug-in use">
-<!ENTITY urlbar.webNotificationAnchor.tooltip             "Change whether you can receive notifications from the site">
-<!ENTITY urlbar.persistentStorageNotificationAnchor.tooltip     "Store data in Persistent Storage">
 <!ENTITY urlbar.remoteControlNotificationAnchor.tooltip   "Browser is under remote control">
-<!ENTITY urlbar.webAuthnAnchor.tooltip                    "Open Web Authentication panel">
-<!ENTITY urlbar.storageAccessAnchor.tooltip               "Open browsing activity permission panel">
-
-<!ENTITY urlbar.webRTCShareDevicesNotificationAnchor.tooltip      "Manage sharing your camera and/or microphone with the site">
-<!ENTITY urlbar.webRTCShareMicrophoneNotificationAnchor.tooltip   "Manage sharing your microphone with the site">
-<!ENTITY urlbar.webRTCShareScreenNotificationAnchor.tooltip       "Manage sharing your windows or screen with the site">
-
-<!ENTITY urlbar.servicesNotificationAnchor.tooltip        "Open install message panel">
-<!ENTITY urlbar.translateNotificationAnchor.tooltip       "Translate this page">
-<!ENTITY urlbar.translatedNotificationAnchor.tooltip      "Manage page translation">
-<!ENTITY urlbar.emeNotificationAnchor.tooltip             "Manage use of DRM software">
-<!ENTITY urlbar.midiNotificationAnchor.tooltip            "Open MIDI panel">
 
 <!ENTITY urlbar.permissionsGranted.tooltip       "You have granted this website additional permissions.">
 
 <!ENTITY urlbar.cameraBlocked.tooltip            "You have blocked your camera for this website.">
 <!ENTITY urlbar.microphoneBlocked.tooltip        "You have blocked your microphone for this website.">
 <!ENTITY urlbar.screenBlocked.tooltip            "You have blocked this website from sharing your screen.">
 <!ENTITY urlbar.geolocationBlocked.tooltip       "You have blocked location information for this website.">
 <!ENTITY urlbar.webNotificationsBlocked.tooltip  "You have blocked notifications for this website.">
diff --git a/python/l10n/fluent_migrations/bug_1579540_migrate-the-notification-popup-box-to-ftl.py b/python/l10n/fluent_migrations/bug_1579540_migrate-the-notification-popup-box-to-ftl.py
new file mode 100644
--- /dev/null
+++ b/python/l10n/fluent_migrations/bug_1579540_migrate-the-notification-popup-box-to-ftl.py
@@ -0,0 +1,60 @@
+# Any copyright is dedicated to the Public Domain.
+# http://creativecommons.org/publicdomain/zero/1.0/
+
+from __future__ import absolute_import
+import fluent.syntax.ast as FTL
+from fluent.migrate.helpers import transforms_from
+from fluent.migrate.helpers import MESSAGE_REFERENCE, TERM_REFERENCE, VARIABLE_REFERENCE
+from fluent.migrate import COPY, CONCAT, REPLACE
+
+def migrate(ctx):
+    """Bug 1579540 - Migrate the notification-popup-box element to ftl, part {index}"""
+
+    ctx.add_transforms(
+        'browser/browser/browser.ftl',
+        'browser/browser/browser.ftl',
+        transforms_from(
+            """
+urlbar-services-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.servicesNotificationAnchor.tooltip") }
+urlbar-web-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.webNotificationAnchor.tooltip") }
+urlbar-midi-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.midiNotificationAnchor.tooltip") }
+urlbar-eme-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.emeNotificationAnchor.tooltip") }
+urlbar-web-authn-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.webAuthnAnchor.tooltip") }
+urlbar-canvas-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.canvasNotificationAnchor.tooltip") }
+urlbar-web-rtc-share-microphone-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.webRTCShareMicrophoneNotificationAnchor.tooltip") }
+urlbar-default-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.defaultNotificationAnchor.tooltip") }
+urlbar-geolocation-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.geolocationNotificationAnchor.tooltip") }
+urlbar-storage-access-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.storageAccessAnchor.tooltip") }
+urlbar-translate-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.translateNotificationAnchor.tooltip") }
+urlbar-web-rtc-share-screen-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.webRTCShareScreenNotificationAnchor.tooltip") }
+urlbar-indexed-db-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.indexedDBNotificationAnchor.tooltip") }
+urlbar-password-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.passwordNotificationAnchor.tooltip") }
+urlbar-translated-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.translatedNotificationAnchor.tooltip") }
+urlbar-plugins-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.pluginsNotificationAnchor.tooltip") }
+urlbar-web-rtc-share-devices-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.webRTCShareDevicesNotificationAnchor.tooltip") }
+urlbar-autoplay-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.autoplayNotificationAnchor.tooltip") }
+urlbar-persistent-storage-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.persistentStorageNotificationAnchor.tooltip") }
+urlbar-addons-notification-anchor =
+    .tooltiptext = { COPY("browser/chrome/browser/browser.dtd", "urlbar.addonsNotificationAnchor.tooltip") }
+"""
+        )
+    )
